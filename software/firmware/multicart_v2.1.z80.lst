0000                          .CPU   Z80   
0000                          .BINFROM   $C000   
0000                          .BINTO   last_address   ; use this if release binary is needed
0000                             ;            .BINTO  BAM_START ; use this if patching binary is needed
0000                          .ENT   $c004   
0000                CARTSTART:   EQU   $C000   
0000                RELOC:    EQU   $3000   
0000                TEMP_MEMORY_U0:   EQU   $08A0   
0000                REGISTER:   EQU   $C000   
0000                REGISTER_RELOC:   EQU   $E000   
0000                REGISTER_DISABLE_RESET:   EQU   REGISTER+2   
0000                REGISTER_RELOC_DISABLE_RESET:   EQU   REGISTER_RELOC + 2   
0000                A19:      EQU   00100000b   
0000                RAM:      EQU   01000000b   
0000                REGREL:   EQU   10000000b   
0000                CYCLE_COUNT1:   EQU   $0100   
0000                CYCLE_COUNT2:   EQU   $0080   
0000                X0:       EQU   1   
0000                Y0:       EQU   5   
0000                N_NUM:    EQU   3   
0000                N_NAME:   EQU   16   
0000                N_TYPE:   EQU   4   
0000                N_SIZE:   EQU   4   
0000                N_HEIGHT:   EQU   16   
0000                EN:       EQU   0   
0000                HU:       EQU   1   
0000                ES:       EQU   2   
0000                LANG:     EQU   HU   
0000                             ; 
0000                             ; $FF: WARM RESET
0000                WARM_FLAG:   EQU   $0B21   
0000                             ; 
0000                             ; bit 2 controls blinking cursor if IT enabled
0000                INT_DES:   EQU   $0B10   
0000                             ; 
0000                             ; BASIC start options on v2.2
0000                BASIC_FLAG:   EQU   $0EB6   
0000                             ; BASIC PROMPT CONTINUES FROM HERE, not used anymore
0000                BASIC_ENTRY:   EQU   $0322   
0000                             ; TEMP AREA FOR STRINGS
0000                STR_TEMP_AREA:   EQU   $4B00   
0000                             ; IMAGE STRUCTS AREA, 1 RECORD IS 4 BYTE LONG:
0000                             ;   TYPE (1 byte: 1:BASIC, 2:CART, 3:CAS),
0000                             ;   START POS (2 bytes: pointer to directory entry in the CART),
0000                             ;   SIZE in blocks (1 byte)
0000                CART_NAME_STRUCT:   EQU   $4C00   
0000                TYPE_EXIT_TO_BASIC:   EQU   1   
0000                TYPE_CART:   EQU   2   
0000                TYPE_CAS:   EQU   3   
0000                TYPE_BIN:   EQU   4   
0000                TYPE_DAT:   EQU   5   
0000                             ; STORED AT THE BEGINGING OF CART
0000                SW_MAJOR_VERSION:   EQU   $21   
0000                SW_MINOR_VERSION:   EQU   $0C   
0000                             ; HOW MANY CYCLES BEFORE READING AGAIN - 2 bytes!
0000                KEYBOARD_COUNTER:   EQU   $0880   
0000                             ; WHAT IS THE LAST PRESSED KEY. 0 IS FOR NO KEY WAS PRESSED
0000                KEYBOARD_LAST_KEY:   EQU   $0882   
0000                             ; SERIAL NUMBER OF THE FIRST ITEM IN THE LIST - 2 bytes!
0000                LIST_FIRST_ELEMENT:   EQU   $0883   
0000                             ; NUMBER OF THE SELECTED LINE (0 - N_HEIGHT-1)
0000                LIST_SELECTED_ELEMENT:   EQU   $0885   
0000                             ; HOW MANY IMAGES ARE STORED IN THIS CART - 2 bytes!
0000                NUM_OF_IMAGES:   EQU   $0886   
0000                             ; SIZE OF THE FIRST FLASH IC (1: 128kB, 2: 256kB, 4: 512kB)
0000                SIZE_OF_FLASH1:   EQU   $0888   
0000                             ; SIZE OF THE SECOND FLASH IC  (0: none, 1: 128kB, 2: 256kB, 4: 512kB)
0000                SIZE_OF_FLASH2:   EQU   $0889   
0000                             ; SIZE OF RAM (0:none, 1:8kB, 2:16kB, 3:32kB, 4:64kB
0000                             ;              5:128kB, 6:256kB, 7:512kB)
0000                SIZE_OF_CART_RAM:   EQU   $088a   
0000                             ; IS THE RESET ENABLED ON CART EXECUTION (0:YES, 2:NO)
0000                RESET_ENABLED:   EQU   $088b   
0000                             ; during print table, the current pos in directory. 2 bytes!!
0000                DIRECTORY_POS:   EQU   $088c   
0000                             ; free blocks - 2 bytes!!
0000                FREE_BLOCKS_IN_BAMS:   EQU   $088e   
0000                             ; 1-AMD, 2-SST, 3-ATmel
0000                FLASH1_TYPE:   EQU   $0890   
0000                FLASH2_TYPE:   EQU   $0891   
0000                             ; Chip Manufacturer codes and IDs read from ICs
0000                FLASH1_MAN:   EQU   $0892   
0000                FLASH1_CHIP:   EQU   $0893   
0000                FLASH2_MAN:   EQU   $0894   
0000                FLASH2_CHIP:   EQU   $0895   
0000                EXT0_BASE:   EQU   $08A0   
0000                BASIC_PROGRAM_START:   EQU   $19EF   
0000                TVC_TOP:   EQU   $1726   
0000                BAM_START:   EQU   $F000   
0000                             ; PLAN
0000                             ;   - overwrite during save
0000                             ;   - W29C040, EN29F040, GLS29EE010
0000                             ;   - Load BIN file, start BASIC
0000                             ;   - Function ENTRY on CART to
0000                             ;     - load a named binary/CAS file, returning start address
0000                             ;     - load a DAT file, returning size
0000                             ; 
0000                             ; Change log:
0000                             ; 2.1.12 (screenshot provided to Jaime González Soriano)
0000                             ;   - Continue to work on Save program and DAT
0000                             ;   - API implementation:
0000                             ;     - Getting directory
0000                             ;     - Loading file (BIN start address is ignored yet)
0000                             ;     - Saving file (not ready)
0000                             ;     - Spanish language option added
0000                             ; 2.1.11
0000                             ;   Released to Vén Gábor, Pénteki Kornél, Bondár Péter
0000                             ;   - fixed name based sorting of spec chars ($5B-$5F, $7B-$7F)
0000                             ;   - fixed 512kB RAM size print
0000                             ;   - CART RAM test implemented
0000                             ;   - DAT type introduced, cannot be executed by design
0000                             ;   - BIN (not finished)
0000                             ;     - save (with start address - not finished)
0000                             ;       - enter file name, start address, length
0000                             ;       - checking available RAM
0000                             ;       - checking available space on flash (not ready)
0000                             ;       - copy BAM into C000-CFFF
0000                             ;       - refactor writes to copy bytes from TVC RAM or cart RAM
0000                             ;     - start (not finished)
0000                             ; 2.1.10
0000                             ;   - fixed filename in delete dialogbox, filenum is above 64 files..
0000                             ;   - fixed delete from a re-ordered file list
0000                             ;   - fixed print of the minor part of the version
0000                             ;   KNOWN ISSUE
0000                             ;    Underscore ("_") character and some others are out of ABC sorting.
0000                             ; 2.1.9
0000                             ;   Released to facebook, and the cart of Péter Gyöngyössy
0000                             ;   - fixed blinking cursor on remove dialog box on TVC ROM v1.2
0000                             ;   - fixed rename in sorted listbox
0000                             ;   - date contains a range of dates for development
0000                             ;   KNOWN ISSUE
0000                             ;   - blinking cursor in rename dialogbox after warm reset on TVC ROM v2.2
0000                             ; 2.1.8
0000                             ;   Released to Zoltán Csomor only
0000                             ;   - AT29C0x0 IDs recognized
0000                             ;   - Reset Enabled string is YES/NO
0000                             ;   - Refactor: Use of CART_NAME_STRUCT and the pointers to
0000                             ;     ease the future sorting feature
0000                             ;     Modified in
0000                             ;     - init struct
0000                             ;     - print list
0000                             ;     - execute selected program
0000                             ;   - Delete from list (and SST flash update) implemented
0000                             ;   - sorting based on name (Hungarian chars included), size, type
0000                             ;   - TOP is fixed for loading CAS (not relevant, overwritten by reset)
0000                             ;   - EXT0 introduced for save: BASIC programs can be saved
0000                             ;     no arbitrary binary/ML code after basic can be saved, yet
0000                             ;   - Rename in list (and SST flash update) implemented
0000                             ;   - localization support added, localized strings are statically compiled
0000                             ;     - English and Hungarian strings added
0000                             ;   - fixed extra RETURN feed on selecting BASIC/CAS/CART programs
0000                             ; 
0000                             ; 2.1.3-2.1.7 debug logs
0000                             ; 2.1.2
0000                             ;   - BIN type introduced.
0000                             ;     copies at the first two byte, unless it is less than $0880
0000                             ;   - ROM check is performed based on JEDEC standard ID check
0000                             ;     recognized chips: AM29F0x0, SST39SF0x0
0000                             ; 2.1.1
0000                             ;   - RAM check fixed, ported from 2.0.2
0000                             ;   - Calculating and printing free space are implemented
0000                             ;   - CART images also have size
0000                             ;   - numbering in listbox fixed
0000                             ;   - pagedn fixed
0000                             ;   - 2 bytes allocated for first index and num of images, in
0000                             ;      order to be able to handle more than 256 images (in theory
0000                             ;      the directory from D200 can handle up to 588 files, while the
0000                             ;      BAM can handle up to 4032 files)
0000                             ;      TODO: routines not fixed yet!
0000                             ; 2.1.0
0000                             ;   - source files are renamed, minor version changed
0000                             ;   - comments for constants
0000                             ;   - BAM is located at D000 by default, can be relocated
0000                             ;   - C00C-C00D contains BAM location (by def it is D000)
0000                             ;   - Directory is located: BAM + $0200
0000                             ;   - one file entry in directory contains
0000                             ;      4 bytes header (type, file start location, size)
0000                             ;     16 bytes filename
0000                             ;   - BAM: 2x 256bytes. Each bit refers to 256 bytes allocated
0000                             ;   - CAS file entry has a pointer to the first 256 byte block
0000                             ;     subsequent blocks pointers are in the first two bytes in each
0000                             ;     blocks in the format of <bank>,<block> (1-31 and 0-63)
0000                             ;     - Last block starts with $FF,<valid>, where <valid> contains the
0000                             ;       valid bytes in this block (and no more blocks are linked to
0000                             ;       this cas file)
0000                             ; 2.0.1
0000                             ;   - Parsing block numbers in .CAS file at $02-$03 and if
0000                             ;   present using that instead of program size from $82-$83.
0000                             ;   Num of blocks (nB * $80) is started from $80th pos of the
0000                             ;   file
0000                             ;   - Fix identifying 512kB ROM
0000                             ; 2.0.0
0000                             ;   First version that can execute CART and CAS files
0000                             ;   Usage is on screen
0000                             ;   Version string is constructed using numeric constants
0000                             ;   Joy is used for navigation
0000                             ;   RESET enable/disable works for CART executions
0030                          .ORG   $0030   
0030                             ; Only for the ease of debugging
0030   E1                     POP   hl   
0031   23                     INC   hl   
0032   E5                     PUSH   hl   
0033   C9                     RET      
C000                          .ORG   CARTSTART   
C000   4D 4F 50 53            DB   "MOPS"   
C004                ENTRY:       
C004   18 0E                  JR   MAIN   ; +4
C006   21                     DB   SW_MAJOR_VERSION   ; +6
C007   0C                     DB   SW_MINOR_VERSION   ; +7
C008                BAM_START_ADDRESS:      
C008   00 F0                  DW   BAM_START   ; +8
C00A   A7 CC                  DW   CONFIGURE_EXT0   ; +10
C00C   1D D6                  DW   GET_FIRST_DIRECTORY_ENTRY   ; +12
C00E   53 D6                  DW   GET_NEXT_DIRECTORY_ENTRY   ; +14
C010   84 D6                  DW   LOAD_FILE_TO_TVCRAM   ; +16
C012   62 D7                  DW   SAVE_FILE_TO_MULTICART   ; +18
C014                MAIN:        
C014   F3                     DI      
C015   AF                     XOR   a   
C016   ED 47                  LD   i,a   
C018   3E 30                  LD   a,$30   ; set U0-U1-U2-CART
C01A   D3 02                  OUT   (2),a   
C01C   32 03 00               LD   (3),a   ; save paging
C01F   3E 02                  LD   a,$02   
C021   D3 00                  OUT   (0),a   
C023   CD 51 C0               CALL   F_INIT   
C026   CD 32 31               CALL   f_check_RAM_size   
C029   CD 82 C0               CALL   f_print_header   
C02C   F3                     DI      
C02D   CD 00 30               CALL   F_CHECK_ROM_IDS   
C030   CD 8F C1               CALL   f_print_ROM_size   
C033   F3                     DI      
C034   CD C6 30               CALL   F_CALC_FREE_SPACE   
C037   CD B4 C1               CALL   F_PRINT_FREE_SPACE   
C03A   F3                     DI      
C03B   CD 77 C1               CALL   f_print_RAM_found   
C03E   F3                     DI      
C03F   CD 0A C2               CALL   F_PRINT_FRAME   
C042   CD F5 32               CALL   F_INIT_ENTRIES   
C045                MAIN_LOOP:      
C045   CD A9 C2               CALL   F_REWRITE_LIST   
C048   CD 5D C1               CALL   F_PRINT_RESET_STATUS   
C04B   F3                     DI      
C04C   CD A9 C7               CALL   F_HANDLE_INPUT   
C04F   18 F4                  JR   MAIN_LOOP   
C051                F_INIT:      
C051   0E 00                  LD   c,0   ; video mode set to 2 colors, 80 columns
C053   F7                     RST   30h   
C054   04                     DB   $04   
C055   F3                     DI      
C056                             ; copy relocated code/data
C056   11 00 30               LD   de,reloc   
C059   21 70 DA               LD   hl,code_in_cart   
C05C   01 39 0E               LD   bc,End_reloc-reloc   
C05F   ED B0                  LDIR      
C061                             ; init name structure, fill with 0...
C061   AF                     XOR   A   
C062   21 00 4C               LD   hl,CART_NAME_STRUCT   
C065   11 01 4C               LD   de,CART_NAME_STRUCT+1   
C068   01 FF 03               LD   bc,$03ff   ; $0400
C06B   77                     LD   (hl),a   
C06C   ED B0                  LDIR      
C06E   32 83 08               LD   (LIST_FIRST_ELEMENT),a   
C071   32 85 08               LD   (LIST_SELECTED_ELEMENT),a   
C074                             ; RESET ENABLED by default (0: enabled, 2: disabled)
C074   32 8B 08               LD   (RESET_ENABLED),A   
C077                             ; ... and fill 1st entry with "return to basic"
C077   3E 01                  LD   a,TYPE_EXIT_TO_BASIC   
C079   32 00 4C               LD   (CART_NAME_STRUCT),a   
C07C                             ; disable blinking cursor on enabled interrupt
C07C   21 10 0B               LD   hl,INT_DES   
C07F   CB D6                  SET   2,(hl)   
C081   C9                     RET      
C082                USG_X:    EQU   34   
C082                USG_Y:    EQU   13   
C082                F_PRINT_HEADER:      
C082   0E 01                  LD   c,1   ; BTEXT set position y
C084   06 04                  LD   b,4   ; set x
C086   F7                     RST   30h   
C087   23                     DB   $23   
C088   11 63 3A               LD   de,str_message   ; VID_BKOUT
C08B   01 33 00               LD   bc,str_message_end-str_message   
C08E   F7                     RST   30h   
C08F   22                     DB   $22   
C090   0E 32                  LD   c,SW_MAJOR_VERSION / 16 + "0"   
C092   F7                     RST   30h   
C093   21                     DB   $21   
C094   0E 2E                  LD   c,"."   
C096   F7                     RST   30h   
C097   21                     DB   $21   
C098   0E 31                  LD   c,SW_MAJOR_VERSION # 16 + "0"   
C09A   F7                     RST   30h   
C09B   21                     DB   $21   
C09C   0E 2E                  LD   c,"."   
C09E   F7                     RST   30h   
C09F   21                     DB   $21   
C0A0   21 0C 00               LD   hl,SW_MINOR_VERSION   
C0A3   CD 4A C4               CALL   F_PRINT_NUMBER_NON_ZERO_LEAD   
C0A6                             ;            LD      c,SW_MINOR_VERSION # 16 + "0"
C0A6                             ;            RST     30h
C0A6                             ;            DB      $21
C0A6   0E 68                  LD   c,STR_LANG_LETTER   
C0A8   F7                     RST   30h   
C0A9   21                     DB   $21   
C0AA   0E 02                  LD   c,2   ; BTEXT set position
C0AC   06 1F                  LD   b,64-(str_author_end-str_author)+1   
C0AE   F7                     RST   30h   
C0AF   23                     DB   $23   
C0B0   11 EC 39               LD   de,str_author   ; VID_BKOUT
C0B3   01 22 00               LD   bc,str_author_end-str_author   
C0B6   F7                     RST   30h   
C0B7   22                     DB   $22   
C0B8   0E 0D                  LD   C,USG_Y   
C0BA   06 23                  LD   B,USG_X+1   
C0BC   F7                     RST   30h   
C0BD   23                     DB   $23   
C0BE   11 37 3B               LD   de,STR_USAGE   
C0C1   01 14 00               LD   bc,STR_USAGE_END - STR_USAGE   
C0C4   F7                     RST   30h   
C0C5   22                     DB   $22   
C0C6   0E 0F                  LD   C,USG_Y+2   
C0C8   06 24                  LD   B,USG_X+2   
C0CA   F7                     RST   30h   
C0CB   23                     DB   $23   
C0CC   11 4B 3B               LD   de,STR_UPDN   
C0CF   01 1B 00               LD   bc,STR_UPDN_END - STR_UPDN   
C0D2   F7                     RST   30h   
C0D3   22                     DB   $22   
C0D4   0E 10                  LD   C,USG_Y+3   
C0D6   06 24                  LD   B,USG_X+2   
C0D8   F7                     RST   30h   
C0D9   23                     DB   $23   
C0DA   11 66 3B               LD   de,STR_PGUPDN   
C0DD   01 1C 00               LD   bc,STR_PGUPDN_END - STR_PGUPDN   
C0E0   F7                     RST   30h   
C0E1   22                     DB   $22   
C0E2   0E 11                  LD   C,USG_Y+4   
C0E4   06 24                  LD   B,USG_X+2   
C0E6   F7                     RST   30h   
C0E7   23                     DB   $23   
C0E8   11 82 3B               LD   de,STR_TOGGLE_RESET   
C0EB   01 17 00               LD   bc,STR_TOGGLE_RESET_END - STR_TOGGLE_RESET   
C0EE   F7                     RST   30h   
C0EF   22                     DB   $22   
C0F0   0E 12                  LD   C,USG_Y+5   
C0F2   06 24                  LD   B,USG_X+2   
C0F4   F7                     RST   30h   
C0F5   23                     DB   $23   
C0F6   11 99 3B               LD   de,STR_START_PROGRAM   
C0F9   01 1D 00               LD   bc,STR_START_PROGRAM_END - STR_START_PROGRAM   
C0FC   F7                     RST   30h   
C0FD   22                     DB   $22   
C0FE   0E 13                  LD   C,USG_Y+6   
C100   06 24                  LD   B,USG_X+2   
C102   F7                     RST   30h   
C103   23                     DB   $23   
C104   11 B6 3B               LD   de,STR_DELETE_PROGRAM   
C107   01 1B 00               LD   bc,STR_DELETE_PROGRAM_END - STR_DELETE_PROGRAM   
C10A   F7                     RST   30h   
C10B   22                     DB   $22   
C10C   0E 14                  LD   C,USG_Y+7   
C10E   06 24                  LD   B,USG_X+2   
C110   F7                     RST   30h   
C111   23                     DB   $23   
C112   11 FF 3B               LD   de,STR_RENAME   
C115   01 1C 00               LD   bc,STR_RENAME_END - STR_RENAME   
C118   F7                     RST   30h   
C119   22                     DB   $22   
C11A   0E 15                  LD   C,USG_Y+8   
C11C   06 24                  LD   B,USG_X+2   
C11E   F7                     RST   30h   
C11F   23                     DB   $23   
C120   11 D1 3B               LD   de,STR_SORT_INSTRUCTIONS   
C123   01 1C 00               LD   bc,STR_SORT_INSTRUCTIONS_END - STR_SORT_INSTRUCTIONS   
C126   F7                     RST   30h   
C127   22                     DB   $22   
C128   0E 16                  LD   C,USG_Y+9   
C12A   06 24                  LD   B,USG_X+2   
C12C   F7                     RST   30h   
C12D   23                     DB   $23   
C12E   11 ED 3B               LD   de,STR_SORT_RESET   
C131   01 12 00               LD   bc,STR_SORT_RESET_END - STR_SORT_RESET   
C134   F7                     RST   30h   
C135   22                     DB   $22   
C136   3A 8A 08               LD   a,(SIZE_OF_CART_RAM)   
C139   FE 00                  CP   $00   
C13B   28 0E                  JR   z,L_PRINT_RESET_HEADER   
C13D   0E 17                  LD   C,USG_Y+10   
C13F   06 24                  LD   B,USG_X+2   
C141   F7                     RST   30h   
C142   23                     DB   $23   
C143   11 8C 3D               LD   de,STR_TEST_CART_RAM   
C146   01 16 00               LD   bc,STR_TEST_CART_RAM_END - STR_TEST_CART_RAM   
C149   F7                     RST   30h   
C14A   22                     DB   $22   
C14B                L_PRINT_RESET_HEADER:      
C14B   0E 04                  LD   C,4   
C14D   06 01                  LD   B,1   
C14F   F7                     RST   30h   
C150   23                     DB   $23   
C151   11 1B 3C               LD   de,STR_RESET_CART   
C154   01 1E 00               LD   bc,STR_RESET_CART_END - STR_RESET_CART   
C157   F7                     RST   30h   
C158   22                     DB   $22   
C159   CD 5D C1               CALL   F_PRINT_RESET_STATUS   
C15C   C9                     RET      
C15D                F_PRINT_RESET_STATUS:      
C15D   0E 04                  LD   C,4   
C15F   06 1F                  LD   B,1 + STR_RESET_CART_END-STR_RESET_CART   
C161   F7                     RST   30h   
C162   23                     DB   $23   
C163   01 04 00               LD   bc,STR_ENABLED_END-STR_ENABLED   
C166   3A 8B 08               LD   a,(RESET_ENABLED)   
C169   FE 00                  CP   $00   
C16B   11 39 3C               LD   de,STR_ENABLED   
C16E   CA 74 C1               JP   z,PRS_SKIP_DISABLED   
C171   11 3D 3C               LD   de,STR_DISABLED   
C174                PRS_SKIP_DISABLED:      
C174   F7                     RST   30h   
C175   22                     DB   $22   
C176   C9                     RET      
C177                F_PRINT_RAM_FOUND:      
C177   0E 03                  LD   c,3   ; BTEXT set position
C179   06 01                  LD   b,1   
C17B   F7                     RST   30h   
C17C   23                     DB   $23   
C17D   11 96 3A               LD   de,str_ram_found   ; VID_BKOUT
C180   01 0F 00               LD   bc,str_ram_found_end-str_ram_found   
C183   F7                     RST   30h   
C184   22                     DB   $22   
C185   21 1C 3B               LD   hl,ram_sizes_pos   
C188   01 8A 08               LD   bc,SIZE_OF_CART_RAM   
C18B   CD FB C1               CALL   f_print_from_array   
C18E   C9                     RET      
C18F                F_PRINT_ROM_SIZE:      
C18F   0E 02                  LD   c,2   ; BTEXT set position
C191   06 01                  LD   b,1   
C193   F7                     RST   30h   
C194   23                     DB   $23   
C195   11 A5 3A               LD   de,STR_FLASH_FOUND   ; VID_BKOUT
C198   01 11 00               LD   bc,STR_FLASH_FOUND_END-STR_FLASH_FOUND   
C19B   F7                     RST   30h   
C19C   22                     DB   $22   
C19D   21 EA 3A               LD   hl,FLASH_SIZES_POS   
C1A0   01 88 08               LD   bc,SIZE_OF_FLASH1   
C1A3   CD FB C1               CALL   f_print_from_array   
C1A6   0E 2C                  LD   c,","   
C1A8   F7                     RST   30h   
C1A9   21                     DB   $21   
C1AA   21 EA 3A               LD   hl,FLASH_SIZES_POS   
C1AD   01 89 08               LD   bc,SIZE_OF_FLASH2   
C1B0   CD FB C1               CALL   f_print_from_array   
C1B3   C9                     RET      
C1B4                F_PRINT_FREE_SPACE:      
C1B4   0E 05                  LD   C,5   
C1B6   06 01                  LD   B,1   
C1B8   F7                     RST   30h   
C1B9   23                     DB   $23   
C1BA   11 B6 3A               LD   de,STR_FREE_SPACE   ; VID_BKOUT
C1BD   01 1A 00               LD   bc,STR_FREE_SPACE_END-STR_FREE_SPACE   
C1C0   F7                     RST   30h   
C1C1   22                     DB   $22   
C1C2   2A 8E 08               LD   hl,(FREE_BLOCKS_IN_BAMS)   
C1C5   CD 4A C4               CALL   F_PRINT_NUMBER_NON_ZERO_LEAD   
C1C8   11 D0 3A               LD   de,STR_BLOCKS   ; VID_BKOUT
C1CB   01 06 00               LD   bc,STR_BLOCKS_END-STR_BLOCKS   
C1CE   F7                     RST   30h   
C1CF   22                     DB   $22   
C1D0   0E 2F                  LD   c,"/"   
C1D2   F7                     RST   30h   
C1D3   21                     DB   $21   
C1D4                             ; 
C1D4   2A 8E 08               LD   hl,(FREE_BLOCKS_IN_BAMS)   
C1D7   11 02 00               LD   de,0002   
C1DA   19                     ADD   hl,de   
C1DB   CB 3C                  SRL   h   
C1DD   CB 1D                  RR   l   
C1DF   CB 3C                  SRL   h   
C1E1   CB 1D                  RR   l   
C1E3   CD 4A C4               CALL   F_PRINT_NUMBER_NON_ZERO_LEAD   
C1E6   0E 20                  LD   c," "   
C1E8   F7                     RST   30h   
C1E9   21                     DB   $21   
C1EA   11 01 3B               LD   de,STR_CART_SIZE+2   ; VID_BKOUT
C1ED   01 02 00               LD   bc,2   ; "kB" - always 2 char long
C1F0   F7                     RST   30h   
C1F1   22                     DB   $22   
C1F2   0E 20                  LD   c," "   
C1F4   F7                     RST   30h   
C1F5   21                     DB   $21   
C1F6   0E 20                  LD   c," "   
C1F8   F7                     RST   30h   
C1F9   21                     DB   $21   
C1FA   C9                     RET      
C1FB                F_PRINT_FROM_ARRAY:      ; str length in array is always 5 char long
C1FB                             ; hl - string start pointers
C1FB                             ; bc - index
C1FB   0A                     LD   a,(bc)   
C1FC   07                     RLCA      
C1FD   06 00                  LD   b,$0   
C1FF   4F                     LD   c,a   
C200   09                     ADD   hl,bc   
C201   5E                     LD   e,(hl)   
C202   23                     INC   hl   
C203   56                     LD   d,(hl)   
C204   01 05 00               LD   bc,5   
C207   F7                     RST   30h   
C208   22                     DB   $22   
C209   C9                     RET      
C20A                F_PRINT_FRAME:      
C20A   F3                     DI      
C20B   3E 10                  LD   a,$10   
C20D   D3 02                  OUT   (2),a   
C20F   CD 51 C2               CALL   f_print_frame_top   
C212   CD 58 C2               CALL   f_print_frame_mid   
C215   CD 77 C2               CALL   f_print_frame_btm   
C218   3E 30                  LD   a,$30   
C21A   D3 02                  OUT   (2),a   
C21C   0E 06                  LD   c,Y0+1   ; BTEXT set position
C21E   06 04                  LD   b,X0 + 3   
C220   F7                     RST   30h   
C221   23                     DB   $23   
C222   0E 23                  LD   c,"#"   
C224   F7                     RST   30h   
C225   21                     DB   $21   
C226   0E 06                  LD   c,Y0+1   ; BTEXT set position
C228   06 0D                  LD   b,X0 + 3 + N_NUM + 6   
C22A   F7                     RST   30h   
C22B   23                     DB   $23   
C22C   11 2C 3B               LD   de,STR_NAME   
C22F   01 03 00               LD   bc,STR_NAME_END - STR_NAME   
C232   F7                     RST   30h   
C233   22                     DB   $22   
C234   0E 06                  LD   c,Y0+1   ; BTEXT set position
C236   06 18                  LD   b,X0 + N_NUM + N_NAME + 4   
C238   F7                     RST   30h   
C239   23                     DB   $23   
C23A   11 33 3B               LD   de,STR_TYPE   
C23D   01 04 00               LD   bc,STR_TYPE_END - STR_TYPE   
C240   F7                     RST   30h   
C241   22                     DB   $22   
C242   0E 06                  LD   c,Y0+1   ; BTEXT set position
C244   06 1D                  LD   b,X0 + N_NUM + N_NAME + N_TYPE + 5   
C246   F7                     RST   30h   
C247   23                     DB   $23   
C248   11 2F 3B               LD   de,STR_SIZE   
C24B   01 04 00               LD   bc,STR_SIZE_END - STR_SIZE   
C24E   F7                     RST   30h   
C24F   22                     DB   $22   
C250   C9                     RET      
C251                F_PRINT_FRAME_TOP:      
C251   21 C1 8D               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0   
C254   CD 7E C2               CALL   F_PRINT_H_LINE   
C257   C9                     RET      
C258                F_PRINT_FRAME_MID:      
C258   21 01 8E               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0 + 64   
C25B   CD 8B C2               CALL   F_PRINT_V_LINE   
C25E   21 05 8E               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0+N_NUM + 1 + 64   
C261   CD 8B C2               CALL   F_PRINT_V_LINE   
C264   21 16 8E               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0+N_NUM+N_NAME + 2 + 64   
C267   CD 8B C2               CALL   F_PRINT_V_LINE   
C26A   21 1B 8E               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0+N_NUM+N_NAME+N_TYPE + 3 + 64   
C26D   CD 8B C2               CALL   F_PRINT_V_LINE   
C270   21 20 8E               LD   hl,$8000 + (Y0*64*10) + 64*5 + X0+N_NUM+N_NAME+N_TYPE+N_SIZE + 4 + 64   
C273   CD 8B C2               CALL   F_PRINT_V_LINE   
C276   C9                     RET      
C277                F_PRINT_FRAME_BTM:      
C277   21 41 B8               LD   hl,$8000 + ((Y0+N_HEIGHT+1)*64*10) + 64*5 + X0   
C27A   CD 7E C2               CALL   F_PRINT_H_LINE   
C27D   C9                     RET      
C27E                F_PRINT_H_LINE:      
C27E   36 0F                  LD   (hl),00001111b   
C280   23                     INC   hl   
C281   06 1E                  LD   b,n_num+N_name+n_type+N_size+3   
C283                PRINT_LOOP_P1:      
C283   36 FF                  LD   (hl),$ff   
C285   23                     INC   hl   
C286   10 FB                  DJNZ   print_loop_p1   
C288   36 F8                  LD   (hl),11111000b   
C28A   C9                     RET      
C28B                F_PRINT_V_LINE:      
C28B   06 04                  LD   b,4   
C28D   11 40 00               LD   de,64   
C290                PRINT_LOOP_P2:      
C290   36 08                  LD   (hl),00001000b   
C292   19                     ADD   hl,de   
C293   10 FB                  DJNZ   print_loop_p2   
C295   0E 10                  LD   c,N_HEIGHT   
C297                PRINT_LOOP_P3:      
C297   06 0A                  LD   b,10   
C299                PRINT_LOOP_P4:      
C299   36 08                  LD   (hl),00001000b   
C29B   19                     ADD   hl,de   
C29C   10 FB                  DJNZ   print_loop_p4   
C29E   0D                     DEC   c   
C29F   20 F6                  JR   nz,print_loop_p3   
C2A1   06 05                  LD   b,5   
C2A3                PRINT_LOOP_P5:      
C2A3   36 08                  LD   (hl),00001000b   
C2A5   19                     ADD   hl,de   
C2A6   10 FB                  DJNZ   print_loop_p5   
C2A8   C9                     RET      
C2A9                F_REWRITE_LIST:      
C2A9   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
C2AC   6F                     LD   l,a   
C2AD   26 00                  LD   h,0   
C2AF   CB 25                  SLA   l   
C2B1   CB 14                  RL   h   
C2B3   CB 25                  SLA   l   
C2B5   CB 14                  RL   h   
C2B7   11 00 4C               LD   de,CART_NAME_STRUCT   
C2BA   19                     ADD   hl,de   
C2BB                RL_DIRECTORY_POS_DONE:      
C2BB   22 8C 08               LD   (DIRECTORY_POS),hl   
C2BE   16 00                  LD   d,0   ; line in the listbox
C2C0   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
C2C3   5F                     LD   e,a   ; first line in the listbox
C2C4                PRINT_LOOP_LINES:      
C2C4   D5                     PUSH   de   
C2C5   3E 07                  LD   a,Y0+2   ; let's position to act line, type
C2C7   82                     ADD   a,d   
C2C8   4F                     LD   c,a   ; position TYPE
C2C9   06 18                  LD   b,X0+2+N_NUM+N_NAME+2   
C2CB   F7                     RST   30h   
C2CC   23                     DB   $23   
C2CD                             ; 
C2CD   2A 8C 08               LD   hl,(DIRECTORY_POS)   
C2D0   AF                     XOR   A   
C2D1   BE                     CP   (hl)   
C2D2   CA D6 C3               JP   z,print_rl_exit   
C2D5   3E 01                  LD   a,TYPE_EXIT_TO_BASIC   
C2D7   BE                     CP   (hl)   
C2D8   20 1C                  JR   nz,PRINT_RL_CHECK_CART   
C2DA                             ; PRINT --- (EXIT TO BASIC TYPE AND SIZE)
C2DA   11 12 3A               LD   de,STR_TYPE_SIZE_BAS   ; VID_BKOUT
C2DD   01 04 00               LD   bc,4   
C2E0   F7                     RST   30h   
C2E1   22                     DB   $22   
C2E2   D1                     POP   de   
C2E3   D5                     PUSH   de   
C2E4   3E 07                  LD   a,y0+2   
C2E6   82                     ADD   a,d   
C2E7   4F                     LD   c,a   ; position SIZE
C2E8   06 1D                  LD   b,X0+2+N_NUM+N_NAME+N_TYPE+3   
C2EA   F7                     RST   30h   
C2EB   23                     DB   $23   
C2EC   11 12 3A               LD   de,STR_TYPE_SIZE_BAS   ; VID_BKOUT
C2EF   01 04 00               LD   bc,4   
C2F2   F7                     RST   30h   
C2F3   22                     DB   $22   
C2F4   18 5C                  JR   PRINT_RL_ROW_NUM   
C2F6                PRINT_RL_CHECK_CART:      
C2F6   3E 02                  LD   a,TYPE_CART   
C2F8   BE                     CP   (hl)   
C2F9   20 08                  JR   nz,PRINT_RL_CAS   
C2FB   11 16 3A               LD   de,STR_TYPE_CART   ; VID_BKOUT
C2FE   01 04 00               LD   bc,STR_TYPE_CART_END-STR_TYPE_CART   
C301   18 22                  JR   L_PRINT_ACTUAL_TYPE   
C303                PRINT_RL_CAS:      
C303   3E 03                  LD   a,TYPE_CAS   
C305   BE                     CP   (hl)   
C306   20 08                  JR   nz,PRINT_RL_BIN   
C308   11 1A 3A               LD   de,STR_TYPE_CAS   ; VID_BKOUT
C30B   01 04 00               LD   bc,STR_TYPE_CAS_END-STR_TYPE_CAS   
C30E   18 15                  JR   L_PRINT_ACTUAL_TYPE   
C310                PRINT_RL_BIN:      
C310   3E 04                  LD   a,TYPE_BIN   
C312   BE                     CP   (hl)   
C313   20 08                  JR   nz,PRINT_RL_DAT   
C315   11 1E 3A               LD   de,STR_TYPE_BIN   ; VID_BKOUT
C318   01 04 00               LD   bc,STR_TYPE_BIN_END-STR_TYPE_BIN   
C31B   18 08                  JR   L_PRINT_ACTUAL_TYPE   
C31D                PRINT_RL_DAT:      
C31D   11 22 3A               LD   de,STR_TYPE_DAT   ; VID_BKOUT
C320   01 04 00               LD   bc,STR_TYPE_DAT_END-STR_TYPE_DAT   
C323   18 00                  JR   L_PRINT_ACTUAL_TYPE   
C325                L_PRINT_ACTUAL_TYPE:      
C325   F7                     RST   30h   
C326   22                     DB   $22   
C327   D1                     POP   de   
C328   D5                     PUSH   de   
C329   3E 07                  LD   a,y0+2   
C32B   82                     ADD   a,d   
C32C   4F                     LD   c,a   ; Set size position
C32D   06 1D                  LD   b,X0+2+N_NUM+N_NAME+N_TYPE+3   
C32F   F7                     RST   30h   
C330   23                     DB   $23   
C331                PRINT_RL_SIZE:      
C331   2A 8C 08               LD   HL,(DIRECTORY_POS)   
C334   23                     INC   HL   
C335   23                     INC   HL   
C336   23                     INC   HL   
C337   7E                     LD   A,(HL)   
C338   6F                     LD   l,a   
C339   26 00                  LD   h,0   
C33B   11 02 00               LD   de,0002   
C33E   19                     ADD   hl,de   
C33F   CB 3C                  SRL   h   
C341   CB 1D                  RR   l   
C343   CB 3C                  SRL   h   
C345   CB 1D                  RR   l   
C347   CD 79 C4               CALL   f_print_number_2   
C34A   11 01 3B               LD   de,STR_CART_SIZE+2   ; VID_BKOUT
C34D   01 02 00               LD   bc,2   ; "kB" - always 2 char long
C350   F7                     RST   30h   
C351   22                     DB   $22   
C352                PRINT_RL_ROW_NUM:      
C352   D1                     POP   de   
C353   D5                     PUSH   de   
C354   3E 07                  LD   a,y0+2   
C356   82                     ADD   a,d   
C357   4F                     LD   c,a   ; setting char to num
C358   06 03                  LD   b,X0+2   
C35A   F7                     RST   30h   
C35B   23                     DB   $23   
C35C   D1                     POP   de   
C35D   D5                     PUSH   de   
C35E   7B                     LD   a,e   
C35F   82                     ADD   a,d   
C360   6F                     LD   l,a   
C361   AF                     XOR   a   
C362   17                     RLA      
C363   67                     LD   h,a   
C364   CD 73 C4               CALL   F_print_number_3   
C367   D1                     POP   de   
C368   D5                     PUSH   de   
C369   3E 07                  LD   a,y0+2   
C36B   82                     ADD   a,d   
C36C   4F                     LD   c,a   ; setting char to name
C36D   06 07                  LD   b,X0+2+N_NUM+1   
C36F   F7                     RST   30h   
C370   23                     DB   $23   
C371   2A 8C 08               LD   HL,(DIRECTORY_POS)   
C374                             ; === new type of print
C374   23                     INC   hl   
C375   5E                     LD   e,(hl)   
C376   23                     INC   hl   
C377   56                     LD   d,(hl)   
C378   23                     INC   hl   
C379   23                     INC   hl   
C37A   22 8C 08               LD   (DIRECTORY_POS),HL   
C37D   EB                     EX   de,hl   
C37E                             ; === end of change
C37E   01 04 00               LD   bc,4   
C381   09                     ADD   hl,bc   
C382   01 10 00               LD   bc,16   
C385   11 00 4B               LD   de,STR_TEMP_AREA   
C388   ED B0                  LDIR      
C38A                             ; old type of print
C38A                             ;            LD      (DIRECTORY_POS),HL
C38A                             ; end of old type of print
C38A   11 00 4B               LD   de,STR_TEMP_AREA   ; VID_BKOUT
C38D   01 10 00               LD   bc,16   ; image name is always 16 char long
C390   F7                     RST   30h   
C391   22                     DB   $22   
C392                             ; are we in selected line?
C392   D1                     POP   de   
C393   D5                     PUSH   de   
C394   7A                     LD   a,d   
C395   21 85 08               LD   hl,LIST_SELECTED_ELEMENT   
C398   BE                     CP   (HL)   
C399   20 32                  JR   nz,PRINT_RL_SKIP_HIGHTLIGHT   
C39B                             ; we are in a selected line, lets invert the chars!
C39B   F3                     DI      
C39C   3E 10                  LD   a,$10   
C39E   D3 02                  OUT   (2),a   
C3A0   42                     LD   b,d   
C3A1   04                     INC   b   
C3A2   11 80 02               LD   de,640   
C3A5   21 82 8C               LD   hl,$8000 + (Y0)*640 + X0 + 1   
C3A8                ADD_ONE_LINE:      
C3A8   19                     ADD   hl,de   
C3A9   10 FD                  DJNZ   ADD_ONE_LINE   
C3AB   06 0A                  LD   b,10   
C3AD                NEXT_LINE:      
C3AD   C5                     PUSH   bc   
C3AE   E5                     PUSH   hl   
C3AF   11 46 C4               LD   de,one_list_lengths   
C3B2   0E 04                  LD   c,4   
C3B4                NEXT_WORD:      
C3B4   1A                     LD   a,(de)   
C3B5   47                     LD   b,a   
C3B6                PRINT_NEGATE:      
C3B6   7E                     LD   a,(hl)   
C3B7   2F                     CPL      
C3B8   77                     LD   (hl),a   
C3B9   23                     INC   hl   
C3BA   10 FA                  DJNZ   PRINT_NEGATE   
C3BC   23                     INC   hl   
C3BD   13                     INC   de   
C3BE   0D                     DEC   c   
C3BF   20 F3                  JR   nz,next_word   
C3C1   E1                     POP   hl   
C3C2   01 40 00               LD   bc,64   
C3C5   09                     ADD   hl,bc   
C3C6   C1                     POP   bc   
C3C7   10 E4                  DJNZ   next_line   
C3C9   3E 30                  LD   a,$30   
C3CB   D3 02                  OUT   (2),a   
C3CD                PRINT_RL_SKIP_HIGHTLIGHT:      
C3CD   D1                     POP   de   
C3CE   14                     INC   d   
C3CF   3E 10                  LD   a,N_HEIGHT   
C3D1   BA                     CP   d   
C3D2   C2 C4 C2               JP   nz,PRINT_LOOP_LINES   
C3D5   D5                     PUSH   de   
C3D6                PRINT_RL_EXIT:      
C3D6   D1                     POP   de   
C3D7   C9                     RET      
C3D8                F_CLEAR_ONE_LINE_IN_BOX:      
C3D8   F3                     DI      
C3D9   3E 10                  LD   a,$10   
C3DB   D3 02                  OUT   (2),a   
C3DD   CD 25 C4               CALL   MULTIPLE_C_BY_640   
C3E0   E5                     PUSH   hl   
C3E1   11 82 8C               LD   de,$8000 + (Y0)*640 + X0 + 1   
C3E4   19                     ADD   hl,de   
C3E5   06 03                  LD   b,N_NUM   
C3E7   CD 0F C4               CALL   SPACE_STRING   
C3EA   E1                     POP   hl   
C3EB   E5                     PUSH   hl   
C3EC   11 86 8C               LD   de,$8000 + (Y0)*640 + N_NUM + X0 + 2   
C3EF   19                     ADD   hl,de   
C3F0   06 10                  LD   b,N_NAME   
C3F2   CD 0F C4               CALL   SPACE_STRING   
C3F5   E1                     POP   hl   
C3F6   E5                     PUSH   hl   
C3F7   11 97 8C               LD   de,$8000 + (Y0)*640 + N_NUM + N_NAME + X0 + 3   
C3FA   19                     ADD   hl,de   
C3FB   06 04                  LD   b,N_TYPE   
C3FD   CD 0F C4               CALL   SPACE_STRING   
C400   E1                     POP   hl   
C401   11 9C 8C               LD   de,$8000 + (Y0)*640 + N_NUM + N_NAME + N_TYPE + X0 + 4   
C404   19                     ADD   hl,de   
C405   06 04                  LD   b,N_SIZE   
C407   CD 0F C4               CALL   SPACE_STRING   
C40A   3E 30                  LD   a,$30   
C40C   D3 02                  OUT   (2),a   
C40E   C9                     RET      
C40F                SPACE_STRING:      
C40F   AF                     XOR   a   
C410   50                     LD   d,b   
C411   0E 0A                  LD   c,10   
C413   E5                     PUSH   hl   
C414                L_CLEAR_LOOP:      
C414   77                     LD   (hl),a   
C415   23                     INC   hl   
C416   10 FC                  DJNZ   L_CLEAR_LOOP   
C418   42                     LD   b,d   ; orig counter
C419   11 40 00               LD   de,64   
C41C   E1                     POP   hl   
C41D   19                     ADD   hl,de   
C41E   E5                     PUSH   hl   
C41F   50                     LD   d,b   
C420   0D                     DEC   c   
C421   20 F1                  JR   nz,L_CLEAR_LOOP   
C423   E1                     POP   hl   
C424   C9                     RET      
C425                MULTIPLE_C_BY_640:      ; result is in hl
C425   69                     LD   l,c   ; mul by 8
C426   26 00                  LD   h,0   
C428   CB 25                  SLA   l   
C42A   CB 14                  RL   h   
C42C   CB 25                  SLA   l   
C42E   CB 14                  RL   h   
C430   CB 25                  SLA   l   
C432   CB 14                  RL   h   
C434   EB                     EX   de,hl   
C435   69                     LD   l,c   
C436   26 00                  LD   h,0   
C438   CB 25                  SLA   l   ; mul by 2
C43A   CB 14                  RL   h   
C43C   19                     ADD   hl,de   ; add x8 and x2 = x10
C43D   06 06                  LD   b,6   
C43F                L_MUL_64:      
C43F   CB 25                  SLA   l   
C441   CB 14                  RL   h   
C443   10 FA                  DJNZ   L_MUL_64   
C445   C9                     RET      
C446                ONE_LIST_LENGTHS:      
C446   03 10 04 04            DB   N_NUM,N_NAME,N_TYPE,N_SIZE   
C44A                             ;Number in hl to decimal ASCII
C44A                             ;Thanks to z80 Bits
C44A                             ;inputs:	hl = number to ASCII
C44A                             ;example: hl=300 outputs "00300"
C44A                F_PRINT_NUMBER_NON_ZERO_LEAD:      
C44A   E5                     PUSH   hl   
C44B   37                     SCF      
C44C   3F                     CCF      
C44D   01 E8 03               LD   bc,1000   
C450   ED 42                  SBC   HL,BC   
C452   E1                     POP   HL   
C453   30 18                  JR   nc,F_PRINT_NUMBER_4   
C455   E5                     PUSH   hl   
C456   37                     SCF      
C457   3F                     CCF      
C458   01 64 00               LD   bc,100   
C45B   ED 42                  SBC   HL,BC   
C45D   E1                     POP   HL   
C45E   30 13                  JR   nc,F_PRINT_NUMBER_3   
C460   E5                     PUSH   hl   
C461   37                     SCF      
C462   3F                     CCF      
C463   01 0A 00               LD   bc,10   
C466   ED 42                  SBC   HL,BC   
C468   E1                     POP   HL   
C469   30 0E                  JR   nc,F_PRINT_NUMBER_2   
C46B   38 12                  JR   c,F_PRINT_NUMBER_1   
C46D                F_PRINT_NUMBER_4:      
C46D   01 18 FC               LD   bc,$FC18   ; -1000
C470   CD 82 C4               CALL   Num1   
C473                F_PRINT_NUMBER_3:      
C473   01 9C FF               LD   bc,-100   
C476   CD 82 C4               CALL   Num1   
C479                F_PRINT_NUMBER_2:      
C479   01 F6 FF               LD   bc,-10   
C47C   CD 82 C4               CALL   Num1   
C47F                F_PRINT_NUMBER_1:      
C47F   01 FF FF               LD   bc,-1   
C482                NUM1:        
C482   3E 2F                  LD   a,"0"-1   
C484                NUM2:        
C484   3C                     INC   a   
C485   09                     ADD   hl,bc   
C486   38 FC                  JR   c,Num2   
C488   ED 42                  SBC   hl,bc   
C48A   E5                     PUSH   hl   
C48B   4F                     LD   c,a   
C48C   F7                     RST   30h   
C48D   21                     DB   $21   
C48E   E1                     POP   hl   
C48F   C9                     RET      
C490                F_PRINT_HEX_NUMBER:      ; number in HL
C490   E5                     PUSH   hl   
C491   7C                     LD   a,h   
C492   0F                     RRCA      
C493   0F                     RRCA      
C494   0F                     RRCA      
C495   0F                     RRCA      
C496   CD B0 C4               CALL   L_PRINT_HEX_DIGIT   
C499   E1                     POP   hl   
C49A   E5                     PUSH   hl   
C49B   7C                     LD   a,h   
C49C   CD B0 C4               CALL   L_PRINT_HEX_DIGIT   
C49F   E1                     POP   hl   
C4A0   E5                     PUSH   hl   
C4A1   7D                     LD   a,l   
C4A2   0F                     RRCA      
C4A3   0F                     RRCA      
C4A4   0F                     RRCA      
C4A5   0F                     RRCA      
C4A6   CD B0 C4               CALL   L_PRINT_HEX_DIGIT   
C4A9   E1                     POP   hl   
C4AA   7D                     LD   a,l   
C4AB   CD B0 C4               CALL   L_PRINT_HEX_DIGIT   
C4AE   F3                     DI      
C4AF   C9                     RET      
C4B0                L_PRINT_HEX_DIGIT:      
C4B0   E6 0F                  AND   $0F   
C4B2   FE 0A                  CP   $0A   
C4B4   38 02                  JR   c,L_HEX_LESS_THAN_TEN   
C4B6   C6 07                  ADD   a,"A"-"0"-10   
C4B8                L_HEX_LESS_THAN_TEN:      
C4B8   C6 30                  ADD   a,"0"   
C4BA   4F                     LD   c,a   
C4BB   F7                     RST   30h   
C4BC   21                     DB   $21   
C4BD   C9                     RET      
C4BE                             ; b;c => x,y character coordiaates, (0,0) is the upper left corner
C4BE                             ; d;e => w,h external height.
C4BE                DIALOG_XY:   EQU   $2000   
C4BE                DIALOG_Y:   EQU   $2000   
C4BE                DIALOG_X:   EQU   $2001   
C4BE                DIALOG_WH:   EQU   $2002   
C4BE                DIALOG_H:   EQU   $2002   
C4BE                DIALOG_W:   EQU   $2003   
C4BE                DIALOG_CUR_X:   EQU   $2004   
C4BE                DIALOG_CUR_Y:   EQU   $2005   
C4BE                DIALOG_BACKGROUND_COPY:   EQU   $2006   
C4BE                             ; h must not be bigger than 24
C4BE                             ; y+h must not be bigger than 25
C4BE                             ; x+w must not be bigger than 64
C4BE                F_SHOW_DIALOG_BOX:      
C4BE   F3                     DI      
C4BF   3E 10                  LD   a,$10   
C4C1   D3 02                  OUT   (2),a   
C4C3   ED 43 00 20            LD   (DIALOG_XY),bc   
C4C7   ED 53 02 20            LD   (DIALOG_WH),de   
C4CB   CD F3 C4               CALL   save_dialog_background   
C4CE   CD 0E C5               CALL   draw_dialog   
C4D1   3E 01                  LD   a,1   
C4D3   32 04 20               LD   (DIALOG_CUR_X),a   
C4D6   32 05 20               LD   (DIALOG_CUR_Y),a   
C4D9   3E 30                  LD   a,$30   
C4DB   D3 02                  OUT   (2),a   
C4DD   C9                     RET      
C4DE                F_CLOSE_DIALOG_BOX:      
C4DE   F3                     DI      
C4DF   3E 10                  LD   a,$10   
C4E1   D3 02                  OUT   (2),a   
C4E3   ED 4B 00 20            LD   bc,(DIALOG_XY)   
C4E7   ED 5B 02 20            LD   de,(DIALOG_WH)   
C4EB   CD FF C5               CALL   restore_dialog_background   
C4EE   3E 30                  LD   a,$30   
C4F0   D3 02                  OUT   (2),a   
C4F2   C9                     RET      
C4F3                SAVE_DIALOG_BACKGROUND:      
C4F3   CD 1A C6               CALL   SETUP_VARIABLES_FOR_COPY   
C4F6   E5                     PUSH   hl   
C4F7                L_SD_LOOP:      
C4F7   3A 03 20               LD   a,(DIALOG_W)   
C4FA   47                     LD   b,a   ; num of chars (bytes)
C4FB                L_SD_ONE_LINE_LOOP:      
C4FB   7E                     LD   a,(hl)   
C4FC   12                     LD   (de),a   
C4FD   23                     INC   hl   
C4FE   13                     INC   de   
C4FF   10 FA                  DJNZ   L_SD_ONE_LINE_LOOP   
C501   E1                     POP   hl   
C502   D5                     PUSH   de   
C503   11 40 00               LD   de,64   
C506   19                     ADD   hl,de   
C507   D1                     POP   de   
C508   E5                     PUSH   hl   
C509   0D                     DEC   c   
C50A   20 EB                  JR   nz,L_SD_LOOP   
C50C   E1                     POP   hl   
C50D   C9                     RET      
C50E                DRAW_DIALOG:      
C50E                             ; 
C50E                             ; top header line
C50E                             ; 
C50E   3A 00 20               LD   a,(DIALOG_Y)   
C511   4F                     LD   c,a   
C512   CD 25 C4               CALL   MULTIPLE_C_BY_640   
C515   11 40 81               LD   de,5*64+$8000   
C518   19                     ADD   hl,de   
C519   3A 01 20               LD   a,(DIALOG_X)   
C51C   5F                     LD   e,a   
C51D   16 00                  LD   d,0   
C51F   19                     ADD   hl,de   
C520   E5                     PUSH   hl   
C521   7E                     LD   a,(hl)   
C522   F6 0F                  OR   00001111b   
C524   77                     LD   (hl),a   
C525   3A 03 20               LD   a,(DIALOG_W)   
C528   D6 02                  SUB   2   
C52A   47                     LD   b,a   
C52B   23                     INC   hl   
C52C   3E FF                  LD   a,$ff   
C52E                L_TOP_LINE_LOOP:      
C52E   77                     LD   (hl),a   
C52F   23                     INC   hl   
C530   10 FC                  DJNZ   L_TOP_LINE_LOOP   
C532   7E                     LD   a,(hl)   
C533   F6 E0                  OR   11100000b   
C535   77                     LD   (hl),a   
C536                             ; 
C536                             ; first 4 lines, starting vertical bars. No shadors to the right
C536                             ; 
C536   0E 04                  LD   c,4   
C538   E1                     POP   hl   
C539   11 40 00               LD   de,64   
C53C   19                     ADD   hl,de   
C53D   E5                     PUSH   hl   
C53E                L_TOP_LINES_NO_SHADOW_LOOP:      
C53E   7E                     LD   a,(hl)   
C53F   E6 F0                  AND   11110000b   
C541   F6 08                  OR   00001000b   
C543   77                     LD   (hl),a   
C544   23                     INC   hl   
C545   3A 03 20               LD   a,(DIALOG_W)   
C548   D6 02                  SUB   2   
C54A   47                     LD   b,a   
C54B   AF                     XOR   a   
C54C                L_TOP_LINES_NO_SHADOW_LINE_LOOP:      
C54C   77                     LD   (hl),a   
C54D   23                     INC   hl   
C54E   10 FC                  DJNZ   L_TOP_LINES_NO_SHADOW_LINE_LOOP   
C550   7E                     LD   a,(hl)   
C551   E6 1F                  AND   00011111b   
C553   F6 20                  OR   00100000b   
C555   77                     LD   (hl),a   
C556   E1                     POP   hl   
C557   19                     ADD   hl,de   
C558   E5                     PUSH   hl   
C559   0D                     DEC   c   
C55A   20 E2                  JR   nz,L_TOP_LINES_NO_SHADOW_LOOP   
C55C                             ; 
C55C                             ; (height-2) * 10 lines, with shadows to the right
C55C                             ; 
C55C   3A 02 20               LD   a,(DIALOG_H)   
C55F   D6 02                  SUB   2   
C561   4F                     LD   c,a   
C562   CB 27                  SLA   a   ;8xA
C564   CB 27                  SLA   a   
C566   CB 27                  SLA   a   
C568   CB 21                  SLA   c   ;2xC
C56A   81                     ADD   a,c   ;A+C
C56B   4F                     LD   c,a   ; C = DIALOG_H*10
C56C                L_VERT_LINES_SHADOW_LOOP:      
C56C   3A 03 20               LD   a,(DIALOG_W)   
C56F   D6 02                  SUB   2   
C571   47                     LD   b,a   
C572   7E                     LD   a,(hl)   
C573   E6 F0                  AND   11110000b   
C575   F6 08                  OR   00001000b   
C577   77                     LD   (hl),a   
C578   23                     INC   hl   
C579   AF                     XOR   a   
C57A                L_VERT_LINES_SHADOW_LINE_LOOP:      
C57A   77                     LD   (hl),a   
C57B   23                     INC   hl   
C57C   10 FC                  DJNZ   L_VERT_LINES_SHADOW_LINE_LOOP   
C57E   7E                     LD   a,(hl)   
C57F   E6 0F                  AND   00001111b   
C581   51                     LD   d,c   
C582   CB 1A                  RR   d   
C584   38 04                  JR   c,ODD_PATTERN   
C586   F6 35                  OR   00110101b   
C588   18 02                  JR   SKIP_ODD_PATTERN   
C58A                ODD_PATTERN:      
C58A   F6 2A                  OR   00101010b   
C58C                SKIP_ODD_PATTERN:      
C58C   77                     LD   (hl),a   
C58D   E1                     POP   hl   
C58E   11 40 00               LD   de,64   
C591   19                     ADD   hl,de   
C592   E5                     PUSH   hl   
C593   0D                     DEC   c   
C594   20 D6                  JR   nz,L_VERT_LINES_SHADOW_LOOP   
C596                             ; 
C596                             ; last 5 lines (without closing line) with shadow
C596                             ; 
C596   0E 05                  LD   c,5   
C598                L_VERT_LAST_LINES_SHADOW_LOOP:      
C598   3A 03 20               LD   a,(DIALOG_W)   
C59B   D6 02                  SUB   2   
C59D   47                     LD   b,a   
C59E   7E                     LD   a,(hl)   
C59F   E6 F0                  AND   11110000b   
C5A1   F6 08                  OR   00001000b   
C5A3   77                     LD   (hl),a   
C5A4   23                     INC   hl   
C5A5   AF                     XOR   a   
C5A6                L_VERT_LAST_LINES_SHADOW_LINE_LOOP:      
C5A6   77                     LD   (hl),a   
C5A7   23                     INC   hl   
C5A8   10 FC                  DJNZ   L_VERT_LAST_LINES_SHADOW_LINE_LOOP   
C5AA   7E                     LD   a,(hl)   
C5AB   E6 0F                  AND   00001111b   
C5AD   51                     LD   d,c   
C5AE   CB 1A                  RR   d   
C5B0   38 04                  JR   c,ODD_PATTERN_LAST4   
C5B2   F6 2A                  OR   00101010b   
C5B4   18 02                  JR   SKIP_ODD_PATTERN_LAST4   
C5B6                ODD_PATTERN_LAST4:      
C5B6   F6 35                  OR   00110101b   
C5B8                SKIP_ODD_PATTERN_LAST4:      
C5B8   77                     LD   (hl),a   
C5B9   E1                     POP   hl   
C5BA   11 40 00               LD   de,64   
C5BD   19                     ADD   hl,de   
C5BE   E5                     PUSH   hl   
C5BF   0D                     DEC   c   
C5C0   20 D6                  JR   nz,L_VERT_LAST_LINES_SHADOW_LOOP   
C5C2                             ; 
C5C2                             ; last - closing - line
C5C2                             ; 
C5C2   3A 03 20               LD   a,(DIALOG_W)   
C5C5   D6 02                  SUB   2   
C5C7   47                     LD   b,a   
C5C8   7E                     LD   a,(hl)   
C5C9   E6 F0                  AND   11110000b   
C5CB   F6 0F                  OR   00001111b   
C5CD   77                     LD   (hl),a   
C5CE   23                     INC   hl   
C5CF   3E FF                  LD   a,$ff   
C5D1                L_LAST_LINE_LOOP:      
C5D1   77                     LD   (hl),a   
C5D2   23                     INC   hl   
C5D3   10 FC                  DJNZ   L_LAST_LINE_LOOP   
C5D5   7E                     LD   a,(hl)   
C5D6   E6 0F                  AND   00001111b   
C5D8   F6 FA                  OR   11111010b   
C5DA   77                     LD   (hl),a   
C5DB   E1                     POP   hl   
C5DC   11 40 00               LD   de,64   
C5DF   19                     ADD   hl,de   
C5E0   E5                     PUSH   hl   
C5E1                             ; 
C5E1                             ; last 4 shadowed lines
C5E1   0E 04                  LD   c,4   
C5E3   1E 55                  LD   e,01010101b   
C5E5                L_LAST_LINES_SHADOW_LOOP:      
C5E5   23                     INC   hl   
C5E6   3A 03 20               LD   a,(DIALOG_W)   
C5E9   47                     LD   b,a   
C5EA   05                     DEC   b   
C5EB                L_LAST_LINES_SHADOW_LINE_LOOP:      
C5EB   7E                     LD   a,(hl)   
C5EC   B3                     OR   e   
C5ED   77                     LD   (hl),a   
C5EE   23                     INC   hl   
C5EF   10 FA                  DJNZ   L_LAST_LINES_SHADOW_LINE_LOOP   
C5F1   7B                     LD   a,e   
C5F2   2F                     CPL      
C5F3   E1                     POP   hl   
C5F4   11 40 00               LD   de,64   
C5F7   19                     ADD   hl,de   
C5F8   E5                     PUSH   hl   
C5F9   5F                     LD   e,a   
C5FA   0D                     DEC   c   
C5FB   20 E8                  JR   nz,L_LAST_LINES_SHADOW_LOOP   
C5FD   E1                     POP   hl   
C5FE   C9                     RET      
C5FF                RESTORE_DIALOG_BACKGROUND:      
C5FF   CD 1A C6               CALL   SETUP_VARIABLES_FOR_COPY   
C602   E5                     PUSH   hl   
C603                L_RD_LOOP:      
C603   3A 03 20               LD   a,(DIALOG_W)   
C606   47                     LD   b,a   ; num of chars (bytes)
C607                L_RD_ONE_LINE_LOOP:      
C607   1A                     LD   a,(de)   
C608   77                     LD   (hl),a   
C609   23                     INC   hl   
C60A   13                     INC   de   
C60B   10 FA                  DJNZ   L_RD_ONE_LINE_LOOP   
C60D   E1                     POP   hl   
C60E   D5                     PUSH   de   
C60F   11 40 00               LD   de,64   
C612   19                     ADD   hl,de   
C613   D1                     POP   de   
C614   E5                     PUSH   hl   
C615   0D                     DEC   c   
C616   20 EB                  JR   nz,L_RD_LOOP   
C618   E1                     POP   hl   
C619   C9                     RET      
C61A                SETUP_VARIABLES_FOR_COPY:      
C61A   CD 25 C4               CALL   MULTIPLE_C_BY_640   
C61D   3A 01 20               LD   a,(DIALOG_X)   
C620   4F                     LD   c,a   
C621   06 00                  LD   b,0   
C623   09                     ADD   hl,bc   
C624   11 00 80               LD   de,$8000   
C627   19                     ADD   hl,de   ; start pos in video memory
C628   3A 02 20               LD   a,(DIALOG_H)   
C62B   47                     LD   b,a   
C62C   CB 27                  SLA   a   ; mul by 8
C62E   CB 27                  SLA   a   
C630   CB 27                  SLA   a   
C632   CB 20                  SLA   b   ; mul by 2
C634   80                     ADD   a,b   
C635   4F                     LD   c,a   ; num of lines
C636   3A 03 20               LD   a,(DIALOG_W)   
C639   47                     LD   b,a   ; num of chars (bytes)
C63A   11 06 20               LD   de,DIALOG_BACKGROUND_COPY   ; backup target of video memory
C63D   C9                     RET      
C63E                F_PRINT_DELETE_QUESTION:      
C63E   3A 01 20               LD   a,(DIALOG_X)   
C641   C6 02                  ADD   a,2   
C643   47                     LD   b,a   
C644   3A 00 20               LD   a,(DIALOG_Y)   
C647   C6 02                  ADD   a,2   
C649   4F                     LD   c,a   
C64A   F7                     RST   30h   
C64B   23                     DB   $23   
C64C   11 67 3C               LD   de,STR_DELETE_QUESTION   ; VID_BKOUT
C64F   01 1F 00               LD   bc,STR_DELETE_QUESTION_END-STR_DELETE_QUESTION   
C652   F7                     RST   30h   
C653   22                     DB   $22   
C654   3A 85 08               LD   a,(LIST_SELECTED_ELEMENT)   
C657   47                     LD   b,a   
C658   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
C65B   80                     ADD   a,b   
C65C   26 00                  LD   h,0   ; multiply A by 4 => HL
C65E   CB 27                  SLA   a   
C660   CB 14                  RL   h   
C662   CB 27                  SLA   a   
C664   CB 14                  RL   h   
C666   6F                     LD   l,a   
C667   11 00 4C               LD   de,CART_NAME_STRUCT   
C66A   19                     ADD   hl,de   
C66B   23                     INC   hl   
C66C   5E                     LD   e,(hl)   
C66D   23                     INC   hl   
C66E   56                     LD   d,(hl)   
C66F   EB                     EX   de,hl   
C670   11 04 00               LD   de,0004   
C673   19                     ADD   hl,de   
C674   01 10 00               LD   bc,16   
C677   11 00 4B               LD   de,STR_TEMP_AREA   
C67A   ED B0                  LDIR      
C67C   21 00 4B               LD   hl,STR_TEMP_AREA   
C67F   06 10                  LD   b,16   
C681   CD BE C6               CALL   str_rtrim   
C684   48                     LD   c,b   
C685   06 00                  LD   b,0   
C687   C5                     PUSH   bc   
C688   CB 39                  SRL   c   
C68A   3A 03 20               LD   a,(DIALOG_W)   
C68D   CB 3F                  SRL   a   
C68F   91                     SUB   c   
C690   4F                     LD   c,a   
C691   3A 01 20               LD   a,(DIALOG_X)   
C694   C6 02                  ADD   a,2   
C696   81                     ADD   a,c   
C697   47                     LD   b,a   
C698   05                     DEC   b   
C699   3A 00 20               LD   a,(DIALOG_Y)   
C69C   C6 04                  ADD   a,4   
C69E   4F                     LD   c,a   
C69F   F7                     RST   30h   
C6A0   23                     DB   $23   
C6A1   C1                     POP   bc   
C6A2   11 00 4B               LD   de,STR_TEMP_AREA   
C6A5   F7                     RST   30h   
C6A6   22                     DB   $22   
C6A7   3A 01 20               LD   a,(DIALOG_X)   
C6AA   C6 10                  ADD   a,2+14   
C6AC   47                     LD   b,a   
C6AD   3A 00 20               LD   a,(DIALOG_Y)   
C6B0   C6 07                  ADD   a,7   
C6B2   4F                     LD   c,a   
C6B3   F7                     RST   30h   
C6B4   23                     DB   $23   
C6B5   11 86 3C               LD   de,STR_DELETE_ANSWER   
C6B8   01 03 00               LD   bc,STR_DELETE_ANSWER_END-STR_DELETE_ANSWER   
C6BB   F7                     RST   30h   
C6BC   22                     DB   $22   
C6BD   C9                     RET      
C6BE                STR_RTRIM:      
C6BE   58                     LD   e,b   
C6BF   16 00                  LD   d,0   
C6C1   E5                     PUSH   hl   
C6C2   3E 20                  LD   a,$20   
C6C4                L_SRT_LOOP:      
C6C4   E1                     POP   hl   
C6C5   1D                     DEC   e   
C6C6   FA D2 C6               JP   m,L_SRT_EMPTY_STR   
C6C9   E5                     PUSH   hl   
C6CA   19                     ADD   hl,de   
C6CB   BE                     CP   (hl)   
C6CC   28 F6                  JR   z,L_SRT_LOOP   
C6CE   E1                     POP   hl   
C6CF   43                     LD   b,e   
C6D0   04                     INC   b   
C6D1   C9                     RET      
C6D2                L_SRT_EMPTY_STR:      
C6D2   06 00                  LD   b,0   
C6D4   C9                     RET      
C6D5                F_CLEAR_BOX:      
C6D5   F3                     DI      
C6D6   3E 10                  LD   a,$10   
C6D8   D3 02                  OUT   (2),a   
C6DA   3A 00 20               LD   a,(DIALOG_Y)   
C6DD   4F                     LD   c,a   
C6DE   CD 1A C6               CALL   SETUP_VARIABLES_FOR_COPY   
C6E1   11 81 02               LD   de,641   ; x and y adjustment for inner area
C6E4   19                     ADD   hl,de   
C6E5   79                     LD   a,c   
C6E6   D6 14                  SUB   20   
C6E8   4F                     LD   c,a   
C6E9   E5                     PUSH   hl   
C6EA                L_CLEAR_DB_LOOP:      
C6EA   3A 03 20               LD   a,(DIALOG_W)   
C6ED   D6 02                  SUB   2   
C6EF   47                     LD   b,a   ; num of chars (bytes)
C6F0   AF                     XOR   a   
C6F1                L_CLEAR_DB_ONE_LINE_LOOP:      
C6F1   77                     LD   (hl),a   
C6F2   23                     INC   hl   
C6F3   10 FC                  DJNZ   L_CLEAR_DB_ONE_LINE_LOOP   
C6F5   E1                     POP   hl   
C6F6   11 40 00               LD   de,64   
C6F9   19                     ADD   hl,de   
C6FA   E5                     PUSH   hl   
C6FB   0D                     DEC   c   
C6FC   20 EC                  JR   nz,L_CLEAR_DB_LOOP   
C6FE   E1                     POP   hl   
C6FF   3E 30                  LD   a,$30   
C701   D3 02                  OUT   (2),a   
C703   C9                     RET      
C704                             ; DE: String pointer
C704                             ; BC: Length of string
C704                             ; A: 0:Print in next line, left indentation
C704                             ;    1:Print in next line, right indentation
C704                             ;    2:Print in same line, continue
C704                             ;    3:Print in next line, center indentation
C704                F_PRINT_ONE_LINE_IN_DIALOG:      
C704   C5                     PUSH   bc   
C705   D5                     PUSH   de   
C706   FE 00                  CP   0   
C708   28 0C                  JR   z,L_DB_PRINT_NEXT_LINE_LEFT   
C70A   FE 01                  CP   1   
C70C   28 1F                  JR   z,L_DB_PRINT_NEXT_LINE_RIGHT   
C70E   FE 02                  CP   2   
C710   28 55                  JR   z,L_DB_PRINT_AFTER   
C712   FE 03                  CP   3   
C714   28 32                  JR   z,L_DB_PRINT_NEXT_LINE_CENTER   
C716                L_DB_PRINT_NEXT_LINE_LEFT:      
C716   3E 01                  LD   a,1   
C718   32 04 20               LD   (DIALOG_CUR_X),a   
C71B   3A 00 20               LD   a,(DIALOG_Y)   
C71E   47                     LD   b,a   
C71F   3A 05 20               LD   a,(DIALOG_CUR_Y)   
C722   80                     ADD   a,b   
C723   3C                     INC   a   
C724   4F                     LD   c,a   
C725   3A 01 20               LD   a,(DIALOG_X)   
C728   C6 02                  ADD   a,2   
C72A   47                     LD   b,a   
C72B   18 55                  JR   L_DB_PRINT   
C72D                L_DB_PRINT_NEXT_LINE_RIGHT:      
C72D   3A 03 20               LD   a,(DIALOG_W)   
C730   91                     SUB   c   
C731   4F                     LD   c,a   
C732   3A 01 20               LD   a,(DIALOG_X)   
C735   81                     ADD   a,c   
C736   47                     LD   b,a   
C737   3E 01                  LD   a,1   
C739   32 04 20               LD   (DIALOG_CUR_X),a   
C73C   3A 00 20               LD   a,(DIALOG_Y)   
C73F   4F                     LD   c,a   
C740   3A 05 20               LD   a,(DIALOG_CUR_Y)   
C743   81                     ADD   a,c   
C744   3C                     INC   a   
C745   4F                     LD   c,a   
C746   18 3A                  JR   L_DB_PRINT   
C748                L_DB_PRINT_NEXT_LINE_CENTER:      
C748   3E 01                  LD   a,1   
C74A   32 04 20               LD   (DIALOG_CUR_X),a   
C74D   3A 03 20               LD   a,(DIALOG_W)   
C750   91                     SUB   c   ; length of string
C751   CB 3F                  SRL   a   
C753   47                     LD   b,a   
C754   3A 01 20               LD   a,(DIALOG_X)   
C757   80                     ADD   a,b   
C758   C6 01                  ADD   a,1   
C75A   47                     LD   b,a   
C75B   3A 00 20               LD   a,(DIALOG_Y)   
C75E   4F                     LD   c,a   
C75F   3A 05 20               LD   a,(DIALOG_CUR_Y)   
C762   81                     ADD   a,c   
C763   3C                     INC   a   
C764   4F                     LD   c,a   
C765   18 1B                  JR   L_DB_PRINT   
C767                L_DB_PRINT_AFTER:      
C767   21 05 20               LD   hl,DIALOG_CUR_Y   
C76A   35                     DEC   (hl)   
C76B   3A 00 20               LD   a,(DIALOG_Y)   
C76E   47                     LD   b,a   
C76F   3A 05 20               LD   a,(DIALOG_CUR_Y)   
C772   80                     ADD   a,b   
C773   3C                     INC   a   
C774   4F                     LD   c,a   
C775   3A 01 20               LD   a,(DIALOG_X)   
C778   47                     LD   b,a   
C779   3A 04 20               LD   a,(DIALOG_CUR_X)   
C77C   80                     ADD   a,b   
C77D   C6 01                  ADD   a,1   
C77F   47                     LD   b,a   
C780   18 00                  JR   L_DB_PRINT   
C782                L_DB_PRINT:      
C782   F7                     RST   30h   
C783   23                     DB   $23   
C784   D1                     POP   de   
C785   C1                     POP   bc   
C786   3A 04 20               LD   a,(DIALOG_CUR_X)   
C789   81                     ADD   a,c   
C78A   32 04 20               LD   (DIALOG_CUR_X),a   
C78D   F7                     RST   30h   
C78E   22                     DB   $22   
C78F   F3                     DI      
C790   21 05 20               LD   hl,DIALOG_CUR_Y   
C793   34                     INC   (hl)   
C794   C9                     RET      
C795                PRINT_PRESS_SPACE:      
C795   3A 02 20               LD   a,(DIALOG_H)   
C798   D6 02                  SUB   2   
C79A   32 05 20               LD   (DIALOG_CUR_Y),a   
C79D   11 1D 3D               LD   de,STR_FLASH_PRESS_SPACE   
C7A0   01 1E 00               LD   bc,STR_FLASH_PRESS_SPACE_END-STR_FLASH_PRESS_SPACE   
C7A3   3E 01                  LD   a,1   
C7A5   CD 04 C7               CALL   F_PRINT_ONE_LINE_IN_DIALOG   
C7A8   C9                     RET      
C7A9                KEY_UP:   EQU   1   
C7A9                KEY_DN:   EQU   2   
C7A9                KEY_PG_UP:   EQU   3   
C7A9                KEY_PG_DN:   EQU   4   
C7A9                KEY_TGL_RST:   EQU   5   
C7A9                KEY_RETURN:   EQU   6   
C7A9                KEY_DEL:   EQU   7   
C7A9                KEY_N:    EQU   8   
C7A9                KEY_T:    EQU   9   
C7A9                KEY_S:    EQU   10   
C7A9                KEY_R:    EQU   11   
C7A9                KEY_O:    EQU   12   
C7A9                KEY_M:    EQU   13   
C7A9                F_HANDLE_INPUT:      
C7A9   CD C2 CA               CALL   F_KEYBOARD_SCAN   
C7AC   AF                     XOR   a   
C7AD   B9                     CP   c   
C7AE   20 05                  JR   nz,KEY_PRESSED   
C7B0   32 82 08               LD   (KEYBOARD_LAST_KEY),a   
C7B3   18 F4                  JR   F_HANDLE_INPUT   
C7B5                KEY_PRESSED:      
C7B5   21 82 08               LD   hl,KEYBOARD_LAST_KEY   
C7B8   7E                     LD   a,(hl)   
C7B9   B9                     CP   c   
C7BA   28 09                  JR   z,INPUT_OLD_KEY   
C7BC   71                     LD   (hl),c   
C7BD   21 00 01               LD   hl,CYCLE_COUNT1   
C7C0   22 80 08               LD   (KEYBOARD_COUNTER),HL   
C7C3   18 13                  JR   keyboard_process   
C7C5                INPUT_OLD_KEY:      
C7C5   ED 5B 80 08            LD   de,(KEYBOARD_COUNTER)   
C7C9   1B                     DEC   de   
C7CA   ED 53 80 08            LD   (KEYBOARD_COUNTER),de   
C7CE   7A                     LD   a,d   
C7CF   B3                     OR   e   
C7D0   20 D7                  JR   nz,F_HANDLE_INPUT   
C7D2   21 80 00               LD   hl,CYCLE_COUNT2   
C7D5   22 80 08               LD   (KEYBOARD_COUNTER),hl   
C7D8                KEYBOARD_PROCESS:      
C7D8   3E 01                  LD   a,KEY_UP   
C7DA   B9                     CP   c   
C7DB   CA 29 C8               JP   z,KEYPRESS_KEYUP   
C7DE   3E 02                  LD   a,KEY_DN   
C7E0   B9                     CP   c   
C7E1   CA 42 C8               JP   z,KEYPRESS_KEYDOWN   
C7E4   3E 03                  LD   a,KEY_PG_UP   
C7E6   B9                     CP   c   
C7E7   CA 5D C8               JP   z,KEYPRESS_KEYPGUP   
C7EA   3E 04                  LD   a,KEY_PG_DN   
C7EC   B9                     CP   c   
C7ED   CA 76 C8               JP   z,KEYPRESS_KEYPGDOWN   
C7F0   3E 05                  LD   a,KEY_TGL_RST   
C7F2   B9                     CP   c   
C7F3   CA A5 C8               JP   z,KEYPRESS_SPACE   
C7F6   3E 06                  LD   a,KEY_RETURN   
C7F8   B9                     CP   c   
C7F9   CA AE C8               JP   z,KEYPRESS_RETURN   
C7FC   3E 07                  LD   a,KEY_DEL   
C7FE   B9                     CP   c   
C7FF   CA 16 CA               JP   z,KEYPRESS_DEL   
C802   3E 0C                  LD   a,KEY_O   
C804   B9                     CP   c   
C805   CA 89 CA               JP   z,KEYPRESS_RESET_SORT   
C808   3E 08                  LD   a,KEY_N   
C80A   B9                     CP   c   
C80B   CA 84 CA               JP   z,KEYPRESS_SORT_NAME   
C80E   3E 0A                  LD   a,KEY_S   
C810   B9                     CP   c   
C811   CA 7A CA               JP   z,KEYPRESS_SORT_SIZE   
C814   3E 09                  LD   a,KEY_T   
C816   B9                     CP   c   
C817   CA 7F CA               JP   z,KEYPRESS_SORT_TYPE   
C81A   3E 0B                  LD   a,KEY_R   
C81C   B9                     CP   c   
C81D   CA 93 CA               JP   z,KEYPRESS_RENAME   
C820   3E 0D                  LD   a,KEY_M   
C822   B9                     CP   c   
C823   CA A8 CA               JP   z,KEYPRESS_RAM_TEST   
C826   C3 B4 CA               JP   KEY_NOT_FOUND   
C829                KEYPRESS_KEYUP:      
C829   21 85 08               LD   hl,LIST_SELECTED_ELEMENT   
C82C   7E                     LD   a,(hl)   
C82D   06 00                  LD   b,0   
C82F   B8                     CP   b   
C830   28 03                  JR   z,AT_TOP   
C832   35                     DEC   (hl)   
C833   48                     LD   c,b   
C834   C9                     RET      
C835                AT_TOP:      
C835   21 83 08               LD   hl,LIST_FIRST_ELEMENT   
C838   7E                     LD   a,(hl)   
C839   06 00                  LD   b,0   
C83B   B8                     CP   b   
C83C   CA A9 C7               JP   z,F_HANDLE_INPUT   
C83F   35                     DEC   (hl)   
C840   48                     LD   c,b   
C841   C9                     RET      
C842                KEYPRESS_KEYDOWN:      
C842   01 86 08               LD   bc,NUM_OF_IMAGES   ;keydown
C845   0A                     LD   a,(bc)   
C846   21 83 08               LD   hl,LIST_FIRST_ELEMENT   
C849   96                     SUB   (hl)   
C84A   21 85 08               LD   hl,LIST_SELECTED_ELEMENT   
C84D   BE                     CP   (hl)   
C84E   CA A9 C7               JP   z,F_HANDLE_INPUT   
C851   3E 0F                  LD   a,N_HEIGHT-1   
C853   BE                     CP   (hl)   
C854   28 02                  JR   z,AT_LAST_LINE   
C856   34                     INC   (hl)   
C857   C9                     RET      
C858                AT_LAST_LINE:      
C858   21 83 08               LD   hl,LIST_FIRST_ELEMENT   
C85B   34                     INC   (hl)   
C85C   C9                     RET      
C85D                KEYPRESS_KEYPGUP:      ; page up
C85D   21 83 08               LD   hl,LIST_FIRST_ELEMENT   
C860   7E                     LD   a,(hl)   
C861   06 10                  LD   b,N_HEIGHT   
C863   90                     SUB   b   
C864   FA 69 C8               JP   m,PG_UP_TOP_PAGE   
C867   77                     LD   (hl),a   
C868   C9                     RET      
C869                PG_UP_TOP_PAGE:      
C869   7E                     LD   a,(hl)   
C86A   FE 00                  CP   0   
C86C   28 03                  JR   z,PG_UP_FIRST_LINE   
C86E   AF                     XOR   a   
C86F   77                     LD   (hl),a   
C870   C9                     RET      
C871                PG_UP_FIRST_LINE:      
C871   21 85 08               LD   hl,LIST_SELECTED_ELEMENT   
C874   77                     LD   (hl),a   ; A is zero because of prev condition
C875   C9                     RET      
C876                             ; 
C876                KEYPRESS_KEYPGDOWN:      ; Page down
C876   01 83 08               LD   bc,LIST_FIRST_ELEMENT   
C879   21 86 08               LD   hl,NUM_OF_IMAGES   
C87C   0A                     LD   a,(bc)   
C87D   C6 10                  ADD   a,N_HEIGHT   
C87F   C6 10                  ADD   a,N_HEIGHT   
C881   57                     LD   d,a   
C882   7E                     LD   a,(hl)   
C883                             ; D contains the possible next page's last position + 1
C883                             ; A contains the number of images (last index + 1)
C883   92                     SUB   d   ; let's check if there is enough elements in directory
C884   FA 8C C8               JP   m,END_REACHED1   
C887   0A                     LD   a,(bc)   ; YES, there is
C888   C6 10                  ADD   a,N_HEIGHT   
C88A   02                     LD   (bc),a   
C88B   C9                     RET      
C88C                END_REACHED1:      
C88C   0A                     LD   a,(bc)   
C88D   C6 10                  ADD   a,N_HEIGHT   
C88F   57                     LD   d,a   
C890   7E                     LD   a,(hl)   
C891   92                     SUB   d   
C892   FA 9C C8               JP   m,END_REACHED2   
C895   57                     LD   d,a   
C896   0A                     LD   a,(bc)   
C897   82                     ADD   a,d   
C898   C6 01                  ADD   a,$01   
C89A   02                     LD   (bc),a   
C89B   C9                     RET      
C89C                END_REACHED2:      
C89C   0A                     LD   a,(bc)   
C89D   57                     LD   d,a   
C89E   7E                     LD   a,(hl)   
C89F   92                     SUB   d   
C8A0   01 85 08               LD   bc,LIST_SELECTED_ELEMENT   
C8A3   02                     LD   (bc),a   
C8A4   C9                     RET      
C8A5                KEYPRESS_SPACE:      ; SPACE - toggle reset enabled
C8A5   21 8B 08               LD   hl,RESET_ENABLED   
C8A8   46                     LD   b,(hl)   
C8A9   3E 02                  LD   a,2   
C8AB   90                     SUB   b   
C8AC   77                     LD   (hl),a   
C8AD   C9                     RET      
C8AE                KEYPRESS_RETURN:      ; RETURN - boot selected item (EXIT to Basic, CART or CAS)
C8AE   FB                     EI      
C8AF   01 00 02               LD   bc,$0200   ; at least one IT to scan keyboard
C8B2                L_DELAY_LOOP:      
C8B2   0B                     DEC   bc   ; 6
C8B3   00                     NOP      ; 4
C8B4   3E 00                  LD   a,$00   ; 7
C8B6   B8                     CP   b   ; 4
C8B7   20 F9                  JR   nz,L_DELAY_LOOP   ; 12   SUM = 33
C8B9   F7                     RST   30h   
C8BA   93                     DB   $93   
C8BB   AF                     XOR   a   
C8BC   B9                     CP   c   
C8BD   28 02                  JR   z,L_KEYBOARD_READ   
C8BF   F7                     RST   30h   
C8C0   91                     DB   $91   
C8C1                L_KEYBOARD_READ:      
C8C1   F3                     DI      
C8C2   AF                     XOR   a   
C8C3   32 21 0B               LD   (WARM_FLAG),a   ; force cold reset
C8C6   11 83 08               LD   de,LIST_FIRST_ELEMENT   
C8C9   1A                     LD   a,(de)   
C8CA   21 85 08               LD   hl,LIST_SELECTED_ELEMENT   
C8CD   86                     ADD   a,(hl)   
C8CE   16 00                  LD   d,0   
C8D0   CB 27                  SLA   a   
C8D2   CB 12                  RL   d   
C8D4   CB 27                  SLA   a   
C8D6   CB 12                  RL   d   
C8D8   62                     LD   h,d   
C8D9   6F                     LD   l,a   
C8DA   01 00 4C               LD   bc,CART_NAME_STRUCT   
C8DD   09                     ADD   hl,bc   
C8DE   3E 05                  LD   a,TYPE_DAT   
C8E0   BE                     CP   (hl)   
C8E1   CA A9 C7               JP   z,F_HANDLE_INPUT   
C8E4   31 AC 16               LD   SP,$16AC   
C8E7   E5                     PUSH   hl   
C8E8                             ; 
C8E8                             ; video mode set to 4 colors, 32 columns
C8E8   0E 01                  LD   c,1   
C8EA   F7                     RST   30h   
C8EB   04                     DB   $04   
C8EC   F3                     DI      
C8ED   E1                     POP   hl   
C8EE   3E 01                  LD   a,TYPE_EXIT_TO_BASIC   
C8F0   BE                     CP   (hl)   
C8F1   C2 9D C9               JP   nz,CHECK_CART_EXEC   
C8F4                L_EXIT_TO_BASIC:      
C8F4                             ; Exit to BASIC
C8F4   01 97 00               LD   bc,JUMP_TO_BASIC_FROM_U1_END - JUMP_TO_BASIC_FROM_U1   
C8F7   21 06 C9               LD   hl,JUMP_TO_BASIC_FROM_U1   
C8FA   11 DE 08               LD   de,EXT0_BASE_END   
C8FD   ED B0                  LDIR      
C8FF   AF                     XOR   a   ; let's make TVC think it was a COLD reset
C900   32 21 0B               LD   ($0B21),a   
C903   C3 DE 08               JP   EXT0_BASE_END   
C906                EBE:      EQU   EXT0_BASE_END   
C906                JUMP_TO_BASIC_FROM_U1:      
C906                          .PHASE   ebe   
08DE @C906   3E 70            LD   a,$70   
08E0 @C908   D3 02            OUT   (2),a   
08E2 @C90A   32 03 00         LD   (3),a   
08E5 @C90D   21 32 C3         LD   hl,$C332   
08E8 @C910   7E               LD   a,(hl)   
08E9 @C911   FE C2            CP   $C2   
08EB @C913   28 34            JR   z,TVC22   
08ED @C915          TVC12:       
08ED @C915   21 00 17         LD   hl,$1700   
08F0 @C918   E5               PUSH   hl   
08F1 @C919   DD E1            POP   ix   
08F3 @C91B   AF               XOR   a   
08F4 @C91C   01 EF 02         LD   bc,$02ef   
08F7 @C91F          L_TVC12_FILL_STACK_LOOP:      
08F7 @C91F   77               LD   (hl),a   
08F8 @C920   ED A1            CPI      
08FA @C922   EA F7 08         JP   pe,L_TVC12_FILL_STACK_LOOP   
08FD @C925   22 20 17         LD   ($1720),hl   
0900 @C928   22 22 17         LD   ($1722),hl   
0903 @C92B   21 5B FB         LD   hl,$FB5B   
0906 @C92E   11 08 00         LD   de,$0008   
0909 @C931   01 27 00         LD   bc,$0027   
090C @C934   ED B0            LDIR      
090E @C936   3E 30            LD   a,$30   
0910 @C938   D3 02            OUT   (2),a   
0912 @C93A   CD A7 CC         CALL   CONFIGURE_EXT0   
0915 @C93D   3E 70            LD   a,$70   
0917 @C93F   D3 02            OUT   (2),a   
0919 @C941   21 19 DA         LD   hl,$DA19   
091C @C944   E5               PUSH   hl   ; (continue from DA19)
091D @C945   FB               EI      
091E @C946   C3 10 DE         JP   $DE10   
0921 @C949          TVC22:       
0921 @C949   21 B6 0E         LD   hl,BASIC_FLAG   
0924 @C94C   7E               LD   a,(hl)   
0925 @C94D   08               EX   af,af'   
0926 @C94E   36 00            LD   (hl),$00   
0928 @C950   21 AC 16         LD   hl,$16AC   
092B @C953   0E 01            LD   c,$01   
092D @C955          L_TVC22_LOOP_OUT:      
092D @C955   06 09            LD   b,$09   
092F @C957   79               LD   a,c   
0930 @C958          L_TVC22_LOOP_IN:      
0930 @C958   77               LD   (hl),a   
0931 @C959   81               ADD   a,c   
0932 @C95A   27               DAA      
0933 @C95B   23               INC   hl   
0934 @C95C   10 FA            DJNZ   L_TVC22_LOOP_IN   
0936 @C95E   0C               INC   c   
0937 @C95F   FE 90            CP   $90   
0939 @C961   20 F2            JR   nz,L_TVC22_LOOP_OUT   
093B @C963   21 00 17         LD   hl,$1700   
093E @C966   E5               PUSH   hl   
093F @C967   DD E1            POP   ix   
0941 @C969                       ; Skip warm reset test, continue with cold reset
0941 @C969   01 EF 02         LD   bc,$02ef   
0944 @C96C   AF               XOR   a   
0945 @C96D          L_TVC22_FILL_STACK_LOOP:      
0945 @C96D   77               LD   (hl),a   
0946 @C96E   ED A1            CPI      
0948 @C970   EA 45 09         JP   pe,L_TVC22_FILL_STACK_LOOP   
094B @C973   22 20 17         LD   ($1720),hl   
094E @C976   22 22 17         LD   ($1722),hl   
0951 @C979   08               EX   af,af'   
0952 @C97A   CB 57            BIT   2,a   
0954 @C97C   20 01            JR   nz,L_SKIP_NEW   
0956 @C97E   77               LD   (hl),a   ; NEW (A is 0)
0957 @C97F          L_SKIP_NEW:      
0957 @C97F   08               EX   af,af'   
0958 @C980   CD 89 D2         CALL   $d289   
095B @C983   21 B4 F7         LD   hl,$f7B4   
095E @C986   11 08 00         LD   de,$0008   
0961 @C989   01 27 00         LD   bc,$0027   
0964 @C98C   ED B0            LDIR      
0966 @C98E   3E 30            LD   a,$30   
0968 @C990   D3 02            OUT   (2),a   
096A @C992   CD A7 CC         CALL   CONFIGURE_EXT0   
096D @C995   3E 70            LD   a,$70   
096F @C997   D3 02            OUT   (2),a   
0971 @C999   FB               EI      
0972 @C99A   C3 0C CF         JP   $CF0C   
0975 @C99D                    .DEPHASE      
C99D                JUMP_TO_BASIC_FROM_U1_END:      
C99D                CHECK_CART_EXEC:      
C99D   3E 02                  LD   a,TYPE_CART   
C99F   BE                     CP   (hl)   
C9A0   20 29                  JR   nz,EXEC_CAS   
C9A2                             ; Executing the selected Cartridge
C9A2   23                     INC   hl   
C9A3   5E                     LD   e,(hl)   
C9A4   23                     INC   hl   
C9A5   56                     LD   d,(hl)   
C9A6   EB                     EX   de,hl   
C9A7   23                     INC   hl   
C9A8   E5                     PUSH   hl   
C9A9   01 14 00               LD   bc,JUMP_TO_CART_FROM_U1_END - JUMP_TO_CART_FROM_U1   
C9AC   21 B7 C9               LD   hl,JUMP_TO_CART_FROM_U1   
C9AF   11 00 40               LD   de,$4000   
C9B2   ED B0                  LDIR      
C9B4   C3 00 40               JP   $4000   
C9B7                JUMP_TO_CART_FROM_U1:      
C9B7   21 00 C0               LD   HL,REGISTER   
C9BA   3A 8B 08               LD   a,(RESET_ENABLED)   
C9BD   4F                     LD   c,a   
C9BE   06 00                  LD   b,0   
C9C0   09                     ADD   hl,bc   
C9C1   C1                     POP   bc   
C9C2   0A                     LD   a,(bc)   
C9C3   77                     LD   (hl),a   
C9C4   3E 20                  LD   a,$20   
C9C6   D3 02                  OUT   (2),a   
C9C8   C3 04 C0               JP   $C004   
C9CB                JUMP_TO_CART_FROM_U1_END:      
C9CB                EXEC_CAS:      
C9CB   7E                     LD   a,(hl)   
C9CC   FE 04                  CP   TYPE_BIN   
C9CE   28 33                  JR   z,LOAD_BIN   
C9D0   23                     INC   hl   
C9D1   5E                     LD   e,(hl)   
C9D2   23                     INC   hl   
C9D3   56                     LD   d,(hl)   
C9D4   EB                     EX   de,hl   
C9D5   E5                     PUSH   hl   ; HL: position of CAS in struct array
C9D6   CD B5 CB               CALL   F_COPY_BASIC_INIT   
C9D9   CD AD 08               CALL   F_BASIC_INIT   
C9DC   E1                     POP   hl   
C9DD   CD 1C 09               CALL   F_COPY_CAS_FROM_CART_INU0   
C9E0                             ; Set BASIC area
C9E0   21 EF 19               LD   hl,BASIC_PROGRAM_START   
C9E3   22 20 17               LD   (1720h),hl   
C9E6   22 22 17               LD   (1722h),hl   
C9E9   3A E4 08               LD   a,(BASIC_VERSION)   
C9EC   FE 02                  CP   2   
C9EE   C4 A7 CC               CALL   nz,CONFIGURE_EXT0   ; needed for v1.2
C9F1   C2 E5 08               JP   nz,MEMORY_PAGING   ; in multicart_v2.1_BASIC.z80
C9F4   3E 0F                  LD   a,0Fh   ; no NEW but RUN during reset
C9F6   32 B6 0E               LD   (BASIC_FLAG),a   
C9F9   C3 F4 C8               JP   L_EXIT_TO_BASIC   
C9FC                             ; Set memory map to: SYS, U1, U2, CART
C9FC   3E 20                  LD   a,20h   
C9FE   D3 02                  OUT   (2),a   
CA00   C3 22 03               JP   BASIC_ENTRY   
CA03                LOAD_BIN:      
CA03   23                     INC   hl   
CA04   5E                     LD   e,(hl)   
CA05   23                     INC   hl   
CA06   56                     LD   d,(hl)   
CA07   EB                     EX   de,hl   
CA08   E5                     PUSH   hl   ; HL: position of CAS in struct array
CA09   CD B5 CB               CALL   F_COPY_BASIC_INIT   
CA0C   CD AD 08               CALL   F_BASIC_INIT   
CA0F   E1                     POP   hl   
CA10   CD F8 08               CALL   F_COPY_BIN_FROM_CART_INU0   
CA13   C3 F4 C8               JP   L_EXIT_TO_BASIC   
CA16                             ; DEL pressed
CA16                             ; let"s wait until it"s release
CA16                KEYPRESS_DEL:      
CA16   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
CA19   47                     LD   b,a   
CA1A   3A 85 08               LD   a,(LIST_SELECTED_ELEMENT)   
CA1D   80                     ADD   a,b   
CA1E   FE 00                  CP   $00   
CA20   CA A9 C7               JP   z,F_HANDLE_INPUT   ; BASIC selected
CA23   01 09 0F               LD   bc,15*256+9   ; x;y => 15;9
CA26   11 08 22               LD   de,34*256+8   ; w;h => 34;6
CA29   CD BE C4               CALL   f_show_dialog_box   
CA2C   CD 3E C6               CALL   f_print_delete_question   
CA2F   F3                     DI      
CA30                L_ANSWER_SCAN_LOOP:      
CA30   CD 66 CB               CALL   get_answer   
CA33   FE 00                  CP   $00   
CA35   28 F9                  JR   z,L_ANSWER_SCAN_LOOP   
CA37   F5                     PUSH   af   
CA38                L_ANSWER_SCAN_RELEASE:      
CA38   CD 66 CB               CALL   get_answer   
CA3B   FE 00                  CP   $00   
CA3D   20 F9                  JR   nz,L_ANSWER_SCAN_RELEASE   
CA3F   F1                     POP   af   
CA40   FE 01                  CP   1   
CA42   20 06                  JR   nz,L_TO_DELETE   
CA44   CD DE C4               CALL   f_close_dialog_box   
CA47   C3 A9 C7               JP   F_HANDLE_INPUT   
CA4A                L_TO_DELETE:      
CA4A   CD D5 C6               CALL   F_CLEAR_BOX   
CA4D   CD 42 33               CALL   F_DELETE_SELECTED_FROM_FLASH   
CA50   11 1D 3D               LD   de,STR_FLASH_PRESS_SPACE   
CA53   01 1E 00               LD   bc,STR_FLASH_PRESS_SPACE_END-STR_FLASH_PRESS_SPACE   
CA56   3E 01                  LD   a,1   
CA58   CD 04 C7               CALL   F_PRINT_ONE_LINE_IN_DIALOG   
CA5B   CD A2 CB               CALL   WAIT_FOR_SPACE   
CA5E   CD DE C4               CALL   f_close_dialog_box   
CA61   CD C6 30               CALL   F_CALC_FREE_SPACE   
CA64   CD B4 C1               CALL   F_PRINT_FREE_SPACE   
CA67   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
CA6A   4F                     LD   c,a   
CA6B   3A 86 08               LD   a,(NUM_OF_IMAGES)   
CA6E   3C                     INC   a   
CA6F   91                     SUB   c   
CA70   FE 10                  CP   N_HEIGHT   
CA72   30 05                  JR   nc,DELETE_DONE   
CA74   4F                     LD   c,a   
CA75   0C                     INC   c   
CA76   CD D8 C3               CALL   F_CLEAR_ONE_LINE_IN_BOX   
CA79                L_SKIP_DELETE:      
CA79                DELETE_DONE:      
CA79   C9                     RET      
CA7A                KEYPRESS_SORT_SIZE:      
CA7A   06 02                  LD   b,SORT_TYPE_SIZE   
CA7C   C3 8A 39               JP   F_SORT   
CA7F                KEYPRESS_SORT_TYPE:      
CA7F   06 03                  LD   b,SORT_TYPE_TYPE   
CA81   C3 8A 39               JP   F_SORT   
CA84                KEYPRESS_SORT_NAME:      
CA84   06 01                  LD   b,SORT_TYPE_NAME   
CA86   C3 8A 39               JP   F_SORT   
CA89                KEYPRESS_RESET_SORT:      
CA89   AF                     XOR   a   
CA8A   32 74 38               LD   (PREVIOUS_SORT_TYPE),a   
CA8D   32 75 38               LD   (CURRENT_SORT_TYPE),a   
CA90   C3 F5 32               JP   F_INIT_ENTRIES   
CA93                KEYPRESS_RENAME:      
CA93   3A 83 08               LD   a,(LIST_FIRST_ELEMENT)   
CA96   47                     LD   b,a   
CA97   3A 85 08               LD   a,(LIST_SELECTED_ELEMENT)   
CA9A   80                     ADD   a,b   
CA9B   FE 00                  CP   $00   
CA9D   CA A9 C7               JP   z,F_HANDLE_INPUT   ; BASIC selected, cancel rename
CAA0   CD C1 36               CALL   F_RENAME_FILE   
CAA3   B7                     OR   a   
CAA4   CA A9 C7               JP   z,F_HANDLE_INPUT   
CAA7                RENAME_DONE:      
CAA7   C9                     RET      
CAA8                KEYPRESS_RAM_TEST:      
CAA8   3A 8A 08               LD   a,(SIZE_OF_CART_RAM)   
CAAB   FE 00                  CP   $00   
CAAD   CA A9 C7               JP   z,F_HANDLE_INPUT   
CAB0   CD FE 31               CALL   F_CART_RAM_TEST   
CAB3   C9                     RET      
CAB4                KEY_NOT_FOUND:      
CAB4   01 00 00               LD   bc,0   
CAB7                TEST_LOOP2:      
CAB7   10 FE                  DJNZ   TEST_LOOP2   
CAB9   79                     LD   a,c   
CABA   D3 00                  OUT   (0),a   
CABC   0D                     DEC   c   
CABD   20 F8                  JR   nz,test_loop2   
CABF   C3 A9 C7               JP   F_HANDLE_INPUT   
CAC2                F_KEYBOARD_SCAN:      
CAC2   F3                     DI      
CAC3   0E 00                  LD   c,0   
CAC5   3E 02                  LD   a,2   ; check T
CAC7   D3 03                  OUT   (3),a   
CAC9   DB 58                  IN   a,($58)   
CACB   CB 47                  BIT   0,a   
CACD   20 03                  JR   nz,CHECK_R   
CACF   0E 09                  LD   c,KEY_T   
CAD1   C9                     RET      
CAD2                CHECK_R:      
CAD2   CB 7F                  BIT   7,a   
CAD4   20 03                  JR   nz,CHECK_O   
CAD6   0E 0B                  LD   c,KEY_R   
CAD8   C9                     RET      
CAD9                CHECK_O:      
CAD9   3E 03                  LD   a,3   
CADB   D3 03                  OUT   (3),a   
CADD   DB 58                  IN   a,($58)   
CADF   CB 57                  BIT   2,a   
CAE1   20 03                  JR   nz,CHECK_S   
CAE3   0E 0C                  LD   c,KEY_O   
CAE5   C9                     RET      
CAE6                CHECK_S:      
CAE6   3E 04                  LD   a,4   
CAE8   D3 03                  OUT   (3),a   
CAEA   DB 58                  IN   a,($58)   
CAEC   CB 57                  BIT   2,a   
CAEE   20 03                  JR   nz,CHECK_A   
CAF0   0E 0A                  LD   c,KEY_S   
CAF2   C9                     RET      
CAF3                CHECK_A:      
CAF3   CB 77                  BIT   6,a   
CAF5   20 03                  JR   nz,CheckE_acute   
CAF7                             ; up pressed
CAF7   0E 01                  LD   c,KEY_UP   
CAF9   C9                     RET      
CAFA                CHECKE_ACUTE:      
CAFA                             ; Check E' - Page Up
CAFA   3E 05                  LD   a,5   
CAFC   D3 03                  OUT   (3),a   
CAFE   DB 58                  IN   a,($58)   
CB00   CB 77                  BIT   6,a   
CB02   20 03                  JR   nz,CHECK_DEL   
CB04   0E 03                  LD   c,KEY_PG_UP   
CB06   C9                     RET      
CB07                CHECK_DEL:      
CB07   CB 47                  BIT   0,a   
CB09   20 03                  JR   nz,CHECK_RETURN   
CB0B   0E 07                  LD   c,KEY_DEL   
CB0D   C9                     RET      
CB0E                CHECK_RETURN:      
CB0E   CB 67                  BIT   4,a   
CB10   20 03                  JR   nz,CHECK_Y   
CB12   0E 06                  LD   c,KEY_RETURN   
CB14   C9                     RET      
CB15                CHECK_Y:      
CB15   3E 06                  LD   a,6   ; check Y - DOWN
CB17   D3 03                  OUT   (3),a   
CB19   DB 58                  IN   a,($58)   
CB1B   CB 77                  BIT   6,a   
CB1D   20 03                  JR   nz,CHECK_N   
CB1F   0E 02                  LD   c,KEY_DN   
CB21   C9                     RET      
CB22                CHECK_N:      
CB22   CB 67                  BIT   4,a   
CB24   20 03                  JR   nz,CHECK_COLON   
CB26   0E 08                  LD   c,KEY_N   
CB28   C9                     RET      
CB29                CHECK_COLON:      
CB29   3E 07                  LD   a,7   
CB2B   D3 03                  OUT   (3),a   
CB2D   DB 58                  IN   a,($58)   
CB2F   CB 57                  BIT   2,a   
CB31   20 03                  JR   nz,CHECK_SPACE   
CB33   0E 04                  LD   c,KEY_PG_DN   
CB35   C9                     RET      
CB36                CHECK_SPACE:      
CB36   CB 6F                  BIT   5,a   
CB38   20 03                  JR   nz,CHECK_M   
CB3A   0E 05                  LD   c,KEY_TGL_RST   
CB3C   C9                     RET      
CB3D                CHECK_M:      
CB3D   CB 7F                  BIT   7,a   
CB3F   20 03                  JR   nz,JOY_UP   
CB41   0E 0D                  LD   c,KEY_M   
CB43   C9                     RET      
CB44                JOY_UP:      
CB44   3E 08                  LD   a,8   
CB46   D3 03                  OUT   (3),a   
CB48   DB 58                  IN   a,($58)   
CB4A   CB 4F                  BIT   1,a   
CB4C   20 03                  JR   nz,JOY_DOWN   
CB4E   0E 01                  LD   c,KEY_UP   
CB50   C9                     RET      
CB51                JOY_DOWN:      
CB51   CB 57                  BIT   2,a   
CB53   20 03                  JR   nz,JOY_RIGHT   
CB55   0E 02                  LD   c,KEY_DN   
CB57   C9                     RET      
CB58                JOY_RIGHT:      
CB58   CB 6F                  BIT   5,a   
CB5A   20 03                  JR   nz,JOY_LEFT   
CB5C   0E 04                  LD   c,KEY_PG_DN   
CB5E   C9                     RET      
CB5F                JOY_LEFT:      
CB5F   CB 77                  BIT   6,a   
CB61   20 02                  JR   nz,DONE_KEYSCAN   
CB63   0E 03                  LD   c,KEY_PG_UP   
CB65                DONE_KEYSCAN:      
CB65   C9                     RET      
CB66                GET_ANSWER:      
CB66   06 00                  LD   b,0   
CB68   16 0A                  LD   d,10   
CB6A                L_SCAN_LOOP:      
CB6A   CD 7A CB               CALL   scan_answer_keys   
CB6D   79                     LD   a,c   
CB6E   B8                     CP   b   
CB6F   28 05                  JR   z,L_same_key_pressed   
CB71   47                     LD   b,a   
CB72   16 03                  LD   d,3   
CB74   18 F4                  JR   L_SCAN_LOOP   
CB76                L_SAME_KEY_PRESSED:      
CB76   15                     DEC   d   
CB77   20 F1                  JR   nz,L_SCAN_LOOP   
CB79   C9                     RET      
CB7A                SCAN_ANSWER_KEYS:      
CB7A   0E 00                  LD   c,0   
CB7C   3E 06                  LD   a,6   ; checking for "N"
CB7E   D3 03                  OUT   (3),a   
CB80   DB 58                  IN   a,($58)   
CB82   CB 67                  BIT   4,a   
CB84   28 16                  JR   z,L_SCAN_DONE_N   
CB86   CB 77                  BIT   6,a   ; checking for "Y"
CB88   28 0F                  JR   z,L_SCAN_DONE_Y   
CB8A   3E 07                  LD   a,7   ; checking for "ESC"
CB8C   D3 03                  OUT   (3),a   
CB8E   DB 58                  IN   a,($58)   
CB90   CB 5F                  BIT   3,a   
CB92   28 08                  JR   z,L_SCAN_DONE_N   
CB94   CB 6F                  BIT   5,a   
CB96   28 07                  JR   z,L_SCAN_DONE_SPC   
CB98   C9                     RET      
CB99                L_SCAN_DONE_Y:      
CB99   0E 02                  LD   c,2   
CB9B   C9                     RET      
CB9C                L_SCAN_DONE_N:      
CB9C   0E 01                  LD   c,1   
CB9E   C9                     RET      
CB9F                L_SCAN_DONE_SPC:      
CB9F   0E 03                  LD   c,3   
CBA1   C9                     RET      
CBA2                WAIT_FOR_SPACE:      
CBA2                L_SPACE_SCAN_LOOP:      
CBA2   CD 66 CB               CALL   get_answer   
CBA5   FE 00                  CP   $00   
CBA7   28 F9                  JR   z,L_SPACE_SCAN_LOOP   
CBA9   FE 03                  CP   $03   
CBAB   20 F5                  JR   nz,L_SPACE_SCAN_LOOP   
CBAD                L_SPACE_SCAN_RELEASE:      
CBAD   CD 66 CB               CALL   get_answer   
CBB0   FE 00                  CP   $00   
CBB2   20 F9                  JR   nz,L_SPACE_SCAN_RELEASE   
CBB4   C9                     RET      
CBB5                F_COPY_BASIC_INIT:      
CBB5   01 E6 00               LD   bc,F_COPY_CAS_FROM_CART_END - F_COPY_CAS_FROM_CART   
CBB8   11 A0 08               LD   de,TEMP_MEMORY_U0   
CBBB   21 C1 CB               LD   hl,F_COPY_CAS_FROM_CART   
CBBE   ED B0                  LDIR      
CBC0   C9                     RET      
CBC1                F_COPY_CAS_FROM_CART:      
CBC1                          .PHASE   TEMP_MEMORY_U0   
08A0 @CBC1          CURRENT_TVC_POS:      
08A0 @CBC1   00 00            DW   0   
08A2 @CBC3          CURRENT_CART_POS:      
08A2 @CBC3   00 00            DW   0   
08A4 @CBC5          CURRENT_NUM_OF_COPIED_BYTES:      
08A4 @CBC5   00 00            DW   0   
08A6 @CBC7          REMAINIG_SIZE_OF_CAS:      
08A6 @CBC7   00 00            DW   0   
08A8 @CBC9          REMAINING_BYTES_IN_BANK:      
08A8 @CBC9   00 00            DW   0   
08AA @CBCB          CAS_BYTES_ABOVE_C000:      
08AA @CBCB   00 00            DW   0   
08AC @CBCD          BANK_SELECT:      
08AC @CBCD   00               DB   0   
08AD @CBCE          F_BASIC_INIT:      ; Set memory map to: U0, U1, U2, SYS
08AD @CBCE   3E 70            LD   a,70h   
08AF @CBD0   32 03 00         LD   (3),a   
08B2 @CBD3   D3 02            OUT   (2),a   
08B4 @CBD5   3A 0C DA         LD   a,(0da0ch)   
08B7 @CBD8   FE 5B            CP   5bh   
08B9 @CBDA   20 21            JR   nz,BASIC_INIT_END   
08BB @CBDC   32 E4 08         LD   (BASIC_VERSION),a   
08BE @CBDF   21 00 17         LD   hl,1700h   
08C1 @CBE2   E5               PUSH   hl   
08C2 @CBE3   DD E1            POP   ix   
08C4 @CBE5   01 EF 02         LD   bc,02efh   
08C7 @CBE8   11 01 17         LD   de,1701h   
08CA @CBEB   36 00            LD   (hl),0   
08CC @CBED   ED B0            LDIR      
08CE @CBEF   21 5B FB         LD   hl,0fb5bh   
08D1 @CBF2   11 08 00         LD   de,8   
08D4 @CBF5   01 27 00         LD   bc,27h   
08D7 @CBF8   ED B0            LDIR      
08D9 @CBFA   CD 10 DE         CALL   0de10h   
08DC @CBFD          BASIC_INIT_END:      ; Set memory map to: U0, U1, U2, CART
08DC @CBFD   3E 30            LD   a,30h   
08DE @CBFF   32 03 00         LD   (3),a   
08E1 @CC02   D3 02            OUT   (2),a   
08E3 @CC04   C9               RET      
08E4 @CC05          BASIC_VERSION:      
08E4 @CC05   02               DB   2   
08E5 @CC06          MEMORY_PAGING:      
08E5 @CC06   3E 70            LD   a,70h   
08E7 @CC08   32 03 00         LD   (3),a   
08EA @CC0B   D3 02            OUT   (2),a   
08EC @CC0D   FB               EI      
08ED @CC0E   3A 1B DE         LD   a,(0de1bh)   
08F0 @CC11   FE 2A            CP   2ah   
08F2 @CC13   CA 1B DE         JP   z,0DE1Bh   ; RUN in BASIC 1.2
08F5 @CC16   C3 ED D6         JP   0d6edh   ; RUN in BASIC 2.x
08F8 @CC19          F_COPY_BIN_FROM_CART_INU0:      
08F8 @CC19   23               INC   HL   
08F9 @CC1A   7E               LD   A,(hl)   ; bank
08FA @CC1B   23               INC   HL   
08FB @CC1C   56               LD   D,(hl)   ; sector
08FC @CC1D   32 02 C0         LD   (REGISTER_DISABLE_RESET),A   
08FF @CC20   3E C0            LD   A,$C0   
0901 @CC22   82               ADD   A,D   
0902 @CC23   67               LD   H,a   
0903 @CC24   2E 00            LD   L,0   
0905 @CC26   E5               PUSH   HL   
0906 @CC27   01 FE 00         LD   bc,$00FE   
0909 @CC2A   7E               LD   a,(hl)   ; bank of next block or $FF in case of last block
090A @CC2B   FE FF            CP   $FF   
090C @CC2D   20 03            JR   nz,L_BIN_BLOCK_SIZE_OK   
090E @CC2F   23               INC   hl   
090F @CC30   4E               LD   c,(hl)   
0910 @CC31   2B               DEC   hl   
0911 @CC32          L_BIN_BLOCK_SIZE_OK:      
0911 @CC32   23               INC   hl   
0912 @CC33   23               INC   hl   
0913 @CC34   5E               LD   e,(hl)   
0914 @CC35   23               INC   hl   
0915 @CC36   56               LD   d,(hl)   
0916 @CC37   ED 53 A0 08      LD   (CURRENT_TVC_POS),de   
091A @CC3B   18 1F            JR   CC_COPY_ONE_SECTOR   
091C @CC3D                       ; input
091C @CC3D                       ; - HL: pointer to 4byte image record
091C @CC3D          F_COPY_CAS_FROM_CART_INU0:      
091C @CC3D   11 EF 19         LD   de,BASIC_PROGRAM_START   
091F @CC40   ED 53 A0 08      LD   (CURRENT_TVC_POS),de   
0923 @CC44                       ; get the FIRST 256 byte sector
0923 @CC44   23               INC   HL   
0924 @CC45   7E               LD   A,(hl)   ; bank
0925 @CC46   23               INC   HL   
0926 @CC47   56               LD   D,(hl)   ; sector
0927 @CC48   32 02 C0         LD   (REGISTER_DISABLE_RESET),A   
092A @CC4B   3E C0            LD   A,$C0   
092C @CC4D   82               ADD   A,D   
092D @CC4E   67               LD   H,a   
092E @CC4F   2E 00            LD   L,0   
0930 @CC51   E5               PUSH   HL   
0931 @CC52          CC_LOOP_SECTOR_COPY:      
0931 @CC52   7E               LD   a,(HL)   
0932 @CC53   FE FF            CP   $FF   
0934 @CC55   01 FE 00         LD   bc,$00FE   
0937 @CC58   23               INC   HL   
0938 @CC59   20 01            JR   nz,CC_COPY_ONE_SECTOR   
093A @CC5B   4E               LD   C,(hl)   ; adjust block size
093B @CC5C          CC_COPY_ONE_SECTOR:      
093B @CC5C   23               INC   HL   
093C @CC5D   ED 5B A0 08      LD   de,(CURRENT_TVC_POS)   
0940 @CC61                       ; HL, DE, BC: source, target, copy-block size
0940 @CC61                       ; check if copy would go to U3
0940 @CC61   D5               PUSH   de   
0941 @CC62   E5               PUSH   hl   
0942 @CC63   EB               EX   de,hl   
0943 @CC64   09               ADD   hl,bc   
0944 @CC65   3E BF            LD   a,$BF   
0946 @CC67   BC               CP   h   
0947 @CC68   E1               POP   hl   
0948 @CC69   D1               POP   de   
0949 @CC6A   38 1C            JR   c,CC_COPY_INTO_U3   ; yes, need to copy into U3
094B @CC6C   ED B0            LDIR      ; no, copy simple
094D @CC6E          CC_FINISHED_COPY:      
094D @CC6E   ED 53 A0 08      LD   (CURRENT_TVC_POS),de   
0951 @CC72   E1               POP   HL   
0952 @CC73   7E               LD   a,(hl)   
0953 @CC74   FE FF            CP   $FF   
0955 @CC76   28 23            JR   z,CC_EXIT   
0957 @CC78   23               INC   HL   
0958 @CC79   56               LD   D,(hl)   
0959 @CC7A   32 02 C0         LD   (REGISTER_DISABLE_RESET),A   
095C @CC7D   3E C0            LD   A,$C0   
095E @CC7F   82               ADD   A,D   
095F @CC80   D3 00            OUT   (0),A   
0961 @CC82   67               LD   H,A   
0962 @CC83   2E 00            LD   L,0   
0964 @CC85   E5               PUSH   HL   
0965 @CC86   18 CA            JR   CC_LOOP_SECTOR_COPY   
0967 @CC88          CC_COPY_INTO_U3:      
0967 @CC88   41               LD   b,c   
0968 @CC89          CC_COPY_INTO_U3_LOOP:      
0968 @CC89   4E               LD   c,(HL)   
0969 @CC8A   EB               EX   DE,HL   
096A @CC8B   3E B0            LD   a,$B0   ; (U0-U1-U2-U3)
096C @CC8D   D3 02            OUT   (2),A   
096E @CC8F   71               LD   (hl),C   
096F @CC90   3E 30            LD   a,$30   ; (U0-U1-U2-CART)
0971 @CC92   D3 02            OUT   (2),A   
0973 @CC94   EB               EX   DE,HL   
0974 @CC95   13               INC   DE   
0975 @CC96   23               INC   HL   
0976 @CC97   10 F0            DJNZ   CC_COPY_INTO_U3_LOOP   
0978 @CC99   18 D3            JR   CC_FINISHED_COPY   
097A @CC9B          CC_EXIT:      
097A @CC9B   13               INC   de   
097B @CC9C   ED 53 26 17      LD   (TVC_TOP),de   
097F @CCA0   AF               XOR   a   ; sideeffect: keeps Z set
0980 @CCA1   32 00 C0         LD   (REGISTER),a   
0983 @CCA4   D3 00            OUT   (0),a   
0985 @CCA6   C9               RET      
0986 @CCA7                    .DEPHASE      
CCA7                F_COPY_CAS_FROM_CART_END:      
CCA7                CONFIGURE_EXT0:      
CCA7   21 B7 CC               LD   hl,EXT0_BOOT_ROUTINE   
CCAA   11 A0 08               LD   de,EXT0_BASE   
CCAD   ED 53 21 00            LD   ($0021),de   
CCB1   01 3E 00               LD   bc,EXT0_BOOT_ROUTINE_END-EXT0_BOOT_ROUTINE   
CCB4   ED B0                  LDIR      
CCB6   C9                     RET      
CCB7                EXT0_BOOT_ROUTINE:      
CCB7                          .PHASE   EXT0_BASE   
08A0 @CCB7   F3               DI      
08A1 @CCB8   3E 30            LD   a,$30   
08A3 @CCBA   D3 02            OUT   (2),A   
08A5 @CCBC   3A 03 00         LD   a,(0003)   
08A8 @CCBF   F5               PUSH   af   
08A9 @CCC0   3E 30            LD   a,$30   
08AB @CCC2   32 03 00         LD   (3),A   
08AE @CCC5   AF               XOR   a   
08AF @CCC6   32 00 C0         LD   (register),a   
08B2 @CCC9   CD F5 CC         CALL   EXT0_ROUTINE   
08B5 @CCCC   21 5E D4         LD   hl,STR_EXT0_CRLF   
08B8 @CCCF   CD C9 D2         CALL   PRINT_CSTRING   
08BB @CCD2   F1               POP   af   
08BC @CCD3   32 03 00         LD   (3),A   
08BF @CCD6   D3 02            OUT   (2),a   
08C1 @CCD8   FB               EI      
08C2 @CCD9   C9               RET      
08C3 @CCDA          PROGRAM_SIZE_TO_SAVE:      
08C3 @CCDA   00 00            DW   0   
08C5 @CCDC          BAM_IN_TVC_RAM:      
08C5 @CCDC   00 00            DW   0   
08C7 @CCDE          MAPPED_IN_SECTOR:      
08C7 @CCDE   00               DB   0   
08C8 @CCDF          PREV_BANK_BLOCK:      
08C8 @CCDF   00 00            DW   0   
08CA @CCE1          CURRENT_BAM_ADDRESS:      
08CA @CCE1   00 00            DW   0   
08CC @CCE3          PROGRAM_POS:      
08CC @CCE3   00 00            DW   0   
08CE @CCE5          EXT0_TEMP_STR:      
08CE @CCE5                    DS   16   
08DE @CCF5          EXT0_BASE_END:      
08DE @CCF5                    .DEPHASE      
CCF5                EXT0_BOOT_ROUTINE_END:      
CCF5                EXT0_ROUTINE:      
CCF5                             ;            call EXT0_INIT_CHIP_VARIABLES
CCF5   21 9D D3               LD   hl,STR_EXT0_Q1   
CCF8   CD C9 D2               CALL   PRINT_CSTRING   
CCFB   CD 27 CD               CALL   SELECT_MENU   
CCFE   C9                     RET      
CCFF                EXT0_INIT_CHIP_VARIABLES:      
CCFF   01 00 02               LD   bc,$0200   
CD02   21 00 30               LD   hl,$3000   
CD05   11 00 09               LD   de,$0900   
CD08   ED B0                  LDIR      ; backup ram on $3000
CD0A   21 70 DA               LD   hl,CODE_IN_CART   ; ROM check start!
CD0D   11 00 30               LD   de,$3000   
CD10   01 00 00               LD   bc,ROM_CHECK_END-ROM_CHECK_END   
CD13   ED B0                  LDIR      
CD15   CD 00 30               CALL   F_CHECK_ROM_IDS   ; calculate IDs
CD18   CD C6 30               CALL   F_CALC_FREE_SPACE   ; calculate free space
CD1B   01 00 02               LD   bc,$0200   
CD1E   11 00 30               LD   de,$3000   
CD21   21 00 09               LD   hl,$0900   
CD24   ED B0                  LDIR      ; restore ram on $3000
CD26   C9                     RET      
CD27                SELECT_MENU:      
CD27   CD 5E CE               CALL   EXT0_INPUT_STRING   
CD2A   3E 01                  LD   a,1   
CD2C   B9                     CP   c   
CD2D   20 16                  JR   nz,NOT_EXPECTED   
CD2F   21 CE 08               LD   hl,EXT0_TEMP_STR   
CD32   7E                     LD   a,(hl)   
CD33   FE 31                  CP   "1"   
CD35   28 31                  JR   z,MENU_1_SELECTED   
CD37   FE 32                  CP   "2"   
CD39   CA 57 CE               JP   z,MENU_2_SELECTED   
CD3C   FE 33                  CP   "3"   
CD3E   CA 57 CE               JP   z,MENU_3_SELECTED   
CD41   FE FF                  CP   $FF   
CD43   28 08                  JR   z,L_SELECT_MENU_INTERRUPTED   
CD45                NOT_EXPECTED:      
CD45   21 44 D4               LD   hl,STR_EXT0_NOT_EXPECTED   
CD48   CD C9 D2               CALL   PRINT_CSTRING   
CD4B   18 06                  JR   L_SELECT_MENU_EXIT   
CD4D                L_SELECT_MENU_INTERRUPTED:      
CD4D   21 2D D4               LD   hl,STR_EXT0_INTERRUPTED   
CD50   CD C9 D2               CALL   PRINT_CSTRING   
CD53                L_SELECT_MENU_EXIT:      
CD53   C9                     RET      
CD54                INPUT_FILE_NAME:      
CD54   3E 20                  LD   a,$20   
CD56   32 CE 08               LD   (EXT0_TEMP_STR),a   
CD59   01 0F 00               LD   bc,$0F   
CD5C   11 CF 08               LD   de,EXT0_TEMP_STR+1   
CD5F   21 CE 08               LD   hl,EXT0_TEMP_STR   
CD62   ED B0                  LDIR      
CD64   CD 5E CE               CALL   EXT0_INPUT_STRING   
CD67   C9                     RET      
CD68                MENU_1_SELECTED:      
CD68   21 36 D3               LD   hl,STR_EXT0_MENU1_SELECTED   
CD6B   CD C9 D2               CALL   PRINT_CSTRING   
CD6E   21 89 D3               LD   hl,STR_EXT0_FILENAME_Q   
CD71   CD C9 D2               CALL   PRINT_CSTRING   
CD74   CD 54 CD               CALL   INPUT_FILE_NAME   
CD77   3E 00                  LD   a,0   
CD79   B9                     CP   c   
CD7A   28 C9                  JR   z,NOT_EXPECTED   
CD7C   3E FF                  LD   a,$ff   
CD7E   B9                     CP   c   
CD7F   28 04                  JR   z,MENU_INTERRUPTED   
CD81   CD AC CE               CALL   SAVE_BASIC_PROGRAM   
CD84   C9                     RET      
CD85                MENU_INTERRUPTED:      
CD85   21 2D D4               LD   hl,STR_EXT0_INTERRUPTED   
CD88   CD C9 D2               CALL   PRINT_CSTRING   
CD8B   C9                     RET      
CD8C                MENU_2_SELECTED_SKIP:      
CD8C   CD 85 CE               CALL   CHECK_IC_SAVE_BINARY_PROGRAM   
CD8F   C8                     RET   z   
CD90   21 59 D3               LD   hl,STR_EXT0_MENU2_SELECTED   
CD93   CD C9 D2               CALL   PRINT_CSTRING   
CD96   21 89 D3               LD   hl,STR_EXT0_FILENAME_Q   
CD99   CD C9 D2               CALL   PRINT_CSTRING   
CD9C   CD 54 CD               CALL   INPUT_FILE_NAME   
CD9F   3E 00                  LD   a,0   
CDA1   B9                     CP   c   
CDA2   28 A1                  JR   z,NOT_EXPECTED   
CDA4   3E FF                  LD   a,$ff   
CDA6   B9                     CP   c   
CDA7   28 DC                  JR   z,MENU_INTERRUPTED   
CDA9   21 CE 08               LD   hl,EXT0_TEMP_STR   
CDAC   11 00 07               LD   de,$0700   
CDAF   01 10 00               LD   bc,$0010   
CDB2   ED B0                  LDIR      
CDB4   AF                     XOR   a   
CDB5   32 CE 08               LD   (EXT0_TEMP_STR),a   
CDB8   01 0F 00               LD   bc,$0F   
CDBB   11 CF 08               LD   de,EXT0_TEMP_STR+1   
CDBE   21 CE 08               LD   hl,EXT0_TEMP_STR   
CDC1   ED B0                  LDIR      
CDC3   21 CC D5               LD   hl,STR_EXT0_ENTER_START_ADDR   
CDC6   CD C9 D2               CALL   PRINT_CSTRING   
CDC9   CD 5E CE               CALL   EXT0_INPUT_STRING   
CDCC   79                     LD   a,c   
CDCD   FE FF                  CP   $ff   
CDCF   CA 45 CD               JP   z,NOT_EXPECTED   
CDD2   FE 00                  CP   $00   
CDD4   CA 45 CD               JP   z,NOT_EXPECTED   
CDD7   CD 15 CE               CALL   EXT0_CONVERT_STR_TO_INT   
CDDA   CA 45 CD               JP   z,NOT_EXPECTED   
CDDD   22 CC 08               LD   (PROGRAM_POS),hl   
CDE0   21 F1 D5               LD   hl,STR_EXT0_ENTER_LAST_ADDR   
CDE3   CD C9 D2               CALL   PRINT_CSTRING   
CDE6   CD 5E CE               CALL   EXT0_INPUT_STRING   
CDE9   79                     LD   a,c   
CDEA   FE FF                  CP   $ff   
CDEC   CA 45 CD               JP   z,NOT_EXPECTED   
CDEF   FE 00                  CP   $00   
CDF1   CA 45 CD               JP   z,NOT_EXPECTED   
CDF4   CD 15 CE               CALL   EXT0_CONVERT_STR_TO_INT   
CDF7   CA 45 CD               JP   z,NOT_EXPECTED   
CDFA   EB                     EX   de,hl   
CDFB   2A CC 08               LD   hl,(PROGRAM_POS)   
CDFE   EB                     EX   de,hl   
CDFF   B7                     OR   a   
CE00   ED 52                  SBC   hl,de   
CE02   23                     INC   hl   
CE03   22 C3 08               LD   (PROGRAM_SIZE_TO_SAVE),hl   
CE06   21 00 07               LD   hl,$0700   
CE09   11 CE 08               LD   de,EXT0_TEMP_STR   
CE0C   01 10 00               LD   bc,$0010   
CE0F   ED B0                  LDIR      
CE11   CD AC CE               CALL   SAVE_BASIC_PROGRAM   
CE14   C9                     RET      
CE15                EXT0_CONVERT_STR_TO_INT:      
CE15   79                     LD   a,c   
CE16   01 CE 08               LD   bc,EXT0_TEMP_STR   
CE19   81                     ADD   a,c   
CE1A   4F                     LD   c,a   
CE1B   AF                     XOR   a   
CE1C   02                     LD   (bc),a   
CE1D   21 00 00               LD   hl,0   
CE20   01 CE 08               LD   bc,EXT0_TEMP_STR   
CE23                L_CONVERT_STR2INT_LOOP:      
CE23   0A                     LD   a,(bc)   
CE24   FE 00                  CP   0   
CE26   28 2C                  JR   z,L_CONVERT_DONE   
CE28   FE 30                  CP   "0"   
CE2A   38 26                  JR   c,L_CONVERT_FAILED   
CE2C   FE 39                  CP   "9"   
CE2E   30 22                  JR   nc,L_CONVERT_FAILED   
CE30   D6 30                  SUB   "0"   
CE32   54                     LD   d,h   
CE33   5D                     LD   e,l   
CE34   CB 23                  SLA   e   ; mul de by 2
CE36   CB 12                  RL   d   
CE38   CB 25                  SLA   l   ; mul hl by 8
CE3A   CB 14                  RL   h   
CE3C   CB 25                  SLA   l   
CE3E   CB 14                  RL   h   
CE40   CB 25                  SLA   l   
CE42   CB 14                  RL   h   
CE44   19                     ADD   hl,de   ; hl -> hl x 10
CE45   38 0B                  JR   c,L_CONVERT_FAILED   
CE47   85                     ADD   a,l   
CE48   6F                     LD   l,a   
CE49   7C                     LD   a,h   
CE4A   CE 00                  ADC   a,0   
CE4C   38 04                  JR   c,L_CONVERT_FAILED   
CE4E   67                     LD   h,a   
CE4F   03                     INC   bc   
CE50   18 D1                  JR   L_CONVERT_STR2INT_LOOP   
CE52                L_CONVERT_FAILED:      
CE52   AF                     XOR   a   ; Z is set
CE53   C9                     RET      
CE54                L_CONVERT_DONE:      
CE54   AF                     XOR   a   ; Z is reset
CE55   3C                     INC   a   
CE56   C9                     RET      
CE57                MENU_2_SELECTED:      
CE57                MENU_3_SELECTED:      
CE57   21 15 D5               LD   hl,STR_EXT0_FEATURE_NOT_SUPPORTED   
CE5A   CD C9 D2               CALL   PRINT_CSTRING   
CE5D   C9                     RET      
CE5E                EXT0_INPUT_STRING:      
CE5E   FB                     EI      
CE5F   F7                     RST   30h   
CE60   24                     DB   $24   
CE61   21 CE 08               LD   hl,EXT0_TEMP_STR   
CE64   01 00 10               LD   bc,$1000   ; init C to 0, init B to $10
CE67                L_EXT0_CHIN_LOOP:      
CE67   E5                     PUSH   hl   
CE68   C5                     PUSH   bc   
CE69   FB                     EI      
CE6A   F7                     RST   30h   
CE6B   A1                     DB   $A1   
CE6C   F3                     DI      
CE6D   79                     LD   a,c   
CE6E   C1                     POP   bc   
CE6F   E1                     POP   hl   
CE70   FE 1B                  CP   $1b   ; ESC
CE72   28 0E                  JR   z,L_ED_CHIN_INTERRUPTED   
CE74   FE 0D                  CP   $0D   
CE76   28 09                  JR   z,L_EXIT_ED_CHIN   
CE78   FE 0A                  CP   $0A   
CE7A   28 05                  JR   z,L_EXIT_ED_CHIN   
CE7C   77                     LD   (hl),a   
CE7D   0C                     INC   c   
CE7E   23                     INC   hl   
CE7F   10 E6                  DJNZ   L_EXT0_CHIN_LOOP   
CE81                L_EXIT_ED_CHIN:      
CE81   C9                     RET      
CE82                L_ED_CHIN_INTERRUPTED:      
CE82   0E FF                  LD   c,$FF   
CE84   C9                     RET      
CE85                CHECK_IC_SAVE_BINARY_PROGRAM:      
CE85   3A 90 08               LD   a,(FLASH1_TYPE)   
CE88   FE 01                  CP   $01   ; check AMD
CE8A   F5                     PUSH   af   
CE8B   CC CB CE               CALL   z,SAVE_BIN_FOR_AMD   
CE8E   F1                     POP   af   
CE8F   C8                     RET   Z   
CE90   FE 02                  CP   $02   ; check SST
CE92   20 02                  JR   nz,next_check   
CE94   3C                     INC   a   ; clear Z flag
CE95   C9                     RET      
CE96                NEXT_CHECK:      
CE96   FE 03                  CP   $03   ; check ATmel
CE98   F5                     PUSH   AF   
CE99   CC D8 CE               CALL   z,SAVE_BIN_FOR_ATMEL   
CE9C   F1                     POP   AF   
CE9D   C8                     RET   z   
CE9E   21 7E D4               LD   hl,STR_EXT0_IC_UNKNOWN   
CEA1   CD C9 D2               CALL   PRINT_CSTRING   
CEA4   21 AD D4               LD   hl,STR_EXT0_NOT_SUPPORTED   
CEA7   CD C9 D2               CALL   PRINT_CSTRING   
CEAA   AF                     XOR   a   
CEAB   C9                     RET      
CEAC                SAVE_BASIC_PROGRAM:      
CEAC   3A 90 08               LD   a,(FLASH1_TYPE)   
CEAF   FE 01                  CP   $01   ; check AMD
CEB1   CA CB CE               JP   z,SAVE_FOR_AMD   
CEB4   FE 02                  CP   $02   ; check SST
CEB6   CA E5 CE               JP   z,SAVE_FOR_SST   
CEB9   FE 03                  CP   $03   ; check ATmel
CEBB   CA D8 CE               JP   z,SAVE_FOR_ATMEL   
CEBE   21 7E D4               LD   hl,STR_EXT0_IC_UNKNOWN   
CEC1   CD C9 D2               CALL   PRINT_CSTRING   
CEC4   21 AD D4               LD   hl,STR_EXT0_NOT_SUPPORTED   
CEC7   CD C9 D2               CALL   PRINT_CSTRING   
CECA   C9                     RET      
CECB                SAVE_BIN_FOR_AMD:      
CECB                SAVE_FOR_AMD:      
CECB   21 61 D4               LD   hl,STR_EXT0_IC_AMD   
CECE   CD C9 D2               CALL   PRINT_CSTRING   
CED1   21 AD D4               LD   hl,STR_EXT0_NOT_SUPPORTED   
CED4   CD C9 D2               CALL   PRINT_CSTRING   
CED7   C9                     RET      
CED8                SAVE_BIN_FOR_ATMEL:      
CED8                SAVE_FOR_ATMEL:      
CED8   21 75 D4               LD   hl,STR_EXT0_IC_ATMEL   
CEDB   CD C9 D2               CALL   PRINT_CSTRING   
CEDE   21 AD D4               LD   hl,STR_EXT0_NOT_SUPPORTED   
CEE1   CD C9 D2               CALL   PRINT_CSTRING   
CEE4   C9                     RET      
CEE5                SAVE_FOR_SST:      
CEE5   21 6A D4               LD   hl,STR_EXT0_IC_SST   
CEE8   CD C9 D2               CALL   PRINT_CSTRING   
CEEB   21 89 D4               LD   hl,STR_EXT0_SUPPORTED   
CEEE   CD C9 D2               CALL   PRINT_CSTRING   
CEF1   CD 97 D2               CALL   CHECK_BASIC_PROGRAM_SIZE   
CEF4   CD 65 D2               CALL   calculate_usable_8k   
CEF7   AF                     XOR   a   
CEF8   BC                     CP   h   
CEF9   28 3B                  JR   z,L_NOT_ENOUGH_RAM_TO_PROGRAM_FLASH   ; returns usable 8k in HL
CEFB                             ; init variables
CEFB   32 C7 08               LD   (MAPPED_IN_SECTOR),a   
CEFE   32 C8 08               LD   (PREV_BANK_BLOCK),a   
CF01   EB                     EX   de,hl   
CF02   2A 22 17               LD   hl,($1722)   
CF05   22 CC 08               LD   (PROGRAM_POS),hl   
CF08   EB                     EX   de,hl   
CF09   7C                     LD   a,h   
CF0A   FE 01                  CP   $01   
CF0C   28 02                  JR   z,L_USE_CART_RAM   
CF0E   18 0A                  JR   L_USE_TVC_RAM   
CF10                L_USE_CART_RAM:      
CF10   21 6A D5               LD   hl,STR_EXT0_USING_CART_RAM   
CF13   CD C9 D2               CALL   PRINT_CSTRING   
CF16   CD 2D D2               CALL   COPY_BAM_TO_CART_RAM   
CF19   C9                     RET      
CF1A                L_USE_TVC_RAM:      
CF1A                             ; print selected IC
CF1A   22 C5 08               LD   (BAM_IN_TVC_RAM),hl   
CF1D   21 8D D5               LD   hl,STR_EXT0_USING_TVC_RAM   
CF20   CD C9 D2               CALL   PRINT_CSTRING   
CF23   2A C5 08               LD   hl,(BAM_IN_TVC_RAM)   ; print using selected TVC storage area
CF26   CD 90 C4               CALL   F_PRINT_HEX_NUMBER   
CF29   21 5E D4               LD   hl,STR_EXT0_CRLF   
CF2C   CD C9 D2               CALL   PRINT_CSTRING   
CF2F   CD 1A D2               CALL   COPY_BAM_TO_TVC_RAM   
CF32   CD 3D CF               CALL   TVC_RAM_COPY_PROGRAM_TO_FLASH   
CF35   C9                     RET      
CF36                L_NOT_ENOUGH_RAM_TO_PROGRAM_FLASH:      
CF36   21 3E D5               LD   hl,STR_EXT0_NOT_ENOUGH_RAM_TO_SAVE   
CF39   CD C9 D2               CALL   PRINT_CSTRING   
CF3C   C9                     RET      
CF3D                TVC_RAM_COPY_PROGRAM_TO_FLASH:      
CF3D   21 4C CF               LD   hl,CART_COPY_PROG_TVC   
CF40   01 A0 01               LD   bc,CART_COPY_PROG_TVC_END-CART_COPY_PROG_TVC   
CF43   11 DE 08               LD   de,EXT0_BASE_END   
CF46   ED B0                  LDIR      
CF48   CD DE 08               CALL   EXT0_BASE_END   ; copy_prog_TVC
CF4B   C9                     RET      
CF4C                CART_COPY_PROG_TVC:      
CF4C                          .PHASE   EXT0_BASE_END   
08DE @CF4C   AF               XOR   a   
08DF @CF4D   5F               LD   e,a   
08E0 @CF4E   16 F0            LD   d,>BAM_START & $F0   
08E2 @CF50   21 00 F0         LD   hl,BAM_START   
08E5 @CF53   AF               XOR   a   
08E6 @CF54   ED 52            SBC   hl,de   
08E8 @CF56   EB               EX   de,hl   
08E9 @CF57   2A C5 08         LD   hl,(BAM_IN_TVC_RAM)   
08EC @CF5A   19               ADD   hl,de   
08ED @CF5B   01 00 00         LD   bc,0   
08F0 @CF5E          L_SEARCH_FREE_BLOCK:      
08F0 @CF5E   7E               LD   a,(hl)   
08F1 @CF5F   FE FF            CP   $ff   
08F3 @CF61   20 0E            JR   nz,L_FREE_BLOCK_FOUND   
08F5 @CF63   23               INC   hl   
08F6 @CF64   79               LD   a,c   
08F7 @CF65   C6 08            ADD   a,8   
08F9 @CF67   4F               LD   c,a   
08FA @CF68          L_CHECK_BANK_BLOCK_POINTERS:      
08FA @CF68   FE 40            CP   64   
08FC @CF6A   20 F2            JR   nz,L_SEARCH_FREE_BLOCK   
08FE @CF6C   0E 00            LD   c,0   
0900 @CF6E   04               INC   b   
0901 @CF6F                       ; check chip size, second chip?
0901 @CF6F                       ; (not needed as not available area is FF'ed and size should
0901 @CF6F                       ;  be enough, as it was calculated earlier it fits!)
0901 @CF6F   18 ED            JR   L_SEARCH_FREE_BLOCK   
0903 @CF71          L_FREE_BLOCK_FOUND:      
0903 @CF71   3E 01            LD   a,1   
0905 @CF73          L_ALLOCATE_LOOP:      
0905 @CF73   57               LD   d,a   
0906 @CF74   A6               AND   (hl)   
0907 @CF75   7A               LD   a,d   
0908 @CF76   CC 1C D1         CALL   z,ALLOCATE_BLOCK   
090B @CF79   28 09            JR   z,L_FINALIZE_SST_COPY_FROM_TVC_RAM_AND_DONE   ; last block copied, exit loop
090D @CF7B   0C               INC   c   
090E @CF7C   CB 27            SLA   a   
0910 @CF7E   30 F3            JR   nc,L_ALLOCATE_LOOP   
0912 @CF80   23               INC   hl   
0913 @CF81   79               LD   a,c   
0914 @CF82   18 E4            JR   L_CHECK_BANK_BLOCK_POINTERS   
0916 @CF84          L_FINALIZE_SST_COPY_FROM_TVC_RAM_AND_DONE:      
0916 @CF84   C5               PUSH   bc   
0917 @CF85   0E 46            LD   c,"F"   
0919 @CF87   F7               RST   30h   
091A @CF88   21               DB   21h   
091B @CF89   F3               DI      
091C @CF8A   C1               POP   bc   
091D @CF8B   CD EC D0         CALL   MAP_OUT_SECTOR   
0920 @CF8E   CD 24 09         CALL   WRITE_BACK_SST_BAM_FROM_TVC   
0923 @CF91   C9               RET      
0924 @CF92          WRITE_BACK_SST_BAM_FROM_TVC:      
0924 @CF92   0E 65            LD   c,"e"   
0926 @CF94   F7               RST   30h   
0927 @CF95   21               DB   21h   
0928 @CF96   F3               DI      
0929 @CF97   21 00 C0         LD   hl,$c000   
092C @CF9A   22 D9 09         LD   (register_location),hl   ; default register location
092F @CF9D   AF               XOR   a   
0930 @CF9E   32 D7 09         LD   (A19_STORE),a   
0933 @CFA1   32 D8 09         LD   (REGISTER_STORE),a   
0936 @CFA4   3E F0            LD   a,>BAM_START   
0938 @CFA6   E6 30            AND   $30   
093A @CFA8   0F               RRCA      
093B @CFA9   0F               RRCA      
093C @CFAA   0F               RRCA      
093D @CFAB   0F               RRCA      
093E @CFAC   47               LD   b,a   
093F @CFAD   CD 86 09         CALL   INIT_SST_ARBITRARY_SECTOR_ERASE   
0942 @CFB0   0E 13            LD   c,$13   ; CRSR to left
0944 @CFB2   F7               RST   30h   
0945 @CFB3   21               DB   21h   
0946 @CFB4   0E 45            LD   c,"E"   
0948 @CFB6   F7               RST   30h   
0949 @CFB7   21               DB   21h   
094A @CFB8   0E 62            LD   c,"b"   
094C @CFBA   F7               RST   30h   
094D @CFBB   21               DB   21h   
094E @CFBC   F3               DI      
094F @CFBD   2A C5 08         LD   hl,(BAM_IN_TVC_RAM)   
0952 @CFC0   11 00 F0         LD   de,BAM_START   
0955 @CFC3   01 00 10         LD   bc,$1000   
0958 @CFC6   CD 21 0A         CALL   L_SST_WRITE_ONE_SECTOR_LOOP   
095B @CFC9   0E 13            LD   c,$13   ; CRSR to left
095D @CFCB   F7               RST   30h   
095E @CFCC   21               DB   21h   
095F @CFCD   0E 42            LD   c,"B"   
0961 @CFCF   F7               RST   30h   
0962 @CFD0   21               DB   21h   
0963 @CFD1   F3               DI      
0964 @CFD2   C9               RET      
0965 @CFD3          F_SET_PAGES_REG_LOC_USED:      ; HL-flash address, D-flash data, E-0 or A19
0965 @CFD3   7C               LD   A,H   
0966 @CFD4   E6 C0            AND   $c0   
0968 @CFD6   07               RLCA      
0969 @CFD7   07               RLCA      
096A @CFD8   B3               OR   E   ; chip select ($20) and register relocation ($80) info
096B @CFD9   D9               EXX      
096C @CFDA   2A D9 09         LD   hl,(REGISTER_LOCATION)   
096F @CFDD   77               LD   (hl),a   
0970 @CFDE   D9               EXX      
0971 @CFDF   3E C0            LD   a,$C0   
0973 @CFE1   B4               OR   h   
0974 @CFE2   67               LD   h,a   
0975 @CFE3   72               LD   (hl),d   
0976 @CFE4   C9               RET      
0977 @CFE5          F_SET_PAGES_NOREGREL:      ; HL-flash address, D-flash data, E-0 or A19
0977 @CFE5   7C               LD   A,H   
0978 @CFE6   E6 C0            AND   $c0   
097A @CFE8   07               RLCA      
097B @CFE9   07               RLCA      
097C @CFEA   B3               OR   E   
097D @CFEB   32 02 C0         LD   (register_disable_reset),a   
0980 @CFEE   3E C0            LD   a,$c0   
0982 @CFF0   B4               OR   h   
0983 @CFF1   67               LD   h,a   
0984 @CFF2   72               LD   (hl),d   
0985 @CFF3   C9               RET      
0986 @CFF4                       ; input B as sector to be erased. loses everything (HL, DE, A is used, BC preserved)
0986 @CFF4          INIT_SST_ARBITRARY_SECTOR_ERASE:      
0986 @CFF4   78               LD   a,b   
0987 @CFF5   E6 80            AND   10000000b   
0989 @CFF7   0F               RRCA      ; shift to right to get the CHIP-SELECT bit
098A @CFF8   0F               RRCA      
098B @CFF9   5F               LD   e,a   ; load it into E, which Chip#
098C @CFFA   21 55 55         LD   hl,$5555   
098F @CFFD   16 AA            LD   d,$AA   
0991 @CFFF   CD 77 09         CALL   F_SET_PAGES_NOREGREL   
0994 @D002   21 AA 2A         LD   hl,$2AAA   
0997 @D005   16 55            LD   d,$55   
0999 @D007   CD 77 09         CALL   F_SET_PAGES_NOREGREL   
099C @D00A   21 55 55         LD   hl,$5555   
099F @D00D   16 80            LD   d,$80   
09A1 @D00F   CD 77 09         CALL   F_SET_PAGES_NOREGREL   
09A4 @D012   21 55 55         LD   hl,$5555   
09A7 @D015   16 AA            LD   d,$AA   
09A9 @D017   CD 77 09         CALL   F_SET_PAGES_NOREGREL   
09AC @D01A   21 AA 2A         LD   hl,$2AAA   
09AF @D01D   16 55            LD   d,$55   
09B1 @D01F   CD 77 09         CALL   F_SET_PAGES_NOREGREL   
09B4 @D022   21 00 00         LD   hl,$0000   
09B7 @D025   78               LD   a,b   
09B8 @D026   CB 3F            SRL   a   
09BA @D028   CB 1C            RR   h   
09BC @D02A   CB 3F            SRL   a   
09BE @D02C   CB 1C            RR   h   ; bit 6-7 contains the A12-A13
09C0 @D02E   CB 3C            SRL   h   
09C2 @D030   CB 3C            SRL   h   ; bit 4-5 (upper nibble) contains A12-A13 of SST chip
09C4 @D032   32 02 C0         LD   (register_disable_reset),a   ; proper bank selected on proper chip
09C7 @D035   11 75 C0         LD   de,$c075   ; make sure no $C000 is written or read, for
09CA @D038                       ; the SST chip only A18-A12 is relevant
09CA @D038   19               ADD   hl,de   
09CB @D039   36 30            LD   (hl),$30   
09CD @D03B          L_SST_FINISH_ARBITRARY_SECTORY_CLEAR_LOOP:      
09CD @D03B   7E               LD   a,(hl)   
09CE @D03C   E6 80            AND   $80   
09D0 @D03E   28 FB            JR   z,L_SST_FINISH_ARBITRARY_SECTORY_CLEAR_LOOP   
09D2 @D040   AF               XOR   a   
09D3 @D041   32 00 C0         LD   (REGISTER),a   
09D6 @D044   C9               RET      
09D7 @D045          A19_STORE:      
09D7 @D045   00               DB   0   
09D8 @D046          REGISTER_STORE:      
09D8 @D046   00               DB   0   
09D9 @D047          REGISTER_LOCATION:      
09D9 @D047   00 00            DW   0   
09DB @D049                       ; Input B as the sector to be written out
09DB @D049          SST_WRITE_ONE_SECTOR:      
09DB @D049   21 00 C0         LD   hl,register   
09DE @D04C   22 D9 09         LD   (register_location),hl   ; default register location is $C000
09E1 @D04F   78               LD   a,b   ; from the mapped-in sector number let's calculate bank -> register_store
09E2 @D050   CB 3F            SRL   a   
09E4 @D052   CB 3F            SRL   a   
09E6 @D054   32 D8 09         LD   (REGISTER_STORE),a   
09E9 @D057   E6 20            AND   A19   ; calculate which chip -> A19 store
09EB @D059   32 D7 09         LD   (A19_STORE),a   
09EE @D05C   78               LD   a,b   ; calculate TVC address from sector
09EF @D05D   E6 03            AND   3   ; 4k selector
09F1 @D05F   C6 0C            ADD   a,$0c   ; in TVC it starts at $C000
09F3 @D061   07               RLCA      ; lower nibble to upper nibble
09F4 @D062   07               RLCA      
09F5 @D063   07               RLCA      
09F6 @D064   07               RLCA      
09F7 @D065   67               LD   h,a   
09F8 @D066   AF               XOR   a   
09F9 @D067   6F               LD   l,a   ; HL contains the target sector in TVC
09FA @D068   3E C0            LD   a,$c0   
09FC @D06A   BC               CP   h   
09FD @D06B   20 1A            JR   nz,L_SST_WRITE_REGISTER_PLACED_WELL   
09FF @D06D   3A D8 09         LD   a,(REGISTER_STORE)   
0A02 @D070   F6 80            OR   REGREL   ; $80
0A04 @D072   32 D8 09         LD   (REGISTER_STORE),a   
0A07 @D075   32 00 C0         LD   (REGISTER),a   ; move register right now!
0A0A @D078   3A D7 09         LD   a,(A19_STORE)   
0A0D @D07B   F6 80            OR   REGREL   ; $80
0A0F @D07D   32 D7 09         LD   (A19_STORE),a   ; A19_STORE contains regrel flag
0A12 @D080   11 00 E0         LD   de,register_reloc   
0A15 @D083   ED 53 D9 09      LD   (REGISTER_LOCATION),de   
0A19 @D087          L_SST_WRITE_REGISTER_PLACED_WELL:      
0A19 @D087   01 00 10         LD   bc,$1000   ; number of bytes to store _AND_ data offset to BAM
0A1C @D08A   EB               EX   de,hl   ; DE now contains target address in TVC
0A1D @D08B   2A C5 08         LD   hl,(BAM_IN_TVC_RAM)   
0A20 @D08E   09               ADD   hl,bc   ; HL now contains source address in TVC
0A21 @D08F          L_SST_WRITE_ONE_SECTOR_LOOP:      
0A21 @D08F   E5               PUSH   hl   
0A22 @D090   D5               PUSH   de   
0A23 @D091   3A D7 09         LD   a,(A19_STORE)   
0A26 @D094   5F               LD   e,a   
0A27 @D095   21 55 55         LD   hl,$5555   
0A2A @D098   16 AA            LD   d,$AA   
0A2C @D09A   CD 65 09         CALL   F_SET_PAGES_REG_LOC_USED   
0A2F @D09D   21 AA 2A         LD   hl,$2AAA   
0A32 @D0A0   16 55            LD   d,$55   
0A34 @D0A2   CD 65 09         CALL   F_SET_PAGES_REG_LOC_USED   
0A37 @D0A5   21 55 55         LD   hl,$5555   
0A3A @D0A8   16 A0            LD   d,$A0   
0A3C @D0AA   CD 65 09         CALL   F_SET_PAGES_REG_LOC_USED   
0A3F @D0AD   3A D8 09         LD   a,(REGISTER_STORE)   
0A42 @D0B0   2A D9 09         LD   hl,(REGISTER_LOCATION)   
0A45 @D0B3   77               LD   (hl),a   
0A46 @D0B4   D1               POP   de   
0A47 @D0B5   E1               POP   hl   
0A48 @D0B6   ED A0            LDI      
0A4A @D0B8   EA 21 0A         JP   pe,L_SST_WRITE_ONE_SECTOR_LOOP   
0A4D @D0BB   2A D9 09         LD   hl,(REGISTER_LOCATION)   
0A50 @D0BE   AF               XOR   a   
0A51 @D0BF   77               LD   (hl),a   
0A52 @D0C0   C9               RET      
0A53 @D0C1                       ; input A : the sector to be mapped in
0A53 @D0C1          SST_READ_ONE_SECTOR:      
0A53 @D0C1   26 00            LD   h,0   
0A55 @D0C3   CB 3F            SRL   a   
0A57 @D0C5   CB 1C            RR   h   
0A59 @D0C7   CB 3F            SRL   a   
0A5B @D0C9   CB 1C            RR   h   
0A5D @D0CB   32 02 C0         LD   ($c002),a   ; read on $C000-$c003 doesn't cause reset
0A60 @D0CE   CB 3C            SRL   h   
0A62 @D0D0   CB 3C            SRL   h   
0A64 @D0D2   7C               LD   a,h   
0A65 @D0D3   F6 C0            OR   $C0   
0A67 @D0D5   67               LD   h,a   
0A68 @D0D6   AF               XOR   a   
0A69 @D0D7   6F               LD   l,a   ; HL is source address in TVC
0A6A @D0D8   E5               PUSH   hl   
0A6B @D0D9   2A C5 08         LD   hl,(BAM_IN_TVC_RAM)   
0A6E @D0DC   11 00 10         LD   de,$1000   
0A71 @D0DF   19               ADD   hl,de   
0A72 @D0E0   EB               EX   de,hl   
0A73 @D0E1   E1               POP   hl   
0A74 @D0E2   01 00 10         LD   bc,$1000   
0A77 @D0E5   ED B0            LDIR      
0A79 @D0E7   AF               XOR   a   
0A7A @D0E8   32 00 C0         LD   (register),a   
0A7D @D0EB   C9               RET      
0A7E @D0EC                    .DEPHASE      
D0EC                CART_COPY_PROG_TVC_END:      
D0EC                             ; (MAPPED_IN_SECTOR) contains the sector to be mapped out
D0EC                MAP_OUT_SECTOR:      
D0EC   C5                     PUSH   bc   
D0ED   E5                     PUSH   hl   
D0EE   0E 65                  LD   c,"e"   
D0F0   F7                     RST   30h   
D0F1   21                     DB   21h   
D0F2   F3                     DI      
D0F3   3A C7 08               LD   a,(MAPPED_IN_SECTOR)   
D0F6   47                     LD   b,a   
D0F7   CD 86 09               CALL   INIT_SST_ARBITRARY_SECTOR_ERASE   
D0FA   0E 13                  LD   c,$13   
D0FC   F7                     RST   30h   
D0FD   21                     DB   21h   
D0FE   0E 45                  LD   c,"E"   
D100   F7                     RST   30h   
D101   21                     DB   21h   
D102   0E 77                  LD   c,"w"   
D104   F7                     RST   30h   
D105   21                     DB   21h   
D106   F3                     DI      
D107   3A C7 08               LD   a,(MAPPED_IN_SECTOR)   
D10A   47                     LD   b,a   
D10B   CD DB 09               CALL   SST_WRITE_ONE_SECTOR   
D10E   E1                     POP   hl   
D10F   C1                     POP   bc   
D110   C9                     RET      
D111                             ; input A contains the sector to be mapped in
D111                MAP_IN_SECTOR:      
D111   F5                     PUSH   af   
D112   0E 72                  LD   c,"r"   
D114   F7                     RST   30h   
D115   21                     DB   21h   
D116   F3                     DI      
D117   F1                     POP   af   
D118   CD 53 0A               CALL   SST_READ_ONE_SECTOR   
D11B   C9                     RET      
D11C                ALLOCATE_BLOCK:      
D11C   F5                     PUSH   af   ; in A e.g: 00001000b
D11D   B6                     OR   (hl)   
D11E   77                     LD   (hl),a   
D11F   3A C7 08               LD   a,(MAPPED_IN_SECTOR)   
D122   B7                     OR   a   ; can't be, in the 0th bank there is the cart SW!
D123   CC C5 D1               CALL   z,CREATE_DIRECTORY_ENTRY   ; this is the first round!
D126   C4 8E D1               CALL   nz,WRITE_PREV_SECTOR_HEADER   
D129   CD A2 D1               CALL   MAP_SECTOR   
D12C   CD 40 D1               CALL   COPY_PROGRAM_BLOCK_TO_TVC_RAM   
D12F   ED 43 C8 08            LD   (PREV_BANK_BLOCK),bc   
D133   CD 39 D1               CALL   CHECK_FINISH_SST_PROGRAM_COPY_TVC_RAM   
D136   D1                     POP   de   ; flags must not be changed!
D137   7A                     LD   a,d   
D138   C9                     RET      
D139                CHECK_FINISH_SST_PROGRAM_COPY_TVC_RAM:      
D139   ED 5B C3 08            LD   de,(PROGRAM_SIZE_TO_SAVE)   
D13D   7A                     LD   a,d   
D13E   B3                     OR   e   ; is remaining program size ZERO? -> Z flag set
D13F   C9                     RET      
D140                COPY_PROGRAM_BLOCK_TO_TVC_RAM:      
D140   C5                     PUSH   bc   
D141   E5                     PUSH   hl   
D142   C5                     PUSH   bc   
D143   0E 2E                  LD   c,"."   
D145   F7                     RST   30h   
D146   21                     DB   $21   
D147   F3                     DI      
D148   C1                     POP   bc   
D149   3A C6 08               LD   a,(BAM_IN_TVC_RAM+1)   ; BAM's sector
D14C   C6 10                  ADD   a,$10   
D14E   57                     LD   d,a   
D14F   79                     LD   a,c   
D150   E6 0F                  AND   $0F   
D152   82                     ADD   a,d   
D153   67                     LD   h,a   
D154   AF                     XOR   a   
D155   6F                     LD   l,a   
D156   23                     INC   hl   
D157   23                     INC   hl   
D158   ED 5B CC 08            LD   de,(PROGRAM_POS)   
D15C   D5                     PUSH   de   ; source
D15D   E5                     PUSH   hl   ; target
D15E   2A C3 08               LD   hl,(PROGRAM_SIZE_TO_SAVE)   
D161   11 FE 00               LD   de,254   
D164   AF                     XOR   a   
D165   ED 52                  SBC   hl,de   
D167   28 02                  JR   z,L_SST_BLOCK_COPY_LAST_BLOCK   
D169   30 13                  JR   nc,L_SST_BLOCK_COPY_NORMAL_BLOCK   
D16B                L_SST_BLOCK_COPY_LAST_BLOCK:      ; if exactly 254 or less than 254 bytes to store
D16B   ED 4B C3 08            LD   bc,(PROGRAM_SIZE_TO_SAVE)   
D16F   32 C3 08               LD   (PROGRAM_SIZE_TO_SAVE),a   
D172   32 C4 08               LD   (PROGRAM_SIZE_TO_SAVE+1),a   
D175   E1                     POP   hl   
D176   E5                     PUSH   hl   
D177   2B                     DEC   hl   
D178   71                     LD   (hl),c   ; store the valid bytes in the last block (b is 0)
D179   2B                     DEC   hl   
D17A   3D                     DEC   a   ; store $FF in the block's first byte (last block!)
D17B   77                     LD   (hl),a   
D17C   18 06                  JR   L_SST_COPY_BLOCK   
D17E                L_SST_BLOCK_COPY_NORMAL_BLOCK:      
D17E   01 FE 00               LD   bc,254   
D181   22 C3 08               LD   (PROGRAM_SIZE_TO_SAVE),hl   
D184                L_SST_COPY_BLOCK:      
D184   D1                     POP   de   ; target
D185   E1                     POP   hl   ; source (switched registers!)
D186   ED B0                  LDIR      
D188   22 CC 08               LD   (PROGRAM_POS),hl   
D18B   E1                     POP   hl   
D18C   C1                     POP   bc   
D18D   C9                     RET      
D18E                WRITE_PREV_SECTOR_HEADER:      
D18E   E5                     PUSH   hl   
D18F   3A C8 08               LD   a,(PREV_BANK_BLOCK)   ; block into a
D192   E6 0F                  AND   00001111b   ; Limiting to the 4k sector which is mapped in
D194   2A C5 08               LD   hl,(BAM_IN_TVC_RAM)   ; BAM sector copy address in TVC RAM
D197   84                     ADD   a,h   
D198   C6 10                  ADD   a,$10   
D19A   67                     LD   h,a   
D19B   AF                     XOR   a   
D19C   6F                     LD   l,a   
D19D   70                     LD   (hl),b   
D19E   23                     INC   hl   
D19F   71                     LD   (hl),c   
D1A0   E1                     POP   hl   
D1A1   C9                     RET      
D1A2                MAP_SECTOR:      
D1A2   E5                     PUSH   hl   ; pointer to the allocating byte in BAM
D1A3   C5                     PUSH   bc   ; current bank and block
D1A4   3A C7 08               LD   a,(MAPPED_IN_SECTOR)   ; what sector is mapped in
D1A7   CB 21                  SLA   c   ; calculate what sector should be mapped in
D1A9   CB 21                  SLA   c   
D1AB   CB 21                  SLA   c   
D1AD   CB 10                  RL   b   
D1AF   CB 21                  SLA   c   
D1B1   CB 10                  RL   b   ; b contains the new sector number
D1B3   B8                     CP   b   
D1B4   28 0C                  JR   z,L_MAP_FINISHED   ; same, done
D1B6   FE 00                  CP   0   
D1B8   C4 EC D0               CALL   nz,MAP_OUT_SECTOR   
D1BB   78                     LD   a,b   
D1BC   32 C7 08               LD   (MAPPED_IN_SECTOR),a   
D1BF   CD 11 D1               CALL   MAP_IN_SECTOR   
D1C2                L_MAP_FINISHED:      
D1C2   C1                     POP   bc   
D1C3   E1                     POP   hl   
D1C4   C9                     RET      
D1C5                CREATE_DIRECTORY_ENTRY:      
D1C5   C5                     PUSH   bc   
D1C6   E5                     PUSH   hl   
D1C7   C5                     PUSH   bc   
D1C8   0E 64                  LD   c,"d"   
D1CA   F7                     RST   30h   
D1CB   21                     DB   21h   
D1CC   F3                     DI      
D1CD   C1                     POP   bc   
D1CE   21 00 F0               LD   hl,BAM_START   
D1D1   16 F0                  LD   d,>BAM_START & $F0   
D1D3   AF                     XOR   a   
D1D4   5F                     LD   e,a   
D1D5   ED 52                  SBC   hl,de   
D1D7   EB                     EX   de,hl   
D1D8   2A C5 08               LD   hl,(BAM_IN_TVC_RAM)   
D1DB   19                     ADD   hl,de   
D1DC   11 00 02               LD   de,$200   
D1DF   19                     ADD   hl,de   
D1E0   11 14 00               LD   de,$14   
D1E3                L_CHECK_ENTRY_TYPE:      
D1E3   19                     ADD   hl,de   
D1E4   7E                     LD   a,(hl)   
D1E5   B7                     OR   a   
D1E6   20 FB                  JR   nz,L_CHECK_ENTRY_TYPE   
D1E8   3E 03                  LD   a,3   ; CAS TYPE
D1EA   77                     LD   (hl),a   
D1EB   23                     INC   hl   
D1EC   70                     LD   (hl),b   ; bank
D1ED   23                     INC   hl   
D1EE   71                     LD   (hl),c   ; block
D1EF   23                     INC   hl   
D1F0   E5                     PUSH   hl   
D1F1   2A C3 08               LD   hl,(PROGRAM_SIZE_TO_SAVE)   
D1F4   06 00                  LD   b,0   
D1F6   11 FE 00               LD   de,254   
D1F9                L_CALC_BLOCKS_LOOP:      
D1F9   04                     INC   b   
D1FA   AF                     XOR   a   
D1FB   ED 52                  SBC   hl,de   
D1FD   30 FA                  JR   nc,L_CALC_BLOCKS_LOOP   
D1FF   E1                     POP   hl   
D200   70                     LD   (hl),b   
D201   23                     INC   hl   
D202   EB                     EX   de,hl   
D203   21 CE 08               LD   hl,EXT0_TEMP_STR   
D206   01 10 00               LD   bc,16   
D209   ED B0                  LDIR      
D20B   EB                     EX   de,hl   
D20C   77                     LD   (hl),a   
D20D   0E 13                  LD   c,$13   ; CRSR to left
D20F   F7                     RST   30h   
D210   21                     DB   21h   
D211   0E 44                  LD   c,"D"   
D213   F7                     RST   30h   
D214   21                     DB   21h   
D215   F3                     DI      
D216   E1                     POP   hl   
D217   C1                     POP   bc   
D218   AF                     XOR   a   ; set Z
D219   C9                     RET      
D21A                COPY_BAM_TO_TVC_RAM:      
D21A   0E 52                  LD   c,"R"   
D21C   F7                     RST   30h   
D21D   21                     DB   21h   
D21E   F3                     DI      
D21F   ED 5B C5 08            LD   de,(BAM_IN_TVC_RAM)   
D223   AF                     XOR   a   
D224   6F                     LD   l,a   
D225   26 F0                  LD   h,>BAM_START  & $f0   ; (upper byte of BAM_START and $F0)
D227   01 00 10               LD   bc,$1000   ; 4kB
D22A   ED B0                  LDIR      
D22C   C9                     RET      
D22D                COPY_BAM_TO_CART_RAM:      
D22D   21 3C D2               LD   hl,CART_BAM_TO_CART_RAM   
D230   01 29 00               LD   bc,CART_BAM_TO_CART_RAM_END-CART_BAM_TO_CART_RAM   
D233   11 DE 08               LD   de,EXT0_BASE_END   
D236   ED B0                  LDIR      
D238   CD DE 08               CALL   EXT0_BASE_END   
D23B   C9                     RET      
D23C                CART_BAM_TO_CART_RAM:      
D23C                          .PHASE   EXT0_BASE_END   
08DE @D23C   3E 80            LD   a,REGREL   
08E0 @D23E   32 00 C0         LD   (register),a   
08E3 @D241   01 FF 10         LD   bc,$10FF   ; fast end-checking, it loops for $1000
08E6 @D244   21 00 F0         LD   hl,BAM_START   
08E9 @D247   11 00 C0         LD   de,$C000   
08EC @D24A   3E C0            LD   a,RAM+REGREL   
08EE @D24C   08               EX   af,af'   
08EF @D24D          BAM_TO_TVC_RAM_COPY_LOOP:      
08EF @D24D   7E               LD   a,(hl)   
08F0 @D24E   08               EX   af,af'   
08F1 @D24F   32 00 E0         LD   (register_reloc),a   
08F4 @D252   08               EX   af,af'   
08F5 @D253   12               LD   (de),a   
08F6 @D254   3E 80            LD   a,REGREL   
08F8 @D256   32 00 E0         LD   (register_reloc),a   
08FB @D259   23               INC   hl   
08FC @D25A   13               INC   de   
08FD @D25B   0B               DEC   bc   
08FE @D25C   B8               CP   b   
08FF @D25D   20 EE            JR   nz,BAM_TO_TVC_RAM_COPY_LOOP   
0901 @D25F   08               EX   af,af'   
0902 @D260   AF               XOR   A   
0903 @D261   32 00 E0         LD   (REGISTER_RELOC),a   
0906 @D264   C9               RET      
0907 @D265                    .DEPHASE      
D265                CART_BAM_TO_CART_RAM_END:      
D265                CALCULATE_USABLE_8K:      
D265   2A 22 17               LD   hl,($1722)   
D268   ED 5B C3 08            LD   de,(PROGRAM_SIZE_TO_SAVE)   
D26C   19                     ADD   hl,de   
D26D   3E 5F                  LD   a,$5f   
D26F   BC                     CP   h   
D270   30 20                  JR   nc,L_CALC_USABLE_8K_DONE   
D272   3A 00 80               LD   a,($8000)   
D275   4F                     LD   c,a   
D276   3E 55                  LD   a,01010101b   
D278   32 00 80               LD   ($8000),a   
D27B   3A 00 80               LD   a,($8000)   
D27E   FE 55                  CP   01010101b   
D280   20 09                  JR   nz,L_CHECK_CART_RAM   
D282   4F                     LD   c,a   
D283   32 00 80               LD   ($8000),a   
D286   3E 9F                  LD   a,$9F   
D288   BC                     CP   h   
D289   30 07                  JR   nc,L_CALC_USABLE_8K_DONE   
D28B                L_CHECK_CART_RAM:      
D28B   3A 8A 08               LD   a,(SIZE_OF_CART_RAM)   
D28E   FE 00                  CP   $00   
D290   C8                     RET   z   
D291   AF                     XOR   a   
D292                L_CALC_USABLE_8K_DONE:      
D292   3C                     INC   a   
D293   67                     LD   h,a   
D294   2E 00                  LD   l,0   
D296   C9                     RET      
D297                CHECK_BASIC_PROGRAM_SIZE:      
D297   CD DF D2               CALL   check_if_basic_program_fit   
D29A   F5                     PUSH   af   
D29B   21 B3 D5               LD   hl,STR_EXT0_SIZE_TO_SAVE   ; print program size to save
D29E   CD C9 D2               CALL   PRINT_CSTRING   
D2A1   2A C3 08               LD   hl,(PROGRAM_SIZE_TO_SAVE)   
D2A4   CD 90 C4               CALL   F_PRINT_HEX_NUMBER   
D2A7   21 C4 D5               LD   hl,STR_EXT0_BYTES   
D2AA   CD C9 D2               CALL   PRINT_CSTRING   
D2AD   F1                     POP   af   
D2AE   FE 00                  CP   $00   
D2B0   C8                     RET   z   
D2B1   FE 01                  CP   $01   
D2B3   28 04                  JR   z,L_NO_SPACE_ON_BAM   
D2B5   FE 02                  CP   $02   
D2B7   28 08                  JR   z,L_ZERO_FILE   
D2B9                L_NO_SPACE_ON_BAM:      
D2B9   21 CA D4               LD   hl,STR_EXT0_NOT_ENOUGH_SPACE   
D2BC   CD C9 D2               CALL   PRINT_CSTRING   
D2BF   E1                     POP   hl   ; exit to 2 level up
D2C0   C9                     RET      
D2C1                L_ZERO_FILE:      
D2C1   21 ED D4               LD   hl,STR_EXT0_ZERO_COPY   
D2C4   CD C9 D2               CALL   PRINT_CSTRING   
D2C7   E1                     POP   hl   ; exit to 2 level up
D2C8   C9                     RET      
D2C9                PRINT_CSTRING:      
D2C9   01 00 00               LD   bc,0   
D2CC   11 DE 08               LD   de,EXT0_BASE_END   
D2CF   AF                     XOR   a   
D2D0                L_PC_LOOP:      
D2D0   BE                     CP   (hl)   
D2D1   28 06                  JR   z,L_PC_COPY_DONE   
D2D3   ED A0                  LDI      
D2D5   03                     INC   bc   
D2D6   03                     INC   bc   
D2D7   18 F7                  JR   L_PC_LOOP   
D2D9                L_PC_COPY_DONE:      
D2D9   11 DE 08               LD   de,EXT0_BASE_END   
D2DC   F7                     RST   30h   
D2DD   22                     DB   $22   
D2DE   C9                     RET      
D2DF                CHECK_IF_BASIC_PROGRAM_FIT:      
D2DF   CD 14 D3               CALL   CALC_PROGRAM_END_POS   
D2E2   E5                     PUSH   hl   
D2E3   2A 22 17               LD   hl,($1722)   
D2E6   EB                     EX   de,hl   
D2E7   E1                     POP   hl   
D2E8   AF                     XOR   a   
D2E9   ED 52                  SBC   hl,de   ; HL contains the bytes of the program
D2EB   BC                     CP   h   
D2EC   20 03                  JR   nz,L_CPS_NON_ZERO_SIZE   
D2EE   BD                     CP   l   
D2EF   28 20                  JR   z,L_CPS_ZERO_SIZE   
D2F1                L_CPS_NON_ZERO_SIZE:      
D2F1   23                     INC   hl   ; including the trailing zero
D2F2                CHECK_IF_MEMORY_AREA_FIT:      
D2F2   22 C3 08               LD   (PROGRAM_SIZE_TO_SAVE),hl   
D2F5   E5                     PUSH   hl   
D2F6   2A 8E 08               LD   hl,(FREE_BLOCKS_IN_BAMS)   
D2F9   4D                     LD   c,l   
D2FA   44                     LD   b,h   
D2FB   E1                     POP   hl   
D2FC   11 FE 00               LD   de,254   
D2FF                L_CPS_CHECK_LOOP:      
D2FF   AF                     XOR   a   
D300   ED 52                  SBC   hl,de   
D302   0B                     DEC   bc   
D303   3D                     DEC   a   
D304   B8                     CP   b   
D305   28 07                  JR   z,L_NOT_ENOUGH_SPACE   
D307   BC                     CP   h   
D308   28 02                  JR   z,L_ENOUGH_SPACE   
D30A   18 F3                  JR   L_CPS_CHECK_LOOP   
D30C                L_ENOUGH_SPACE:      
D30C   AF                     XOR   a   
D30D   C9                     RET      
D30E                L_NOT_ENOUGH_SPACE:      
D30E   3E 01                  LD   a,1   
D310   C9                     RET      
D311                L_CPS_ZERO_SIZE:      ; program to save is 0 lenghted
D311   3E 02                  LD   a,2   
D313   C9                     RET      
D314                CALC_PROGRAM_END_POS:      ; Copied from ROM, located on different places on v1.2 and v2.2
D314   21 FF FF               LD   hl,$ffff   
D317   EB                     EX   de,hl   
D318   2A 22 17               LD   hl,($1722)   
D31B   01 00 00               LD   bc,0   
D31E                CPS_LOOP:      
D31E   09                     ADD   hl,bc   
D31F   4E                     LD   c,(hl)   
D320   0C                     INC   c   
D321   0D                     DEC   c   
D322   37                     SCF      
D323   C8                     RET   z   
D324   D5                     PUSH   de   
D325   23                     INC   hl   
D326   5E                     LD   e,(hl)   
D327   23                     INC   hl   
D328   56                     LD   d,(hl)   
D329   2B                     DEC   hl   
D32A   2B                     DEC   hl   
D32B   E3                     EX   (sp),hl   
D32C   B7                     OR   a   
D32D   ED 52                  SBC   hl,de   
D32F   19                     ADD   hl,de   
D330   EB                     EX   de,hl   
D331   E1                     POP   hl   
D332   C8                     RET   z   
D333   30 E9                  JR   nc,CPS_LOOP   
D335   C9                     RET      
D336                          IF   LANG=EN   
                    STR_EXT0_MENU1_SELECTED:      
                              .CSTR   "Saving BASIC program. "   
                    STR_EXT0_MENU2_SELECTED:      
                              .CSTR   "Saving executable memory area. "   
                    STR_EXT0_FILENAME_Q:      
                              .CSTR   "Enter file name!\r\n> "   
                    STR_EXT0_Q1:      
                              DB   "What do you want to do?\r\n"   
                              DB   "1) Save BASIC program (CAS)\r\n"   
                              DB   "2) Save executable memory area with target destination incl. (BIN)\r\n"   
                              DB   "3) Save memory area (DAT)\r\n"   
                              .CSTR   "> "   
                    STR_EXT0_INTERRUPTED:      
                              .CSTR   "ESC pressed, bye!\r\n"   
                    STR_EXT0_NOT_EXPECTED:      
                              .CSTR   "Not expected, bye!\r\n"   
                    STR_EXT0_CRLF:      
                              .CSTR   "\r\n"   
                    STR_EXT0_IC_AMD:      
                              .CSTR   "AM29F0x0"   
                    STR_EXT0_IC_SST:      
                              .CSTR   "SST39SF0x0"   
                    STR_EXT0_IC_ATMEL:      
                              .CSTR   "AT29C0x0"   
                    STR_EXT0_IC_UNKNOWN:      
                              .CSTR   "Unknown IC"   
                    STR_EXT0_SUPPORTED:      
                              .CSTR   " found, checking free space...\r\n"   
                    STR_EXT0_NOT_SUPPORTED:      
                              .CSTR   " found, not supported. Bye!\r\n"   
                    STR_EXT0_NOT_ENOUGH_SPACE:      
                              .CSTR   "Not enough free space, bye!\r\n"   
                    STR_EXT0_ZERO_COPY:      
                              .CSTR   "Zero length file is not saved. Bye!\r\n"   
                    STR_EXT0_FEATURE_NOT_SUPPORTED:      
                              .CSTR   "This feature is not supported yet. Bye!\r\n"   
                    STR_EXT0_NOT_ENOUGH_RAM_TO_SAVE:      
                              .CSTR   "Not enough free RAM for this operation. Bye!\r\n"   
                    STR_EXT0_USING_CART_RAM:      
                              .CSTR   "Using CART's RAM.\r\n"   
                    STR_EXT0_USING_TVC_RAM:      
                              .CSTR   "Using TVC RAM starting at $"   
                    STR_EXT0_SIZE_TO_SAVE:      
                              .CSTR   "Size to save: $"   
                    STR_EXT0_BYTES:      
                              .CSTR   " bytes\r\n"   
D336                          ENDIF      
D336                          IF   LANG=HU   
D336                STR_EXT0_MENU1_SELECTED:      
D336   42 41 53 49 43 20 70 72 6F 67 72 61 6D 2D 6D 65 6E 74 91 73 20 6B 69 76 90 6C 61 73 7A 74 76 61 2E 20 00 .CSTR   "BASIC program-ment\u0091s kiv\u0090lasztva. "   
D359                STR_EXT0_MENU2_SELECTED:      
D359   46 75 74 74 61 74 68 61 74 93 20 6D 65 6D 93 72 69 61 2D 74 65 72 97 6C 65 74 20 6D 65 6E 74 91 73 20 6B 69 76 90 6C 61 73 7A 74 76 61 2E 20 00 .CSTR   "Futtathat\u0093 mem\u0093ria-ter\u0097let ment\u0091s kiv\u0090lasztva. "   
D389                STR_EXT0_FILENAME_Q:      
D389   82 72 64 20 62 65 20 61 20 6E 65 76 65 74 21 0D 0A 3E 20 00 .CSTR   "\u0082rd be a nevet!\r\n> "   
D39D                STR_EXT0_Q1:      
D39D   4D 69 74 20 73 7A 65 72 65 74 6E 91 6C 20 74 65 6E 6E 69 3F 0D 0A DB   "Mit szeretn\u0091l tenni?\r\n"   
D3B3   31 29 20 42 41 53 49 43 20 70 72 6F 67 72 61 6D 20 6D 65 6E 74 91 73 65 20 28 43 41 53 29 0D 0A DB   "1) BASIC program ment\u0091se (CAS)\r\n"   
D3D3   32 29 20 46 75 74 74 61 74 68 61 74 93 20 6D 65 6D 93 72 69 61 2D 74 65 72 97 6C 65 74 20 6D 65 6E 74 91 73 65 20 6B 65 7A 64 95 63 92 6D 6D 65 6C 20 28 42 49 4E 29 0D 0A DB   "2) Futtathat\u0093 mem\u0093ria-ter\u0097let ment\u0091se kezd\u0095c\u0092mmel (BIN)\r\n"   
D40C   33 29 20 41 64 61 74 74 65 72 97 6C 65 74 20 6D 65 6E 74 91 73 65 20 28 44 41 54 29 0D 0A DB   "3) Adatter\u0097let ment\u0091se (DAT)\r\n"   
D42A   3E 20 00               .CSTR   "> "   
D42D                STR_EXT0_INTERRUPTED:      
D42D   45 53 43 2D 74 20 6E 79 6F 6D 74 90 6C 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "ESC-t nyomt\u0090l, szia!\r\n"   
D444                STR_EXT0_NOT_EXPECTED:      
D444   4E 65 6D 20 76 90 72 74 20 62 65 76 69 74 65 6C 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "Nem v\u0090rt bevitel, szia!\r\n"   
D45E                STR_EXT0_CRLF:      
D45E   0D 0A 00               .CSTR   "\r\n"   
D461                STR_EXT0_IC_AMD:      
D461   41 4D 32 39 46 30 78 30 00 .CSTR   "AM29F0x0"   
D46A                STR_EXT0_IC_SST:      
D46A   53 53 54 33 39 53 46 30 78 30 00 .CSTR   "SST39SF0x0"   
D475                STR_EXT0_IC_ATMEL:      
D475   41 54 32 39 43 30 78 30 00 .CSTR   "AT29C0x0"   
D47E                STR_EXT0_IC_UNKNOWN:      
D47E   49 73 6D 65 72 65 74 6C 65 6E 00 .CSTR   "Ismeretlen"   
D489                STR_EXT0_SUPPORTED:      
D489   20 49 43 2C 20 73 7A 61 62 61 64 20 74 65 72 97 6C 65 74 20 65 6C 6C 65 6E 95 72 7A 91 73 2E 2E 2E 0D 0A 00 .CSTR   " IC, szabad ter\u0097let ellen\u0095rz\u0091s...\r\n"   
D4AD                STR_EXT0_NOT_SUPPORTED:      
D4AD   20 49 43 2C 20 6E 65 6D 20 74 90 6D 6F 67 61 74 6F 74 74 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   " IC, nem t\u0090mogatott, szia!\r\n"   
D4CA                STR_EXT0_NOT_ENOUGH_SPACE:      
D4CA   4E 69 6E 63 73 20 65 6C 65 67 20 73 7A 61 62 61 64 20 74 65 72 97 6C 65 74 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "Nincs eleg szabad ter\u0097let, szia!\r\n"   
D4ED                STR_EXT0_ZERO_COPY:      
D4ED   4E 75 6C 6C 61 20 68 6F 73 73 7A 75 20 66 69 6C 65 2D 74 20 6E 65 6D 20 6D 65 6E 74 65 6B 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "Nulla hosszu file-t nem mentek, szia!\r\n"   
D515                STR_EXT0_FEATURE_NOT_SUPPORTED:      
D515   45 7A 20 61 20 66 75 6E 6B 63 69 93 20 6D 91 67 20 6E 65 6D 20 74 90 6D 6F 67 61 74 6F 74 74 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "Ez a funkci\u0093 m\u0091g nem t\u0090mogatott, szia!\r\n"   
D53E                STR_EXT0_NOT_ENOUGH_RAM_TO_SAVE:      
D53E   45 68 68 65 7A 20 61 20 6D 98 76 65 6C 65 74 68 65 7A 20 6E 69 6E 63 73 20 65 6C 91 67 20 68 65 6C 79 2C 20 73 7A 69 61 21 0D 0A 00 .CSTR   "Ehhez a m\u0098velethez nincs el\u0091g hely, szia!\r\n"   
D56A                STR_EXT0_USING_CART_RAM:      
D56A   41 20 70 72 6F 67 72 61 6D 6D 6F 64 75 6C 20 52 41 4D 6A 90 74 20 68 61 73 7A 6E 90 6C 6F 6D 2E 0D 0A 00 .CSTR   "A programmodul RAMj\u0090t haszn\u0090lom.\r\n"   
D58D                STR_EXT0_USING_TVC_RAM:      
D58D   54 56 43 20 52 41 4D 2D 6F 74 20 68 61 73 7A 6E 90 6C 6F 6D 2C 20 69 6E 6E 65 6E 20 6B 65 7A 64 76 65 3A 20 24 00 .CSTR   "TVC RAM-ot haszn\u0090lom, innen kezdve: $"   
D5B3                STR_EXT0_SIZE_TO_SAVE:      
D5B3   4D 65 6E 74 91 73 69 20 6D 91 72 65 74 3A 20 24 00 .CSTR   "Ment\u0091si m\u0091ret: $"   
D5C4                STR_EXT0_BYTES:      
D5C4   20 62 79 74 65 0D 0A 00 .CSTR   " byte\r\n"   
D5CC                             ; á 90   é 91   í 92   ó 93   ö 94   ő 95   ú 96  ü 97  ű 98
D5CC                          ENDIF      
D5CC                          IF   LANG=ES   
                    STR_EXT0_MENU1_SELECTED:      
                              .CSTR   "Guardando programa BASIC. "   
                    STR_EXT0_MENU2_SELECTED:      
                              .CSTR   "Guardando ejecutable. "   
                    STR_EXT0_FILENAME_Q:      
                              .CSTR   "Nombre del archivo\r\n> "   
                    STR_EXT0_Q1:      
                              DB   "Que quieres hacer?\r\n"   
                              DB   "1) Guardar programa BASIC (CAS)\r\n"   
                              DB   "2) Guardar ejecutable en direccion de RAM (BIN)\r\n"   
                              DB   "3) Guardar area de la RAM (DAT)\r\n"   
                              .CSTR   "> "   
                    STR_EXT0_INTERRUPTED:      
                              .CSTR   "Has presionado ESC; saliendo!\r\n"   
                    STR_EXT0_NOT_EXPECTED:      
                              .CSTR   "Accion no permitida, saliendo!\r\n"   
                    STR_EXT0_CRLF:      
                              .CSTR   "\r\n"   
                    STR_EXT0_IC_AMD:      
                              .CSTR   "AM29F0x0"   
                    STR_EXT0_IC_SST:      
                              .CSTR   "SST39SF0x0"   
                    STR_EXT0_IC_ATMEL:      
                              .CSTR   "AT29C0x0"   
                    STR_EXT0_IC_UNKNOWN:      
                              .CSTR   "IC desconocido"   
                    STR_EXT0_SUPPORTED:      
                              .CSTR   " presente, comprobando tamano...\r\n"   
                    STR_EXT0_NOT_SUPPORTED:      
                              .CSTR   " presente, no soportado. Saliendo!\r\n"   
                    STR_EXT0_NOT_ENOUGH_SPACE:      
                              .CSTR   "No hay suficiente espacio libre. Saliendo!\r\n"   
                    STR_EXT0_ZERO_COPY:      
                              .CSTR   "Archivo vacio, no se graba. Saliendo!\r\n"   
                    STR_EXT0_FEATURE_NOT_SUPPORTED:      
                              .CSTR   "Funcionalidad no soportada aun. Saliendo!\r\n"   
                    STR_EXT0_NOT_ENOUGH_RAM_TO_SAVE:      
                              .CSTR   "No hay memoria RAM libre suficiente. Saliendo!\r\n"   
                    STR_EXT0_USING_CART_RAM:      
                              .CSTR   "Usando RAM del cartucho\r\n"   
                    STR_EXT0_USING_TVC_RAM:      
                              .CSTR   "Usando RAM del TVC, empezando en $"   
                    STR_EXT0_SIZE_TO_SAVE:      
                              .CSTR   "Se van a grabar: $"   
                    STR_EXT0_BYTES:      
                              .CSTR   " bytes\r\n"   
D5CC                          ENDIF      
D5CC                STR_EXT0_ENTER_START_ADDR:      
D5CC   50 6C 65 61 73 65 20 65 6E 74 65 72 20 74 68 65 20 73 74 61 72 74 20 61 64 64 72 65 73 73 21 20 0D 0A 3E 20 00 .CSTR   "Please enter the start address! \r\n> "   
D5F1                STR_EXT0_ENTER_LAST_ADDR:      
D5F1   50 6C 65 61 73 65 20 65 6E 74 65 72 20 74 68 65 20 6C 61 73 74 20 61 64 64 72 65 73 73 20 74 6F 20 73 61 76 65 21 20 0D 0A 3E 20 00 .CSTR   "Please enter the last address to save! \r\n> "   
D61D                             ; DIRECTORY Entry (22 bytes)
D61D                             ; 
D61D                             ; FILE NAME: 16 bytes, RPadded with space
D61D                             ; TYPE     : 1 byte
D61D                             ;              2-CART, 3-CAS, 4-BIN, 5-DAT
D61D                             ; POINTER  : 2 bytes, bank and block where the file starts
D61D                             ; SIZE     : 1 bytes, in blocks
D61D                             ; INTERNAL DATA: 2 bytes, used by the CART firmware
D61D                             ; Gets the first directory entry item and copies to the given
D61D                             ; memory area pointed by DE (22 bytes)
D61D                             ; INPUT
D61D                             ;   DE : pointer to a 22 byte area where the directory entry will be
D61D                             ;        copied
D61D                             ; OUTPUT:
D61D                             ;   flag Z
D61D                             ;      set : NOK (no file in directory)
D61D                             ;      clear: OK, structure filled
D61D                             ;   the DE pointed structure is filled with the first directory entry
D61D                GET_FIRST_DIRECTORY_ENTRY:      
D61D   3A 14 F2               LD   a,(BAM_START + $0214)   
D620   B7                     OR   a   
D621   C8                     RET   z   
D622   E5                     PUSH   hl   
D623   C5                     PUSH   bc   
D624   CD 47 D6               CALL   L_FILL_DIRECTORY_STRUCUTRE   
D627   D5                     PUSH   de   
D628   21 18 F2               LD   hl,BAM_START + $0214 + 4   
D62B   01 10 00               LD   bc,$10   
D62E   ED B0                  LDIR      
D630   21 14 F2               LD   hl,BAM_START + $0214   
D633   01 04 00               LD   bc,4   
D636   ED B0                  LDIR      
D638   D5                     PUSH   de   
D639   11 10 00               LD   de,$10   
D63C   19                     ADD   hl,de   
D63D   D1                     POP   de   
D63E   7D                     LD   a,l   
D63F   12                     LD   (de),a   
D640   13                     INC   de   
D641   7C                     LD   a,h   
D642   12                     LD   (de),a   
D643   D1                     POP   de   
D644   C1                     POP   bc   
D645   E1                     POP   hl   
D646   C9                     RET      
D647                L_FILL_DIRECTORY_STRUCUTRE:      
D647   D5                     PUSH   de   
D648   AF                     XOR   a   
D649   EB                     EX   de,hl   
D64A   06 16                  LD   b,$16   
D64C                L_FILL_STRUCTURE_LOOP:      
D64C   77                     LD   (hl),a   
D64D   23                     INC   hl   
D64E   10 FC                  DJNZ   L_FILL_STRUCTURE_LOOP   
D650   D1                     POP   de   
D651   05                     DEC   b   ; keep the Z flag clear
D652   C9                     RET      
D653                             ; Gets the next directory entry item and copies to the given
D653                             ; memory area pointed by DE (22 bytes)
D653                             ; INPUT
D653                             ;   DE : pointer to a 32 byte area where the directory entry will be
D653                             ;        copied
D653                             ; OUTPUT:
D653                             ;   flag Z
D653                             ;      set : NOK (no more file in directory)
D653                             ;      clear: OK, structure filled with next directory entry
D653                             ;   the DE pointed structure is filled with the first directory entry
D653                GET_NEXT_DIRECTORY_ENTRY:      
D653   E5                     PUSH   hl   
D654   D5                     PUSH   de   
D655   EB                     EX   de,hl   
D656   11 14 00               LD   de,$14   
D659   19                     ADD   hl,de   
D65A   5E                     LD   e,(hl)   
D65B   23                     INC   hl   
D65C   56                     LD   d,(hl)   
D65D   EB                     EX   de,hl   
D65E   7E                     LD   a,(hl)   
D65F   B7                     OR   a   
D660   28 1F                  JR   z,L_NEXT_DIR_DONE   
D662   D1                     POP   de   
D663   D5                     PUSH   de   
D664   C5                     PUSH   bc   
D665   E5                     PUSH   hl   
D666   23                     INC   hl   
D667   23                     INC   hl   
D668   23                     INC   hl   
D669   23                     INC   hl   
D66A   01 10 00               LD   bc,$10   
D66D   ED B0                  LDIR      
D66F   E1                     POP   hl   
D670   01 04 00               LD   bc,$04   
D673   ED B0                  LDIR      
D675   D5                     PUSH   de   
D676   11 10 00               LD   de,$10   
D679   19                     ADD   hl,de   
D67A   D1                     POP   de   
D67B   7D                     LD   a,l   
D67C   12                     LD   (de),a   
D67D   13                     INC   de   
D67E   7C                     LD   a,h   
D67F   12                     LD   (de),a   
D680   C1                     POP   bc   
D681                L_NEXT_DIR_DONE:      
D681   D1                     POP   de   
D682   E1                     POP   hl   
D683   C9                     RET      
D684                             ; Loads a file from TVC MultiCart v2 into TVC RAM. Caller must make sure that
D684                             ;   the $0003 shadow is set properly (U3 must be CART). During loading the
D684                             ;   target address in U0, U1 and U2 memory mapping configuration is left as it
D684                             ;   was when method was called, U3 is always RAM.
D684                             ;   File type can be CAS (0x03), BIN (0x04) and DAT (0x05).
D684                             ; Input: DE, contains a pointer to the following 21 bytes long structure:
D684                             ;   TEMP_AREA_PTR (2 bytes):
D684                             ;     pointer to a 128 byte area where a temp routine can be copied to.
D684                             ;     It must point into either one of U0,U1 or U2.
D684                             ;   DEST_ADDR (2 bytes)
D684                             ;     the destination address of the loaded program. Should not overlap with the
D684                             ;     temp routine
D684                             ;   FILE_TYPE (1 byte):
D684                             ;     file type, must match with the stored file. Must be 3 or bigger!
D684                             ;     In case of BIN (0x04) and the start addr is 0x0000 then the file will be
D684                             ;     loaded to the address defined by the first two bytes of the file itself.
D684                             ;   FILE_NAME (16 bytes)
D684                             ;     string of 16 chars, name of the file to be loaded. If a prefix is given
D684                             ;     which shorter than 16-chars then the string shall be terminated by 0x00.
D684                             ;  Output: Z flag
D684                             ;    set:   file not found
D684                             ;    clear: file is loaded
D684                LOAD_FILE_TO_TVCRAM:      
D684   C5                     PUSH   bc   
D685   E5                     PUSH   hl   
D686   D5                     PUSH   de   
D687   21 14 F2               LD   hl,BAM_START+$0200+$14   
D68A                L_COPY_FILE_LOOP:      
D68A   7E                     LD   a,(hl)   
D68B   B7                     OR   a   
D68C   28 36                  JR   z,L_NO_FILE_FOUND   
D68E   E5                     PUSH   hl   
D68F   21 04 00               LD   hl,$04   
D692   19                     ADD   hl,de   
D693   BE                     CP   (hl)   
D694   E1                     POP   hl   
D695   28 08                  JR   z,L_FILE_TYPE_MATCHES   
D697                L_FILE_DOESNT_MATCH:      
D697   D5                     PUSH   de   
D698   11 14 00               LD   de,$14   
D69B   19                     ADD   hl,de   
D69C   D1                     POP   de   
D69D   18 EB                  JR   L_COPY_FILE_LOOP   
D69F                L_FILE_TYPE_MATCHES:      
D69F   E5                     PUSH   hl   
D6A0   D5                     PUSH   de   
D6A1   11 04 00               LD   de,$04   
D6A4   19                     ADD   hl,de   
D6A5   D1                     POP   de   
D6A6   D5                     PUSH   de   
D6A7   E5                     PUSH   hl   
D6A8   21 05 00               LD   hl,$05   
D6AB   19                     ADD   hl,de   
D6AC   EB                     EX   de,hl   ; de points to name to find
D6AD   E1                     POP   hl   ; hl points to actual name
D6AE   06 10                  LD   b,$10   
D6B0                L_COPY_FILE_FILENAME_COMP_LOOP:      
D6B0   1A                     LD   a,(de)   
D6B1   B7                     OR   a   
D6B2   28 08                  JR   z,L_FILE_FOUND   
D6B4   BE                     CP   (hl)   
D6B5   20 09                  JR   nz,L_FILENAME_DOESNT_MATCH   
D6B7   13                     INC   de   
D6B8   23                     INC   hl   
D6B9   05                     DEC   b   
D6BA   20 F4                  JR   nz,L_COPY_FILE_FILENAME_COMP_LOOP   
D6BC                L_FILE_FOUND:      
D6BC   D1                     POP   de   
D6BD   E1                     POP   hl   
D6BE   18 09                  JR   L_COPY_FILE_ROUTINE   
D6C0                L_FILENAME_DOESNT_MATCH:      
D6C0   D1                     POP   de   
D6C1   E1                     POP   hl   
D6C2   18 D3                  JR   L_FILE_DOESNT_MATCH   
D6C4                L_NO_FILE_FOUND:      
D6C4   AF                     XOR   a   ; set Z
D6C5   D1                     POP   de   
D6C6   E1                     POP   hl   
D6C7   C1                     POP   bc   
D6C8   C9                     RET      
D6C9                L_COPY_FILE_ROUTINE:      
D6C9   E5                     PUSH   hl   
D6CA   D5                     PUSH   de   
D6CB   EB                     EX   de,hl   
D6CC   5E                     LD   e,(hl)   
D6CD   23                     INC   hl   
D6CE   56                     LD   d,(hl)   
D6CF   D5                     PUSH   de   
D6D0   21 E3 D6               LD   hl,COPY_FILE_TVCRAM_ROUTINE   
D6D3   01 7F 00               LD   bc,COPY_FILE_TVCRAM_ROUTINE_END - COPY_FILE_TVCRAM_ROUTINE   
D6D6   ED B0                  LDIR      
D6D8   E1                     POP   hl   ; hl contains the temp area address, the jump target
D6D9   D1                     POP   de   ; de contains the address of input data buffer
D6DA   C1                     POP   bc   ; bc contains the directory entry, temporarily
D6DB   CD E2 D6               CALL   TVCRAM_CALLER_ROUTINE   
D6DE   D1                     POP   de   
D6DF   E1                     POP   hl   
D6E0   C1                     POP   bc   
D6E1   C9                     RET      
D6E2                TVCRAM_CALLER_ROUTINE:      
D6E2   E9                     JP   (hl)   
D6E3                COPY_FILE_TVCRAM_ROUTINE:      
D6E3   EB                     EX   de,hl   
D6E4   23                     INC   hl   
D6E5   23                     INC   hl   
D6E6   5E                     LD   e,(hl)   
D6E7   23                     INC   hl   
D6E8   56                     LD   d,(hl)   ; de contains target address of file
D6E9   23                     INC   hl   
D6EA   AF                     XOR   a   
D6EB   BB                     CP   e   
D6EC   20 21                  JR   nz,L_DADDR_SET_PROPERLY   
D6EE   BA                     CP   d   
D6EF   20 1E                  JR   nz,L_DADDR_SET_PROPERLY   
D6F1   3E 04                  LD   a,$04   ; BIN
D6F3   BE                     CP   (hl)   
D6F4   20 19                  JR   nz,L_DADDR_SET_PROPERLY   
D6F6   C5                     PUSH   bc   
D6F7   E1                     POP   hl   
D6F8   23                     INC   hl   
D6F9   7E                     LD   a,(hl)   ; bank
D6FA   23                     INC   hl   
D6FB   56                     LD   d,(hl)   ; block
D6FC   32 02 C0               LD   ($C002),a   ; switch bank, no reset on read
D6FF   1E 00                  LD   e,$00   
D701   21 00 C0               LD   hl,$c000   
D704   19                     ADD   hl,de   
D705   E5                     PUSH   hl   
D706   46                     LD   b,(hl)   
D707   23                     INC   hl   
D708   4E                     LD   c,(hl)   
D709   23                     INC   hl   
D70A   5E                     LD   e,(hl)   
D70B   23                     INC   hl   
D70C   56                     LD   d,(hl)   
D70D   18 15                  JR   L_LOAD_BIN_FIRST_ENTRY   
D70F                L_DADDR_SET_PROPERLY:      
D70F   C5                     PUSH   bc   
D710   E1                     POP   hl   ; hl contains source directory entry
D711   23                     INC   hl   ; in dir entry, the byte 01/02 contains the bank/block address
D712                             ; byte 00 is type, byte 03 is size in blocks
D712                L_COPY_FILE_COPY_LOOP:      
D712   D5                     PUSH   de   
D713   7E                     LD   a,(hl)   ; bank
D714   23                     INC   hl   
D715   56                     LD   d,(hl)   ; block
D716   32 02 C0               LD   ($C002),a   ; switch bank, no reset on read
D719   1E 00                  LD   e,$00   
D71B   21 00 C0               LD   hl,$c000   
D71E   19                     ADD   hl,de   
D71F   D1                     POP   de   
D720   E5                     PUSH   hl   
D721   46                     LD   b,(hl)   
D722   23                     INC   hl   
D723   4E                     LD   c,(hl)   
D724                L_LOAD_BIN_FIRST_ENTRY:      
D724   23                     INC   hl   
D725   C5                     PUSH   bc   
D726   3E FF                  LD   a,$FF   ; last block?
D728   B8                     CP   b   
D729   28 02                  JR   z,L_COPY_FILE_BLOCKSIZE_SET   
D72B   0E FE                  LD   c,$FE   
D72D                L_COPY_FILE_BLOCKSIZE_SET:      
D72D   06 00                  LD   b,$00   
D72F   3E BE                  LD   a,$BE   ; If target is BF00 or higher..
D731   BA                     CP   d   
D732   38 0B                  JR   c,L_COPY_UNDER_U3   
D734   ED B0                  LDIR      
D736   C1                     POP   bc   
D737   3E FF                  LD   a,$FF   
D739   B8                     CP   b   
D73A   E1                     POP   hl   
D73B   20 D5                  JR   nz,L_COPY_FILE_COPY_LOOP   
D73D   18 1D                  JR   L_COPY_FILE_DONE   
D73F                L_COPY_UNDER_U3:      
D73F   41                     LD   b,c   
D740                L_COPY_U3_LOOP:      
D740   4E                     LD   c,(hl)   
D741   3A 03 00               LD   a,($0003)   
D744   E6 3F                  AND   $3F   
D746   F6 80                  OR   $80   
D748   D3 02                  OUT   ($02),a   
D74A   79                     LD   a,c   
D74B   12                     LD   (de),a   
D74C   3A 03 00               LD   a,($0003)   
D74F   D3 02                  OUT   ($02),a   
D751   23                     INC   hl   
D752   13                     INC   de   
D753   10 EB                  DJNZ   L_COPY_U3_LOOP   
D755   3E FF                  LD   a,$FF   
D757   C1                     POP   bc   
D758   B8                     CP   b   
D759   E1                     POP   hl   
D75A   20 B6                  JR   nz,L_COPY_FILE_COPY_LOOP   
D75C                L_COPY_FILE_DONE:      
D75C   AF                     XOR   a   ; reset multicart, set bank #0, reset-on-read enabled
D75D   32 00 C0               LD   ($C000),a   
D760   3D                     DEC   a   
D761   C9                     RET      
D762                COPY_FILE_TVCRAM_ROUTINE_END:      
D762                             ; Saves a file to TVC MultiCart v2 from TVC RAM. Caller must make sure that
D762                             ;   the $0003 shadow is set properly (U3 must be CART). Source U0, U1 and U2
D762                             ;   memory mapping configuration is left as it was when method was called,
D762                             ;   source U3 is always RAM.
D762                             ;   This method requires at least 16kB RAM on Multicart v2 and uses the
D762                             ;   first 12kB on the bank #0 of the cart RAM!
D762                             ; Input: DE, contains a pointer to the following structure:
D762                             ;   TEMP_AREA_PTR (2 bytes):
D762                             ;     pointer to a 256 byte area where a helper temp routing can be copied to.
D762                             ;     It must point into either one of U0,U1 or U2.
D762                             ;   SRC_ADDR (2 bytes):
D762                             ;     pointer to the start address of the program to be saved
D762                             ;   SIZE (2 bytes):
D762                             ;     size of program in bytes
D762                             ;   FILE_TYPE (1 byte)
D762                             ;     file type, see above
D762                             ;   OVERWRITE_FLAG (1 byte)
D762                             ;     0: only creates, fails if file exists
D762                             ;     1: creates or overwrites if exists
D762                             ;     2: only overwrites, fails if file doesn't exists
D762                             ;   FILE_NAME (16 bytes):
D762                             ;     null-terminated string of max 16 chars, name of the file to be saved.
D762                             ;     Filename will be RPadded with 0x20 to 16 chars long.
D762                             ;  Output: A
D762                             ;    0x00 - OK, file saved
D762                             ;    0x01 - Not enough CART RAM found
D762                             ;    0x02 - File exists and cannot be overwritten
D762                             ;    0x03 - File doesn't exist and cannot be created
D762                             ;    0x04 - Not enough free space on CART FLASH
D762                             ;    0x05 - Flash type is not supported
D762                             ;  temp addr + $fd : cached BANK
D762                             ;  temp addr + $fe : cached BLOCK
D762                ERR_OK:   EQU   $00   
D762                ERR_NOT_ENOUGH_CART_RAM:   EQU   $01   
D762                ERR_FILE_EXIST:   EQU   $02   
D762                ERR_FILE_DOESNT_EXIST:   EQU   $03   
D762                ERR_NOT_ENOUGH_FREE_SPACE:   EQU   $04   
D762                ERR_FLASH_NOT_SUPPORTED:   EQU   $05   
D762                CACHED_DIRECTORY_ENTRY:   EQU   -2   
D762                CACHED_BANK:   EQU   -4   
D762                CACHED_BLOCK:   EQU   -3   
D762                TEMP_AREA_SIZE_SAVE:   EQU   $0100   
D762                SAVE_FILE_TO_MULTICART:      
D762   C5                     PUSH   bc   
D763   E5                     PUSH   hl   
D764   D5                     PUSH   de   ; input structure address
D765   DD E1                  POP   ix   ; ix contains the input structure address
D767   D5                     PUSH   de   
D768   EB                     EX   de,hl   
D769   5E                     LD   e,(hl)   
D76A   23                     INC   hl   
D76B   56                     LD   d,(hl)   
D76C   D5                     PUSH   de   ; temporary target area
D76D   21 00 01               LD   hl,TEMP_AREA_SIZE_SAVE   
D770   19                     ADD   hl,de   
D771   E5                     PUSH   hl   
D772   FD E1                  POP   iy   ; IY contains the temp address + TEMP_AREA_SIZE_SAVE (end+1 of temp addr)
D774   21 44 D8               LD   hl,L_SAVE_CHECK_RAM   
D777   01 2E 00               LD   bc,L_SAVE_CHECK_RAM_END - L_SAVE_CHECK_RAM   
D77A   ED B0                  LDIR      
D77C   E1                     POP   hl   
D77D   E5                     PUSH   hl   ; temporary target area
D77E   CD E2 D6               CALL   TVCRAM_CALLER_ROUTINE   
D781   D1                     POP   de   ; temporary target area
D782   28 05                  JR   z,L_PROCEED_TO_FLASH_CHECK   
D784   3E 01                  LD   a,ERR_NOT_ENOUGH_CART_RAM   ; nz, RAM test failed!
D786   C3 40 D8               JP   L_SAVE_FILE_FINISHED   
D789                L_PROCEED_TO_FLASH_CHECK:      
D789   D5                     PUSH   de   ; temporary target area
D78A   21 72 D8               LD   hl,L_SAVE_CHECK_FLASH   
D78D   01 37 00               LD   bc,L_SAVE_CHECK_FLASH_END - L_SAVE_CHECK_FLASH   
D790   ED B0                  LDIR      
D792   E1                     POP   hl   
D793   E5                     PUSH   hl   ; temporary target area
D794   CD E2 D6               CALL   TVCRAM_CALLER_ROUTINE   
D797   D1                     POP   de   ; temporary target area
D798   28 05                  JR   z,L_PROCEED_TO_FILE_EXIST_CHECK   
D79A   3E 05                  LD   a,ERR_FLASH_NOT_SUPPORTED   
D79C   C3 40 D8               JP   L_SAVE_FILE_FINISHED   
D79F                L_PROCEED_TO_FILE_EXIST_CHECK:      
D79F   AF                     XOR   a   ; last two bytes of temp area shows dir entry, 0 otherwise
D7A0   FD 77 FE               LD   (IY + CACHED_DIRECTORY_ENTRY),a   
D7A3   FD 77 FF               LD   (IY + CACHED_DIRECTORY_ENTRY + 1),a   
D7A6   E1                     POP   hl   ; input structure address
D7A7   E5                     PUSH   hl   
D7A8   11 08 00               LD   de,$0008   
D7AB   19                     ADD   hl,de   
D7AC   EB                     EX   de,hl   ; DE points to the filename in input structure
D7AD   21 14 F2               LD   hl,BAM_START + $0214   
D7B0                L_FILE_SAVE_FILE_EXISTS_CHECK_LOOP:      
D7B0   D5                     PUSH   de   
D7B1   E5                     PUSH   hl   
D7B2   AF                     XOR   a   
D7B3   BE                     CP   (hl)   ; check file type. In case 0x00, end of dir entries
D7B4   28 1C                  JR   z,L_FILE_SAVE_FILE_DOESNT_EXIST   
D7B6   23                     INC   hl   
D7B7   23                     INC   hl   
D7B8   23                     INC   hl   
D7B9   23                     INC   hl   ; hl points to the file names position
D7BA   01 10 00               LD   bc,$0010   
D7BD                L_FILE_SAVE_FILE_NAME_CHECK_LOOP:      
D7BD   1A                     LD   a,(de)   
D7BE   FE 00                  CP   $00   
D7C0   28 1D                  JR   z,L_FILE_SAVE_FILE_EXISTS   
D7C2   ED A1                  CPI      
D7C4   20 04                  JR   nz,L_FILE_DONT_MATCH   
D7C6   13                     INC   de   
D7C7   E2 BD D7               JP   po,L_FILE_SAVE_FILE_NAME_CHECK_LOOP   
D7CA                L_FILE_DONT_MATCH:      
D7CA   E1                     POP   hl   
D7CB   11 14 00               LD   de,$0014   
D7CE   19                     ADD   hl,de   
D7CF   D1                     POP   de   
D7D0   18 DE                  JR   L_FILE_SAVE_FILE_EXISTS_CHECK_LOOP   
D7D2                L_FILE_SAVE_FILE_DOESNT_EXIST:      
D7D2   E1                     POP   hl   
D7D3   D1                     POP   de   
D7D4   1B                     DEC   de   ; de points to OVERWRITE_FLAG
D7D5   1A                     LD   a,(de)   
D7D6   FE 02                  CP   $02   ; only overwrite allowed?
D7D8   20 12                  JR   nz,L_FILE_SAVE_CREATE_FILE   
D7DA   3E 03                  LD   a,ERR_FILE_DOESNT_EXIST   
D7DC   C3 40 D8               JP   L_SAVE_FILE_FINISHED   
D7DF                L_FILE_SAVE_FILE_EXISTS:      
D7DF   E1                     POP   hl   
D7E0   D1                     POP   de   
D7E1   1B                     DEC   de   
D7E2   1A                     LD   a,(de)   
D7E3   FE 00                  CP   $00   ; is overwrite allowed
D7E5   20 05                  JR   nz,L_SAVE_FILE_RELEASE_FILE   
D7E7   3E 02                  LD   a,ERR_FILE_EXIST   
D7E9   C3 40 D8               JP   L_SAVE_FILE_FINISHED   
D7EC                L_SAVE_FILE_RELEASE_FILE:      
D7EC                L_FILE_SAVE_CREATE_FILE:      
D7EC                             ; let's check first the available space
D7EC   CD A9 D8               CALL   CALCULATE_AVAILABLE_SPACE   
D7EF   D1                     POP   de   
D7F0   D5                     PUSH   de   
D7F1   13                     INC   de   
D7F2   13                     INC   de   
D7F3   13                     INC   de   
D7F4   13                     INC   de   
D7F5   EB                     EX   de,hl   
D7F6   5E                     LD   e,(hl)   
D7F7   23                     INC   hl   
D7F8   56                     LD   d,(hl)   
D7F9   1B                     DEC   de   
D7FA   14                     INC   d   
D7FB   3E 00                  LD   a,$00   
D7FD   B8                     CP   b   
D7FE   20 09                  JR   nz,L_FILE_SAVE_THERE_IS_ENOUGH_SPACE   
D800   79                     LD   a,c   
D801   BA                     CP   d   
D802   30 05                  JR   nc,L_FILE_SAVE_THERE_IS_ENOUGH_SPACE   
D804   3E 04                  LD   a,ERR_NOT_ENOUGH_FREE_SPACE   
D806   C3 40 D8               JP   L_SAVE_FILE_FINISHED   
D809                L_FILE_SAVE_THERE_IS_ENOUGH_SPACE:      
D809   E1                     POP   hl   
D80A   E5                     PUSH   hl   ; hl contains the address to input structure
D80B   D5                     PUSH   de   ; d contains the size of the file in blocks
D80C   23                     INC   hl   
D80D   23                     INC   hl   
D80E   5E                     LD   e,(hl)   
D80F   23                     INC   hl   
D810   56                     LD   d,(hl)   
D811   D5                     PUSH   de   ; de contains the target address (temp area)
D812   01 89 00               LD   bc,L_CREATE_FILE_ENTRY_IN_MULTICART_RAM_END-L_CREATE_FILE_ENTRY_IN_MULTICART_RAM   
D815   21 C2 D8               LD   hl,L_CREATE_FILE_ENTRY_IN_MULTICART_RAM   
D818   ED B0                  LDIR      
D81A   E1                     POP   hl   ; hl contains the target address
D81B   D1                     POP   de   ; d contains the size of the file in blocks
D81C   E5                     PUSH   hl   
D81D   CD E2 D6               CALL   TVCRAM_CALLER_ROUTINE   
D820   D1                     POP   de   ; temp area
D821   D5                     PUSH   de   
D822   21 4B D9               LD   hl,L_CREATE_FILE_IN_MULTICART   
D825   01 25 01               LD   bc,L_CREATE_FILE_IN_MULTICART_END - L_CREATE_FILE_IN_MULTICART   
D828   ED B0                  LDIR      
D82A                             ; L_MODIFY_TARGET_1
D82A   D1                     POP   de   ; target of the temp area
D82B   D5                     PUSH   de   
D82C   2A 94 00               LD   hl,(L_STORE_SECTOR - L_CREATE_FILE_IN_MULTICART)   ; offset of store_sector
D82F   19                     ADD   hl,de   
D830   E5                     PUSH   hl   
D831   2A 52 00               LD   hl,(L_MODIFY_TARGET_1 - L_CREATE_FILE_IN_MULTICART + 1)   ; offset of modification
D834   19                     ADD   hl,de   
D835   C1                     POP   bc   
D836   71                     LD   (hl),c   
D837   23                     INC   hl   
D838   70                     LD   (hl),b   
D839   E1                     POP   hl   
D83A   CD E2 D6               CALL   TVCRAM_CALLER_ROUTINE   
D83D   18 00                  JR   L_SAVE_FILE_FINISHED_OK   
D83F                L_SAVE_FILE_OVERWRITE_FILE:      
D83F                L_SAVE_FILE_FINISHED_OK:      
D83F   AF                     XOR   a   
D840                L_SAVE_FILE_FINISHED:      
D840   D1                     POP   de   
D841   E1                     POP   hl   
D842   C1                     POP   bc   
D843   C9                     RET      
D844                L_SAVE_CHECK_RAM:      
D844   3E 40                  LD   a,RAM   
D846   32 00 C0               LD   ($C000),a   
D849   06 08                  LD   b,$08   
D84B   21 00 D0               LD   hl,$D000   
D84E   11 00 04               LD   de,$0400   
D851                L_SAVE_CHECK_RAM_LOOP:      
D851   AF                     XOR   a   
D852   77                     LD   (hl),a   
D853   BE                     CP   (hl)   
D854   20 15                  JR   nz,L_RAM_CHECK_FAILED   
D856   3E 55                  LD   a,$55   
D858   77                     LD   (hl),a   
D859   BE                     CP   (hl)   
D85A   20 0F                  JR   nz,L_RAM_CHECK_FAILED   
D85C   3E AA                  LD   a,$AA   
D85E   77                     LD   (hl),a   
D85F   BE                     CP   (hl)   
D860   20 09                  JR   nz,L_RAM_CHECK_FAILED   
D862   3E FF                  LD   a,$FF   
D864   77                     LD   (hl),a   
D865   BE                     CP   (hl)   
D866   20 03                  JR   nz,L_RAM_CHECK_FAILED   
D868   19                     ADD   hl,de   
D869   10 E6                  DJNZ   L_SAVE_CHECK_RAM_LOOP   
D86B                L_RAM_CHECK_FAILED:      
D86B   F5                     PUSH   af   ; flags must be retained!
D86C   AF                     XOR   a   
D86D   32 00 C0               LD   ($C000),a   
D870   F1                     POP   af   
D871   C9                     RET      
D872                L_SAVE_CHECK_RAM_END:      
D872                             ; SAVE supported only on SST39SF040, xx020, xx010 chips
D872                L_SAVE_CHECK_FLASH:      
D872   3E 01                  LD   a,$01   
D874   32 00 C0               LD   ($C000),a   
D877   3E AA                  LD   a,$AA   
D879   32 55 D5               LD   ($1555 + $C000),a   
D87C   AF                     XOR   a   
D87D   32 00 C0               LD   ($C000),a   
D880   3E 55                  LD   a,$55   
D882   32 AA EA               LD   ($2AAA + $C000),a   
D885   3E 01                  LD   a,$01   
D887   32 00 C0               LD   ($C000),a   
D88A   3E 90                  LD   a,$90   
D88C   32 55 D5               LD   ($1555 + $C000),a   
D88F   AF                     XOR   a   
D890   32 00 C0               LD   ($C000),a   
D893   3A 00 C0               LD   a,($C000)   
D896   47                     LD   b,a   
D897   3A 01 C0               LD   a,($C001)   
D89A   4F                     LD   c,a   
D89B   3E BF                  LD   a,$BF   
D89D   B8                     CP   b   
D89E   C0                     RET   nz   ; not SST
D89F   3E B7                  LD   a,$B7   ; 040
D8A1   B9                     CP   c   
D8A2   C8                     RET   z   
D8A3   3D                     DEC   a   ; $B6 - 020
D8A4   B9                     CP   c   
D8A5   C8                     RET   z   
D8A6   3D                     DEC   a   ; $B5 - 010
D8A7   B9                     CP   c   
D8A8   C9                     RET      
D8A9                L_SAVE_CHECK_FLASH_END:      
D8A9                CALCULATE_AVAILABLE_SPACE:      ; in BC, num of free blocks
D8A9   21 00 F0               LD   hl,BAM_START   
D8AC   11 00 00               LD   de,0   
D8AF                L_CAS_LOOP:      
D8AF   06 08                  LD   b,8   
D8B1   7E                     LD   a,(hl)   
D8B2                L_CAS_ONEBYTE_LOOP:      
D8B2   CB 47                  BIT   0,a   
D8B4   20 01                  JR   nz,L_CAS_NEXT_CYCLE   
D8B6   13                     INC   de   
D8B7                L_CAS_NEXT_CYCLE:      
D8B7   1F                     RRA      
D8B8   10 F8                  DJNZ   L_CAS_ONEBYTE_LOOP   
D8BA   23                     INC   hl   
D8BB   3E F2                  LD   a,$F2   
D8BD   20 F0                  JR   nz,L_CAS_LOOP   
D8BF   D5                     PUSH   de   
D8C0   C1                     POP   bc   
D8C1   C9                     RET      
D8C2                L_CREATE_FILE_ENTRY_IN_MULTICART_RAM:      
D8C2   D5                     PUSH   de   ; d contains the size of the file
D8C3   21 00 F0               LD   hl,BAM_START   ; copy BAM to first bank or RAM, $D000
D8C6   11 00 D0               LD   de,$D000   
D8C9   01 FF 10               LD   bc,$10ff   
D8CC   3E 40                  LD   a,RAM   
D8CE   08                     EX   af,af'   ; RAM -> A backup
D8CF                L_CREATE_BAM_COPY_LOOP:      
D8CF   7E                     LD   a,(hl)   
D8D0   08                     EX   af,af'   
D8D1   32 00 C0               LD   ($C000),a   
D8D4   08                     EX   af,af'   
D8D5   12                     LD   (de),a   
D8D6   AF                     XOR   a   
D8D7   32 00 C0               LD   ($C000),a   
D8DA   13                     INC   de   
D8DB   23                     INC   hl   
D8DC   0B                     DEC   bc   
D8DD   AF                     XOR   a   
D8DE   B8                     CP   b   
D8DF   20 EE                  JR   nz,L_CREATE_BAM_COPY_LOOP   
D8E1   21 14 D0               LD   hl,$D014   
D8E4   11 14 00               LD   de,$0014   
D8E7   3E 40                  LD   a,RAM   
D8E9   32 00 C0               LD   ($C000),a   
D8EC   AF                     XOR   a   
D8ED   C1                     POP   bc   ; b contains the size of the file
D8EE                L_CREATE_FILE_SEARCH_LAST_ENTRY_LOOP:      
D8EE   BE                     CP   (hl)   
D8EF   28 03                  JR   z,L_LAST_ENTRY_FOUND   
D8F1   19                     ADD   hl,de   
D8F2   18 FA                  JR   L_CREATE_FILE_SEARCH_LAST_ENTRY_LOOP   
D8F4                L_LAST_ENTRY_FOUND:      
D8F4   DD E5                  PUSH   ix   
D8F6   D1                     POP   de   ; pointer to the input structure
D8F7   D5                     PUSH   de   
D8F8   E5                     PUSH   hl   ; pointer to the new entry in CARTRAM
D8F9   21 06 00               LD   hl,$0006   
D8FC   19                     ADD   hl,de   ; points to filetype in input structure
D8FD   D1                     POP   de   ; pointer to the new entry
D8FE   D5                     PUSH   de   
D8FF   7E                     LD   a,(hl)   
D900   12                     LD   (de),a   
D901   13                     INC   de   
D902   13                     INC   de   
D903   13                     INC   de   
D904   EB                     EX   de,hl   
D905   70                     LD   (hl),b   ; file size
D906   23                     INC   hl   
D907   3E 20                  LD   a,$20   
D909   06 10                  LD   b,$10   
D90B                L_CREATE_FILE_FILL_FILENAME_LOOP:      
D90B   77                     LD   (hl),a   
D90C   23                     INC   hl   
D90D   10 FC                  DJNZ   L_CREATE_FILE_FILL_FILENAME_LOOP   
D90F   AF                     XOR   a   
D910   77                     LD   (hl),a   ; must store 0x00 after the last entry
D911   FD 77 FC               LD   (IY + CACHED_BANK),a   ; prevoiusly loaded bank
D914   FD 77 FD               LD   (IY + CACHED_BLOCK),a   ; prevoiusly loaded block
D917   01 00 01               LD   bc,$0100   ; b: bank, c:block
D91A   21 08 D0               LD   hl,$D008   ; start at second bank
D91D                L_SEARCH_FIRST_FREE_BLOCK_BYTE_LOOP:      
D91D   16 08                  LD   d,8   
D91F   7E                     LD   a,(hl)   
D920                L_SEARCH_FIRST_FREE_BLOCK_LOOP:      
D920   CB 47                  BIT   0,a   
D922   28 10                  JR   z,L_FIRST_EMPTY_BLOCK_FOUND   
D924   0C                     INC   c   
D925   3E 40                  LD   a,$40   
D927   B9                     CP   c   
D928   20 03                  JR   nz,L_SEARCH_FIRST_FREE_BLOCK_BANK_OK   
D92A   0E 00                  LD   c,0   
D92C   04                     INC   b   
D92D                L_SEARCH_FIRST_FREE_BLOCK_BANK_OK:      
D92D   1F                     RRA      
D92E   15                     DEC   d   
D92F   20 EF                  JR   nz,L_SEARCH_FIRST_FREE_BLOCK_LOOP   
D931   23                     INC   hl   
D932   18 E9                  JR   L_SEARCH_FIRST_FREE_BLOCK_BYTE_LOOP   
D934                L_FIRST_EMPTY_BLOCK_FOUND:      
D934   E1                     POP   hl   ; pointer to the new entry
D935   D1                     POP   de   ; pointer to the input data
D936   D5                     PUSH   de   
D937   E5                     PUSH   hl   
D938   23                     INC   hl   
D939   70                     LD   (hl),b   
D93A   23                     INC   hl   
D93B   71                     LD   (hl),c   
D93C   21 04 00               LD   hl,$0004   
D93F   19                     ADD   hl,de   ; hl points to the size of the file
D940   5E                     LD   e,(hl)   
D941   23                     INC   hl   
D942   56                     LD   d,(hl)   
D943   1B                     DEC   de   
D944   14                     INC   d   
D945   E1                     POP   hl   ; no need anymore the new file entry
D946   23                     INC   hl   
D947   23                     INC   hl   
D948   23                     INC   hl   
D949   72                     LD   (hl),d   ; size of file in occupied blocks
D94A                             ; -------------
D94A                             ; ------------- ~$80 bytes of code ------------
D94A                             ; -------------
D94A   C9                     RET      
D94B                             ; -------------
D94B                             ; -------------
D94B                L_CREATE_FILE_ENTRY_IN_MULTICART_RAM_END:      
D94B                L_CREATE_FILE_IN_MULTICART:      
D94B   01 00 01               LD   bc,$0100   ; b: bank, c:block
D94E   21 08 D0               LD   hl,$D008   ; start at second bank
D951                L_SEARCH_FREE_BLOCK_BYTE_LOOP:      
D951   16 08                  LD   d,8   
D953   7E                     LD   a,(hl)   
D954                L_SEARCH_FREE_BLOCK_LOOP:      
D954   CB 47                  BIT   0,a   
D956   28 12                  JR   z,L_EMPTY_BLOCK_FOUND   
D958                L_SEARCH_FREE_BLOCK_LOOP_CONTINUE:      
D958   0C                     INC   c   
D959   08                     EX   af,af'   
D95A   3E 40                  LD   a,$40   
D95C   B9                     CP   c   
D95D   20 03                  JR   nz,L_SEARCH_FREE_BLOCK_BANK_OK   
D95F   0E 00                  LD   c,0   
D961   04                     INC   b   
D962                L_SEARCH_FREE_BLOCK_BANK_OK:      
D962   08                     EX   af,af'   
D963   1F                     RRA      
D964   15                     DEC   d   
D965   20 ED                  JR   nz,L_SEARCH_FREE_BLOCK_LOOP   
D967   23                     INC   hl   
D968   18 E7                  JR   L_SEARCH_FREE_BLOCK_BYTE_LOOP   
D96A                L_EMPTY_BLOCK_FOUND:      
D96A   C5                     PUSH   bc   
D96B   D5                     PUSH   de   
D96C   E5                     PUSH   hl   
D96D   F5                     PUSH   af   
D96E   78                     LD   a,b   
D96F   FD BE FC               CP   (IY + CACHED_BANK)   
D972   20 24                  JR   nz,L_REFRESH_CACHE   
D974   79                     LD   a,c   
D975   E6 78                  AND   1111000b   
D977   FD 7E FD               LD   a,(IY + CACHED_BLOCK)   
D97A   20 1C                  JR   nz,L_REFRESH_CACHE   
D97C                L_CACHE_IS_FRESH:      
D97C   18 60                  JR   L_COPY_BLOCK   
D97E   F1                     POP   af   
D97F   E1                     POP   hl   
D980   D1                     POP   de   
D981   C1                     POP   bc   
D982   F5                     PUSH   af   
D983   C5                     PUSH   bc   
D984   79                     LD   a,c   
D985   E6 07                  AND   00000111b   
D987   FE 00                  CP   $00   
D989   47                     LD   b,a   
D98A   3E 01                  LD   a,1   
D98C   28 04                  JR   z,L_SHIFT_DONE   
D98E   B7                     OR   a   ; Clear C
D98F                L_SHIFT_BIT:      
D98F   17                     RLA      
D990   10 FD                  DJNZ   L_SHIFT_BIT   
D992                L_SHIFT_DONE:      
D992   B6                     OR   (hl)   
D993   77                     LD   (hl),a   
D994   F1                     POP   af   
D995   C1                     POP   bc   
D996   18 C0                  JR   L_SEARCH_FREE_BLOCK_LOOP_CONTINUE   
D998                L_REFRESH_CACHE:      
D998   AF                     XOR   a   
D999   FD BE FC               CP   (IY + CACHED_BANK)   
D99C                             ;            JR      nz,L_STORE_SECTOR
D99C                L_MODIFY_TARGET_1:      
D99C   C4 DF D9               CALL   nz,L_STORE_SECTOR   
D99F                L_REFRESH_CACHE_CONTINUE:      
D99F   78                     LD   a,b   
D9A0   32 00 C0               LD   ($C000),a   ; bank mapped
D9A3   FD 77 FC               LD   (IY + CACHED_BANK),A   
D9A6   79                     LD   a,c   
D9A7   FD 77 FD               LD   (IY + CACHED_BLOCK),A   
D9AA   E6 18                  AND   0011000b   
D9AC   3E C0                  LD   a,$C0   
D9AE   81                     ADD   a,c   
D9AF   67                     LD   h,a   
D9B0   2E 00                  LD   l,$00   ; source set
D9B2   11 00 E0               LD   de,$E000   ; target address
D9B5   79                     LD   a,c   
D9B6   01 FF 10               LD   bc,$10FF   
D9B9                L_SAVE_FILE_COPY_BANK_TO_CACHE_SECTOR_LOOP:      
D9B9   32 02 C0               LD   ($C002),a   
D9BC   08                     EX   af,af'   ; source bank in A backup
D9BD   3A 03 00               LD   a,($0003)   
D9C0   E6 3F                  AND   00111111b   
D9C2   F6 80                  OR   $80   
D9C4   D3 02                  OUT   ($02),a   
D9C6   7E                     LD   a,(hl)   
D9C7   F5                     PUSH   af   
D9C8   3A 03 00               LD   a,($0003)   
D9CB   D3 02                  OUT   ($02),a   
D9CD   3E 40                  LD   a,RAM   ; RAM 0th bank
D9CF   32 02 C0               LD   ($C002),a   
D9D2   F1                     POP   AF   
D9D3   12                     LD   (de),a   
D9D4   13                     INC   de   
D9D5   23                     INC   hl   
D9D6   0B                     DEC   bc   
D9D7   AF                     XOR   a   
D9D8   B8                     CP   b   
D9D9   08                     EX   af,af'   
D9DA   20 DD                  JR   nz,L_SAVE_FILE_COPY_BANK_TO_CACHE_SECTOR_LOOP   
D9DC   18 9E                  JR   L_CACHE_IS_FRESH   
D9DE                L_COPY_BLOCK:      
D9DE   00                     NOP      
D9DF                L_STORE_SECTOR:      
D9DF   E5                     PUSH   hl   
D9E0   D5                     PUSH   de   
D9E1   C5                     PUSH   bc   
D9E2   FD 7E FC               LD   a,(IY + CACHED_BANK)   
D9E5   47                     LD   b,a   ; bank
D9E6   FD 7E FD               LD   a,(IY + CACHED_BLOCK)   
D9E9   E6 30                  AND   00110000b   
D9EB   4F                     LD   c,a   ; C contains sector address in CHIP
D9EC                             ; sector erase
D9EC   3E 01                  LD   a,$01   ; $AA -> $5555
D9EE   32 02 C0               LD   ($C002),a   
D9F1   3E AA                  LD   a,$AA   
D9F3   32 55 D5               LD   ($C000 + $1555),a   
D9F6   AF                     XOR   a   ; $55 -> $2AAA
D9F7   32 02 C0               LD   ($C002),a   
D9FA   3E 55                  LD   a,$55   
D9FC   32 AA EA               LD   ($C000 + $2AAA),a   
D9FF   3E 01                  LD   a,$01   ; $80 -> $5555
DA01   32 02 C0               LD   ($C002),a   
DA04   3E 80                  LD   a,$80   
DA06   32 55 D5               LD   ($C000 + $1555),a   
DA09   3E AA                  LD   a,$AA   ; $AA -> $5555
DA0B   32 55 D5               LD   ($C000 + $1555),a   
DA0E   AF                     XOR   a   ; $55 -> $2AAA
DA0F   32 02 C0               LD   ($C002),a   
DA12   3E 55                  LD   a,$55   
DA14   32 AA EA               LD   ($C000 + $2AAA),a   
DA17   78                     LD   a,b   
DA18   32 02 C0               LD   ($C002),a   
DA1B   79                     LD   a,c   
DA1C   C6 C0                  ADD   a,$C0   
DA1E   67                     LD   h,a   
DA1F   2E 75                  LD   l,$75   ; to avoid writing to the Multicart register
DA21   3E 30                  LD   a,$30   
DA23                L_CREATE_FILE_ERASE_SECTOR_POLLING_LOOP:      
DA23   77                     LD   (hl),a   
DA24   CB 7F                  BIT   7,a   
DA26   28 FB                  JR   z,L_CREATE_FILE_ERASE_SECTOR_POLLING_LOOP   
DA28   3E 40                  LD   a,RAM   ; 0. bank of multicart, RAM selected
DA2A   32 02 C0               LD   ($C002),a   
DA2D   54                     LD   d,h   
DA2E   1E 00                  LD   e,0   ; target sector to write
DA30   21 00 E0               LD   hl,$E000   ; source of cached sector
DA33   79                     LD   a,c   
DA34   08                     EX   af,af'   ; a backup contains bank of multicart to write to
DA35   01 FF 10               LD   bc,$10FF   
DA38                L_STORE_FILE_SECTOR_WRITE_LOOP:      
DA38   7E                     LD   a,(hl)   
DA39   F5                     PUSH   af   
DA3A   3E 01                  LD   a,$01   ; $AA -> $5555
DA3C   32 02 C0               LD   ($C002),a   
DA3F   3E AA                  LD   a,$AA   
DA41   32 55 D5               LD   ($C000 + $1555),a   
DA44   AF                     XOR   a   ; $55 -> $2AAA
DA45   32 02 C0               LD   ($C002),a   
DA48   3E 55                  LD   a,$55   
DA4A   32 AA EA               LD   ($C000 + $2AAA),a   
DA4D   3E 01                  LD   a,$01   ; $A0 -> $5555
DA4F   32 02 C0               LD   ($C002),a   
DA52   3E A0                  LD   a,$A0   
DA54   32 55 D5               LD   ($C000 + $1555),a   
DA57   08                     EX   af,af'   
DA58   32 02 C0               LD   ($C002),a   
DA5B   08                     EX   af,af'   
DA5C   F1                     POP   af   
DA5D   12                     LD   (de),a   
DA5E   EB                     EX   de,hl   
DA5F                L_STORE_FILE_ONE_BYTE_WRITE_LOOP:      
DA5F   BE                     CP   (hl)   ; it would enough to test bit#7,
DA60   20 FD                  JR   nz,L_STORE_FILE_ONE_BYTE_WRITE_LOOP   
DA62   EB                     EX   de,hl   
DA63   13                     INC   de   ; 6T
DA64   23                     INC   hl   ; 6T
DA65   0B                     DEC   bc   ; 6T
DA66   AF                     XOR   a   ; 4T
DA67   B8                     CP   b   ; 4T
DA68   20 CE                  JR   nz,L_STORE_FILE_SECTOR_WRITE_LOOP   ; 12T
DA6A                             ; done writing back cache!
DA6A   C1                     POP   bc   
DA6B   D1                     POP   de   
DA6C   E1                     POP   hl   
DA6D   C3 9F D9               JP   L_REFRESH_CACHE_CONTINUE   
DA70                L_CREATE_FILE_IN_MULTICART_END:      
DA70                CODE_IN_CART:      
DA70                          .PHASE   reloc   
3000 @DA70          ROM_CHECK_START:      
3000 @DA70          F_CHECK_ROM_IDS:      
3000 @DA70   1E 00            LD   E,0   
3002 @DA72   CD 7C 30         CALL   F_READ_ID   
3005 @DA75   78               LD   a,b   
3006 @DA76   32 92 08         LD   (FLASH1_MAN),a   
3009 @DA79   79               LD   a,c   
300A @DA7A   32 93 08         LD   (FLASH1_CHIP),a   
300D @DA7D   CD 4D 30         CALL   get_size_of_chip   
3010 @DA80   32 88 08         LD   (SIZE_OF_FLASH1),a   
3013 @DA83   3A 4C 30         LD   a,(MANUFACTURER_CHECK_CNT)   
3016 @DA86   32 90 08         LD   (FLASH1_TYPE),a   
3019 @DA89   1E 20            LD   E,A19   
301B @DA8B   CD 7C 30         CALL   F_READ_ID   
301E @DA8E   78               LD   a,b   
301F @DA8F   32 94 08         LD   (FLASH2_MAN),a   
3022 @DA92   79               LD   a,c   
3023 @DA93   32 95 08         LD   (FLASH2_CHIP),a   
3026 @DA96   CD 4D 30         CALL   get_size_of_chip   
3029 @DA99   32 89 08         LD   (SIZE_OF_FLASH2),a   
302C @DA9C   3A 4C 30         LD   a,(MANUFACTURER_CHECK_CNT)   
302F @DA9F   32 91 08         LD   (FLASH2_TYPE),a   
3032 @DAA2   C9               RET      
3033 @DAA3                       ; Size DATA
3033 @DAA3                       ; 01h - AMD, BFh - SST; 1Fh - Atmel
3033 @DAA3                       ; 20H - AM29F010
3033 @DAA3                       ; A4H - AM29F040
3033 @DAA3                       ; B5H - SST39SF010A
3033 @DAA3                       ; B6H - SST39SF020A
3033 @DAA3                       ; B7H - SST39SF040
3033 @DAA3                       ; D5H - AT29C010
3033 @DAA3                       ; DAH - AT29C020
3033 @DAA3                       ; A4H - AT29C040
3033 @DAA3                       ; type data
3033 @DAA3                       ; 0 - not found
3033 @DAA3                       ; 1 - AMD
3033 @DAA3                       ; 2 - SST
3033 @DAA3                       ; 3 - Atmel
3033 @DAA3          CHIP_DATA_BLOCK:      
3033 @DAA3                       ; list of 8 bytes or $FF (end of list)
3033 @DAA3                       ; byte1: manufacturer
3033 @DAA3                       ; byte2: dummy
3033 @DAA3                       ; byte3-4, byte 5-6, byte7-8:
3033 @DAA3                       ;   chip id-chip size: 1(128),2(256),4(512)
3033 @DAA3                       ; AMD
3033 @DAA3   01 00 20 01 A4 04 00 00 DB   $01,$00,$20,$01,$A4,$04,$00,$00   
303B @DAAB                       ; SST
303B @DAAB   BF 00 B5 01 B6 02 B7 04 DB   $BF,$00,$B5,$01,$B6,$02,$B7,$04   
3043 @DAB3                       ; ATmel
3043 @DAB3   1F 00 D5 01 DA 02 A4 04 DB   $1F,$00,$D5,$01,$DA,$02,$A4,$04   
304B @DABB   FF               DB   $FF   
304C @DABC          MANUFACTURER_CHECK_CNT:      
304C @DABC   00               DB   00   
304D @DABD          GET_SIZE_OF_CHIP:      
304D @DABD   AF               XOR   a   
304E @DABE   32 4C 30         LD   (MANUFACTURER_CHECK_CNT),a   
3051 @DAC1   21 33 30         LD   hl,CHIP_DATA_BLOCK   
3054 @DAC4          CHIP_SIZE_LOOP:      
3054 @DAC4   7E               LD   a,(hl)   
3055 @DAC5   FE FF            CP   $FF   
3057 @DAC7   28 1E            JR   z,CHIP_ID_NOT_FOUND   
3059 @DAC9   E5               PUSH   hl   
305A @DACA   21 4C 30         LD   hl,MANUFACTURER_CHECK_CNT   
305D @DACD   34               INC   (hl)   
305E @DACE   E1               POP   hl   
305F @DACF   B8               CP   b   
3060 @DAD0   20 0F            JR   nz,NEXT_MANUFACTURER   
3062 @DAD2   06 03            LD   b,3   ; at most 3 checks possible
3064 @DAD4          CHIP_ID_LOOP:      
3064 @DAD4   23               INC   hl   
3065 @DAD5   23               INC   hl   
3066 @DAD6   7E               LD   a,(hl)   
3067 @DAD7   B9               CP   c   
3068 @DAD8   28 04            JR   z,CHIP_FOUND   
306A @DADA   10 F8            DJNZ   CHIP_ID_LOOP   
306C @DADC   18 09            JR   CHIP_ID_NOT_FOUND   
306E @DADE          CHIP_FOUND:      
306E @DADE   23               INC   HL   
306F @DADF   7E               LD   a,(hl)   
3070 @DAE0   C9               RET      
3071 @DAE1          NEXT_MANUFACTURER:      
3071 @DAE1   11 08 00         LD   de,$08   
3074 @DAE4   19               ADD   hl,de   
3075 @DAE5   18 DD            JR   CHIP_SIZE_LOOP   
3077 @DAE7          CHIP_ID_NOT_FOUND:      
3077 @DAE7   AF               XOR   A   
3078 @DAE8   32 4C 30         LD   (MANUFACTURER_CHECK_CNT),a   
307B @DAEB   C9               RET      
307C @DAEC          F_READ_ID:      
307C @DAEC   3E F0            LD   a,$F0   
307E @DAEE   32 FF C0         LD   ($C0FF),A   
3081 @DAF1                       ;5555 AA
3081 @DAF1                       ;2AAA 55
3081 @DAF1                       ;5555 90
3081 @DAF1                       ; reg E=0 : ROM0
3081 @DAF1                       ; reg E=A19 : ROM1
3081 @DAF1   21 55 55         LD   hl,$5555   
3084 @DAF4   16 AA            LD   d,$aa   
3086 @DAF6   CD AF 30         CALL   f_set_pages   
3089 @DAF9   21 AA 2A         LD   hl,$2AAA   
308C @DAFC   16 55            LD   d,$55   
308E @DAFE   CD AF 30         CALL   f_set_pages   
3091 @DB01   21 55 55         LD   hl,$5555   
3094 @DB04   16 90            LD   d,$90   
3096 @DB06   CD AF 30         CALL   f_set_pages   
3099 @DB09   7B               LD   a,e   
309A @DB0A   32 02 C0         LD   (register_disable_reset),A   ; A18-A1 shall be 0, A19 set
309D @DB0D   3A 00 C0         LD   A,($C000)   ; Manufacturer ID
30A0 @DB10   47               LD   b,a   
30A1 @DB11   3A 01 C0         LD   A,($C001)   ; Chip ID
30A4 @DB14   4F               LD   c,a   
30A5 @DB15                       ; close the autoselect sequence
30A5 @DB15   3E F0            LD   a,$F0   
30A7 @DB17   32 FF C0         LD   ($C0FF),A   
30AA @DB1A   AF               XOR   A   
30AB @DB1B   32 00 C0         LD   (register),A   
30AE @DB1E   C9               RET      
30AF @DB1F          F_SET_PAGES:      ; HL-flash address, D-flash data, E-0 or A19
30AF @DB1F   7C               LD   A,H   
30B0 @DB20   CB 3F            SRL   A   
30B2 @DB22   CB 3F            SRL   A   
30B4 @DB24   CB 3F            SRL   A   
30B6 @DB26   CB 3F            SRL   A   
30B8 @DB28   CB 3F            SRL   A   
30BA @DB2A   CB 3F            SRL   A   
30BC @DB2C   B3               OR   E   
30BD @DB2D   32 02 C0         LD   (register_disable_reset),a   
30C0 @DB30   3E C0            LD   a,$C0   
30C2 @DB32   B4               OR   h   
30C3 @DB33   67               LD   h,a   
30C4 @DB34   72               LD   (hl),d   
30C5 @DB35   C9               RET      
30C6 @DB36                       ;ROM check routines
30C6 @DB36          F_CALC_FREE_SPACE:      
30C6 @DB36   2A 08 C0         LD   hl,(BAM_START_ADDRESS)   
30C9 @DB39   3A 88 08         LD   a,(SIZE_OF_FLASH1)   
30CC @DB3C   CD E3 30         CALL   F_CFS_CHECK_BAMS   
30CF @DB3F   C5               PUSH   bc   
30D0 @DB40   2A 08 C0         LD   hl,(BAM_START_ADDRESS)   
30D3 @DB43   11 00 01         LD   de,$0100   
30D6 @DB46   19               ADD   hl,de   
30D7 @DB47   3A 89 08         LD   a,(SIZE_OF_FLASH2)   
30DA @DB4A   CD E3 30         CALL   F_CFS_CHECK_BAMS   
30DD @DB4D   E1               POP   hl   
30DE @DB4E   09               ADD   hl,bc   
30DF @DB4F   22 8E 08         LD   (FREE_BLOCKS_IN_BAMS),hl   
30E2 @DB52   C9               RET      
30E3 @DB53          F_CFS_CHECK_BAMS:      
30E3 @DB53   FE 04            CP   4   
30E5 @DB55   20 04            JR   nz,CFS_CHECK_256   
30E7 @DB57   0E FF            LD   c,$FF   
30E9 @DB59   18 11            JR   CFS_CHECK_DONE   
30EB @DB5B          CFS_CHECK_256:      
30EB @DB5B   FE 02            CP   2   
30ED @DB5D   20 04            JR   nz,CFS_CHECK_128   
30EF @DB5F   0E 7F            LD   c,$7F   
30F1 @DB61   18 09            JR   CFS_CHECK_DONE   
30F3 @DB63          CFS_CHECK_128:      
30F3 @DB63   FE 01            CP   1   
30F5 @DB65   20 04            JR   nz,CFS_NOT_INSTALLED   
30F7 @DB67   0E 3F            LD   c,$3F   
30F9 @DB69   18 01            JR   CFS_CHECK_DONE   
30FB @DB6B          CFS_NOT_INSTALLED:      
30FB @DB6B   C9               RET      
30FC @DB6C          CFS_CHECK_DONE:      
30FC @DB6C   AF               XOR   a   
30FD @DB6D   47               LD   b,a   
30FE @DB6E   09               ADD   hl,bc   
30FF @DB6F   4F               LD   c,a   
3100 @DB70   CD 04 31         CALL   F_CHECK_ONE_BAM_BANK   
3103 @DB73   C9               RET      
3104 @DB74          F_CHECK_ONE_BAM_BANK:      
3104 @DB74   3D               DEC   a   
3105 @DB75          CFS_LOOP:      
3105 @DB75   CB 46            BIT   0,(hl)   
3107 @DB77   20 01            JR   nz,CFS_BIT_1   
3109 @DB79   03               INC   bc   
310A @DB7A          CFS_BIT_1:      
310A @DB7A   CB 4E            BIT   1,(hl)   
310C @DB7C   20 01            JR   nz,CFS_BIT_2   
310E @DB7E   03               INC   bc   
310F @DB7F          CFS_BIT_2:      
310F @DB7F   CB 56            BIT   2,(hl)   
3111 @DB81   20 01            JR   nz,CFS_BIT_3   
3113 @DB83   03               INC   bc   
3114 @DB84          CFS_BIT_3:      
3114 @DB84   CB 5E            BIT   3,(hl)   
3116 @DB86   20 01            JR   nz,CFS_BIT_4   
3118 @DB88   03               INC   bc   
3119 @DB89          CFS_BIT_4:      
3119 @DB89   CB 66            BIT   4,(hl)   
311B @DB8B   20 01            JR   nz,CFS_BIT_5   
311D @DB8D   03               INC   bc   
311E @DB8E          CFS_BIT_5:      
311E @DB8E   CB 6E            BIT   5,(hl)   
3120 @DB90   20 01            JR   nz,CFS_BIT_6   
3122 @DB92   03               INC   bc   
3123 @DB93          CFS_BIT_6:      
3123 @DB93   CB 76            BIT   6,(hl)   
3125 @DB95   20 01            JR   nz,CFS_BIT_7   
3127 @DB97   03               INC   bc   
3128 @DB98          CFS_BIT_7:      
3128 @DB98   CB 7E            BIT   7,(hl)   
312A @DB9A   20 01            JR   nz,CFS_BIT_8   
312C @DB9C   03               INC   bc   
312D @DB9D          CFS_BIT_8:      
312D @DB9D   2B               DEC   HL   
312E @DB9E   BD               CP   l   
312F @DB9F   20 D4            JR   nz,CFS_LOOP   
3131 @DBA1   C9               RET      
3132 @DBA2          ROM_CHECK_END:      
3132 @DBA2          F_CHECK_RAM_SIZE:      
3132 @DBA2   CD A9 31         CALL   F_FILL_RAM   
3135 @DBA5   0E 00            LD   c,0   
3137 @DBA7   3E C0            LD   a,RAM + REGREL   
3139 @DBA9   32 00 C0         LD   (register),a   
313C @DBAC   21 00 C0         LD   hl,$C000   ; Check 1st byte of RAM (8k?)
313F @DBAF   CD CB 31         CALL   f_check_byte   
3142 @DBB2   20 59            JR   nz,check_ram_exit   
3144 @DBB4                       ; 8kRAM OK
3144 @DBB4   CD E2 31         CALL   F_COPY_TVC   
3147 @DBB7   0E 01            LD   c,1   ; means 8kB RAM
3149 @DBB9   3E 40            LD   a,RAM   
314B @DBBB   32 00 E0         LD   (register_reloc),a   
314E @DBBE   21 00 E0         LD   hl,$E000   ; Check 16k RAM
3151 @DBC1   CD EE 31         CALL   f_check_tvc   
3154 @DBC4   28 47            JR   z,check_ram_exit   
3156 @DBC6   0C               INC   c   ; 16kRAM OK
3157 @DBC7   3E C1            LD   a,RAM + REGREL + 1   ; Check 32k RAM
3159 @DBC9   32 00 C0         LD   (register),a   
315C @DBCC   21 00 C0         LD   hl,$C000   
315F @DBCF   CD EE 31         CALL   f_check_tvc   
3162 @DBD2   28 39            JR   z,check_ram_exit   
3164 @DBD4   0C               INC   c   ; 32kRAM OK
3165 @DBD5   3E C2            LD   a,RAM + REGREL + 2   ; Check 64k RAM
3167 @DBD7   32 00 E0         LD   (register_reloc),a   
316A @DBDA   21 00 C0         LD   hl,$C000   
316D @DBDD   CD EE 31         CALL   f_check_tvc   
3170 @DBE0   28 2B            JR   z,check_ram_exit   
3172 @DBE2   0C               INC   c   ; 64kRAM OK
3173 @DBE3   3E C4            LD   a,RAM + REGREL + 4   ; Check 128k RAM
3175 @DBE5   32 00 E0         LD   (register_reloc),a   
3178 @DBE8   21 00 C0         LD   hl,$C000   
317B @DBEB   CD EE 31         CALL   f_check_tvc   
317E @DBEE   28 1D            JR   z,check_ram_exit   
3180 @DBF0   0C               INC   c   ; 128kRAM OK
3181 @DBF1   3E C8            LD   a,RAM + REGREL + 8   ; Check 256k RAM
3183 @DBF3   32 00 E0         LD   (register_reloc),a   
3186 @DBF6   21 00 C0         LD   hl,$C000   
3189 @DBF9   CD EE 31         CALL   f_check_tvc   
318C @DBFC   28 0F            JR   z,check_ram_exit   
318E @DBFE   0C               INC   c   ; 256kRAM OK
318F @DBFF   3E D0            LD   a,RAM + REGREL + 16   ; Check 512k RAM
3191 @DC01   32 00 E0         LD   (register_reloc),a   
3194 @DC04   21 00 C0         LD   hl,$C000   
3197 @DC07   CD EE 31         CALL   f_check_tvc   
319A @DC0A   28 01            JR   z,check_ram_exit   
319C @DC0C   0C               INC   c   ; 512kRAM OK
319D @DC0D          CHECK_RAM_EXIT:      
319D @DC0D   79               LD   a,c   
319E @DC0E   32 8A 08         LD   (SIZE_OF_CART_RAM),a   
31A1 @DC11   AF               XOR   A   
31A2 @DC12   32 00 E0         LD   (register_reloc),a   
31A5 @DC15   32 00 C0         LD   (register),a   
31A8 @DC18   C9               RET      
31A9 @DC19          F_FILL_RAM:      
31A9 @DC19   0E 00            LD   c,0   
31AB @DC1B   3E 80            LD   a,REGREL   
31AD @DC1D   32 00 C0         LD   (register),a   
31B0 @DC20          FR_LOOP:      
31B0 @DC20   3E C0            LD   a,RAM+REGREL   
31B2 @DC22   B1               OR   c   
31B3 @DC23   32 00 E0         LD   (REGISTER_RELOC),a   
31B6 @DC26   AF               XOR   A   
31B7 @DC27   21 00 C0         LD   hl,$c000   
31BA @DC2A   06 07            LD   b,STR_RAM_TEST_END-STR_RAM_TEST   
31BC @DC2C          FR_LOOP_IN:      
31BC @DC2C   77               LD   (HL),a   
31BD @DC2D   23               INC   HL   
31BE @DC2E   10 FC            DJNZ   fr_loop_in   
31C0 @DC30   0C               INC   c   
31C1 @DC31   3E 40            LD   a,$40   
31C3 @DC33   B9               CP   c   
31C4 @DC34   20 EA            JR   nz,fr_loop   
31C6 @DC36   AF               XOR   a   
31C7 @DC37   32 00 E0         LD   (register_reloc),a   
31CA @DC3A   C9               RET      
31CB @DC3B          F_CHECK_BYTE:      
31CB @DC3B   3E 55            LD   a,$55   
31CD @DC3D   77               LD   (hl),a   
31CE @DC3E   BE               CP   (hl)   
31CF @DC3F   20 10            JR   nz,CHECK_BYTE_EXIT   
31D1 @DC41   3E AA            LD   a,$AA   
31D3 @DC43   77               LD   (hl),a   
31D4 @DC44   BE               CP   (hl)   
31D5 @DC45   20 0A            JR   nz,CHECK_BYTE_EXIT   
31D7 @DC47   3E 00            LD   a,$00   
31D9 @DC49   77               LD   (hl),a   
31DA @DC4A   BE               CP   (hl)   
31DB @DC4B   20 04            JR   nz,CHECK_BYTE_EXIT   
31DD @DC4D   3E FF            LD   a,$FF   
31DF @DC4F   77               LD   (hl),a   
31E0 @DC50   BE               CP   (hl)   
31E1 @DC51          CHECK_BYTE_EXIT:      
31E1 @DC51   C9               RET      
31E2 @DC52          F_COPY_TVC:      
31E2 @DC52   11 00 C0         LD   DE,$C000   
31E5 @DC55   01 07 00         LD   bc,STR_RAM_TEST_END-STR_RAM_TEST   
31E8 @DC58   21 41 3C         LD   HL,STR_RAM_TEST   
31EB @DC5B   ED B0            LDIR      
31ED @DC5D   C9               RET      
31EE @DC5E          F_CHECK_TVC:      
31EE @DC5E   06 07            LD   b,STR_RAM_TEST_END-STR_RAM_TEST   
31F0 @DC60   11 41 3C         LD   de,STR_RAM_TEST   
31F3 @DC63          CT_LOOP:      
31F3 @DC63   7E               LD   a,(hl)   
31F4 @DC64   EB               EX   de,hl   
31F5 @DC65   BE               CP   (hl)   
31F6 @DC66   EB               EX   de,hl   
31F7 @DC67   13               INC   de   
31F8 @DC68   23               INC   hl   
31F9 @DC69   20 02            JR   nz,check_tvc_exit   
31FB @DC6B   10 F6            DJNZ   ct_loop   
31FD @DC6D          CHECK_TVC_EXIT:      
31FD @DC6D   C9               RET      
31FE @DC6E          RAM_TEST_DIALOG_X:   EQU   15   
31FE @DC6E          RAM_TEST_DIALOG_Y:   EQU   9   
31FE @DC6E          RAM_TEST_DIALOG_W:   EQU   34   
31FE @DC6E          RAM_TEST_DIALOG_H:   EQU   6   
31FE @DC6E          F_CART_RAM_TEST:      
31FE @DC6E   01 09 0F         LD   bc,RAM_TEST_DIALOG_X*256+RAM_TEST_DIALOG_Y   ; x;y => 15;9
3201 @DC71   11 06 22         LD   de,RAM_TEST_DIALOG_W*256+RAM_TEST_DIALOG_H   ; w;h => 34;6
3204 @DC74   CD BE C4         CALL   f_show_dialog_box   
3207 @DC77   11 AB 3D         LD   de,STR_TESTING_RAM   
320A @DC7A   01 1C 00         LD   bc,STR_TESTING_RAM_END-STR_TESTING_RAM   
320D @DC7D   3E 03            LD   a,3   
320F @DC7F   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3212 @DC82   11 A2 3D         LD   de,STR_PASSED_SO_FAR   
3215 @DC85   01 09 00         LD   bc,STR_PASSED_SO_FAR_END-STR_PASSED_SO_FAR   
3218 @DC88   AF               XOR   a   
3219 @DC89   32 BD 32         LD   (REGISTER_SAVE),a   
321C @DC8C   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
321F @DC8F   21 00 00         LD   hl,0   
3222 @DC92   22 BB 32         LD   (RAM_TESTED_AND_PASSED),hl   
3225 @DC95   CD BE 32         CALL   RAM_TEST_UPDATE_PROGRESS   
3228 @DC98   F3               DI      
3229 @DC99                       ;8 16 32 64 128 256 512
3229 @DC99                       ;1 2  4  8  16  32  64
3229 @DC99                       ;1 2  3  4  5   6   7
3229 @DC99   3A 8A 08         LD   a,(SIZE_OF_CART_RAM)   
322C @DC9C   47               LD   b,a   
322D @DC9D   AF               XOR   a   
322E @DC9E   4F               LD   c,a   
322F @DC9F   37               SCF      
3230 @DCA0          L_SETUP_LOOP_COUNTER:      
3230 @DCA0   17               RLA      
3231 @DCA1   10 FD            DJNZ   L_SETUP_LOOP_COUNTER   
3233 @DCA3   47               LD   b,a   
3234 @DCA4          L_RAM_TEST_MAIN_LOOP:      
3234 @DCA4   3E C0            LD   a,REGREL+RAM   
3236 @DCA6   81               ADD   a,c   
3237 @DCA7   32 00 C0         LD   ($C000),a   
323A @DCAA   32 BD 32         LD   (REGISTER_SAVE),a   
323D @DCAD   C5               PUSH   bc   
323E @DCAE   CD 97 32         CALL   LOW_8K_RAM_TEST   
3241 @DCB1   20 38            JR   nz,L_RAM_TEST_FAILED   
3243 @DCB3   CD BE 32         CALL   RAM_TEST_UPDATE_PROGRESS   
3246 @DCB6   C1               POP   bc   
3247 @DCB7   05               DEC   b   
3248 @DCB8   28 1E            JR   z,L_RAM_TEST_PASSED   
324A @DCBA   3E 40            LD   a,RAM   
324C @DCBC   81               ADD   a,c   
324D @DCBD   32 00 E0         LD   ($E000),a   
3250 @DCC0   32 BD 32         LD   (REGISTER_SAVE),a   
3253 @DCC3   C5               PUSH   bc   
3254 @DCC4   CD 9C 32         CALL   HIGH_8K_RAM_TEST   
3257 @DCC7   20 22            JR   nz,L_RAM_TEST_FAILED   
3259 @DCC9   CD BE 32         CALL   RAM_TEST_UPDATE_PROGRESS   
325C @DCCC   C1               POP   bc   
325D @DCCD   05               DEC   b   
325E @DCCE   28 08            JR   z,L_RAM_TEST_PASSED   
3260 @DCD0   0C               INC   c   
3261 @DCD1   3E 20            LD   a,$20   
3263 @DCD3   B9               CP   c   
3264 @DCD4   20 CE            JR   nz,L_RAM_TEST_MAIN_LOOP   
3266 @DCD6   18 00            JR   L_RAM_TEST_PASSED   
3268 @DCD8          L_RAM_TEST_PASSED:      
3268 @DCD8   AF               XOR   a   
3269 @DCD9   32 00 E0         LD   ($E000),a   
326C @DCDC   32 00 C0         LD   ($C000),a   
326F @DCDF   11 C7 3D         LD   de,STR_RAM_TEST_OK   
3272 @DCE2   01 20 00         LD   bc,STR_RAM_TEST_OK_END-STR_RAM_TEST_OK   
3275 @DCE5   AF               XOR   a   
3276 @DCE6   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3279 @DCE9   18 12            JR   L_RAM_TEST_FINISHED   
327B @DCEB          L_RAM_TEST_FAILED:      
327B @DCEB   C1               POP   bc   
327C @DCEC   AF               XOR   a   
327D @DCED   32 00 E0         LD   ($E000),a   
3280 @DCF0   32 00 C0         LD   ($C000),a   
3283 @DCF3   11 E7 3D         LD   de,STR_RAM_TEST_NOK   
3286 @DCF6   01 1D 00         LD   bc,STR_RAM_TEST_NOK_END-STR_RAM_TEST_NOK   
3289 @DCF9   AF               XOR   a   
328A @DCFA   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
328D @DCFD          L_RAM_TEST_FINISHED:      
328D @DCFD   CD 95 C7         CALL   PRINT_PRESS_SPACE   
3290 @DD00   CD A2 CB         CALL   WAIT_FOR_SPACE   
3293 @DD03   CD DE C4         CALL   F_CLOSE_DIALOG_BOX   
3296 @DD06   C9               RET      
3297 @DD07          LOW_8K_RAM_TEST:      
3297 @DD07   21 00 C0         LD   hl,$C000   
329A @DD0A   18 03            JR   RAM_TEST_INIT_FINAL   
329C @DD0C          HIGH_8K_RAM_TEST:      
329C @DD0C   21 00 E0         LD   hl,$E000   
329F @DD0F          RAM_TEST_INIT_FINAL:      
329F @DD0F   01 FF 1F         LD   bc,$1FFF   
32A2 @DD12          RAM_TEST_LOOP:      
32A2 @DD12   AF               XOR   a   
32A3 @DD13   77               LD   (hl),a   
32A4 @DD14   BE               CP   (hl)   
32A5 @DD15   C0               RET   nz   
32A6 @DD16   3E 55            LD   a,$55   
32A8 @DD18   77               LD   (hl),a   
32A9 @DD19   BE               CP   (hl)   
32AA @DD1A   C0               RET   nz   
32AB @DD1B   3E AA            LD   a,$AA   
32AD @DD1D   77               LD   (hl),a   
32AE @DD1E   BE               CP   (hl)   
32AF @DD1F   C0               RET   nz   
32B0 @DD20   3E FF            LD   a,$FF   
32B2 @DD22   77               LD   (hl),a   
32B3 @DD23   BE               CP   (hl)   
32B4 @DD24   C0               RET   nz   
32B5 @DD25   23               INC   hl   
32B6 @DD26   0B               DEC   bc   
32B7 @DD27   B8               CP   b   
32B8 @DD28   20 E8            JR   nz,RAM_TEST_LOOP   
32BA @DD2A   C9               RET      
32BB @DD2B          RAM_TESTED_AND_PASSED:      
32BB @DD2B   00 00            DW   0   
32BD @DD2D          REGISTER_SAVE:      
32BD @DD2D   00               DB   0   
32BE @DD2E          RAM_TEST_UPDATE_PROGRESS:      
32BE @DD2E   3A BD 32         LD   a,(REGISTER_SAVE)   
32C1 @DD31   CB 7F            BIT   7,a   
32C3 @DD33   20 06            JR   nz,L_PRT_REG_RELOC   
32C5 @DD35   AF               XOR   a   
32C6 @DD36   32 00 C0         LD   (register),a   
32C9 @DD39   18 04            JR   L_PRINT_RT_PROGRESS   
32CB @DD3B          L_PRT_REG_RELOC:      
32CB @DD3B   AF               XOR   a   
32CC @DD3C   32 00 E0         LD   (register_reloc),a   
32CF @DD3F          L_PRINT_RT_PROGRESS:      
32CF @DD3F   06 1A            LD   b,RAM_TEST_DIALOG_X+2+STR_PASSED_SO_FAR_END-STR_PASSED_SO_FAR   ; x
32D1 @DD41   0E 0C            LD   c,RAM_TEST_DIALOG_Y+3   ; y
32D3 @DD43   F7               RST   30h   
32D4 @DD44   23               DB   $23   
32D5 @DD45   2A BB 32         LD   hl,(RAM_TESTED_AND_PASSED)   
32D8 @DD48   CD 4A C4         CALL   F_PRINT_NUMBER_NON_ZERO_LEAD   
32DB @DD4B   0E 6B            LD   c,"k"   
32DD @DD4D   F7               RST   30h   
32DE @DD4E   21               DB   $21   
32DF @DD4F   0E 42            LD   c,"B"   
32E1 @DD51   F7               RST   30h   
32E2 @DD52   21               DB   $21   
32E3 @DD53   F3               DI      
32E4 @DD54   2A BB 32         LD   hl,(RAM_TESTED_AND_PASSED)   
32E7 @DD57   01 08 00         LD   bc,0008   
32EA @DD5A   09               ADD   hl,bc   
32EB @DD5B   22 BB 32         LD   (RAM_TESTED_AND_PASSED),hl   
32EE @DD5E   3A BD 32         LD   a,(REGISTER_SAVE)   
32F1 @DD61   32 00 C0         LD   (register),a   
32F4 @DD64   C9               RET      
32F5 @DD65          F_INIT_ENTRIES:      
32F5 @DD65                       ; init the EXIT to BASIC entry
32F5 @DD65   3E 01            LD   a,$01   
32F7 @DD67   21 00 4C         LD   hl,CART_NAME_STRUCT   
32FA @DD6A   77               LD   (hl),a   
32FB @DD6B   23               INC   hl   ; points to low byte of directory address
32FC @DD6C   23               INC   hl   ; points to high byte of directory address
32FD @DD6D   3A 09 C0         LD   a,(BAM_START_ADDRESS+1)   ; by default BAM starts at $F000
3300 @DD70   C6 02            ADD   a,$02   ; directory starts at BAM+$0200
3302 @DD72   77               LD   (hl),a   ; by default CART_NAME_STRUCT is filled with 00
3303 @DD73   DD 21 04 4C      LD   ix,CART_NAME_STRUCT+4   
3307 @DD77   AF               XOR   a   
3308 @DD78   32 86 08         LD   (NUM_OF_IMAGES),a   
330B @DD7B   11 14 02         LD   de,$0214   ; BAM+first entry
330E @DD7E   2A 08 C0         LD   hl,(BAM_START_ADDRESS)   
3311 @DD81   19               ADD   hl,de   
3312 @DD82          ICE_BANK_OK:      
3312 @DD82   56               LD   d,(hl)   ; type of image
3313 @DD83   BA               CP   d   
3314 @DD84   28 27            JR   Z,ICE_DONE   
3316 @DD86   DD 72 00         LD   (IX+0),D   
3319 @DD89                       ; CART_NAME_STRUCT contains pointer to directory entry
3319 @DD89                       ; instead of image start
3319 @DD89   DD 75 01         LD   (IX+1),l   
331C @DD8C   DD 74 02         LD   (IX+2),h   
331F @DD8F   23               INC   hl   
3320 @DD90   23               INC   hl   
3321 @DD91   23               INC   hl   
3322 @DD92   56               LD   d,(hl)   
3323 @DD93   DD 72 03         LD   (IX+3),d   
3326 @DD96   DD 23            INC   ix   
3328 @DD98   DD 23            INC   ix   
332A @DD9A   DD 23            INC   ix   
332C @DD9C   DD 23            INC   ix   
332E @DD9E                       ; end of change
332E @DD9E                       ; 
332E @DD9E                       ;===== OLD format, CART_NAME_STRUCT contains pointer to program start
332E @DD9E                       ;            INC     HL
332E @DD9E                       ;                    ; bank (0-31)
332E @DD9E                       ;            LD      d,(hl)
332E @DD9E                       ;            LD      (IX+1),D
332E @DD9E                       ;            INC     HL
332E @DD9E                       ;                    ; 256 block pos (0-63)
332E @DD9E                       ;            LD      d,(hl)
332E @DD9E                       ;            LD      (IX+2),D
332E @DD9E                       ;            INC     HL
332E @DD9E                       ;                    ; File Size in kB
332E @DD9E                       ;            LD      d,(hl)
332E @DD9E                       ;            LD      (IX+3),D
332E @DD9E                       ;            LD      DE,$0004
332E @DD9E                       ;            ADD     IX,DE
332E @DD9E                       ;==== end of OLD format
332E @DD9E   E5               PUSH   HL   
332F @DD9F   21 86 08         LD   HL,NUM_OF_IMAGES   
3332 @DDA2   34               INC   (HL)   
3333 @DDA3   E1               POP   HL   
3334 @DDA4                       ; Skip name of image (16 bytes) + next entry
3334 @DDA4   11 11 00         LD   DE,$0011   
3337 @DDA7   19               ADD   HL,DE   
3338 @DDA8   BC               CP   h   
3339 @DDA9   28 02            JR   z,ICE_DONE   
333B @DDAB   18 D5            JR   ICE_BANK_OK   
333D @DDAD          ICE_DONE:      
333D @DDAD   DD 36 00 00      LD   (ix+0),0   ; for sorting this is the end marker
3341 @DDB1   C9               RET      
3342 @DDB2          TVC_BAM_COPY_ADDRESS:   EQU   $6000   
3342 @DDB2          F_DELETE_SELECTED_FROM_FLASH:      
3342 @DDB2   11 89 3C         LD   de,STR_FOUND_FLASH_CHIP   
3345 @DDB5   01 14 00         LD   bc,STR_FOUND_FLASH_CHIP_END-STR_FOUND_FLASH_CHIP   
3348 @DDB8   AF               XOR   a   
3349 @DDB9   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
334C @DDBC   3A 90 08         LD   a,(FLASH1_TYPE)   
334F @DDBF   FE 01            CP   $01   ; check AMD
3351 @DDC1   CA C4 33         JP   z,DELETE_FOR_AMD   
3354 @DDC4   FE 02            CP   $02   ; check SST
3356 @DDC6   CA 7B 33         JP   z,DELETE_FOR_SST   
3359 @DDC9   FE 03            CP   $03   ; check ATmel
335B @DDCB   CA DA 33         JP   z,DELETE_FOR_ATMel   
335E @DDCE   11 9D 3C         LD   de,STR_FLASH_IC_UNKNOWN   
3361 @DDD1   01 0A 00         LD   bc,STR_FLASH_IC_UNKNOWN_END-STR_FLASH_IC_UNKNOWN   
3364 @DDD4   3E 02            LD   a,2   
3366 @DDD6   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3369 @DDD9   11 02 3D         LD   de,STR_FLASH_NOT_SUPPORTED   
336C @DDDC   01 1B 00         LD   bc,STR_FLASH_NOT_SUPPORTED_END-STR_FLASH_NOT_SUPPORTED   
336F @DDDF   AF               XOR   a   
3370 @DDE0   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3373 @DDE3   C9               RET      
3374 @DDE4          NUM_OF_SST_SECTORS:      
3374 @DDE4   00               DB   0   
3375 @DDE5          TARGET_HIGH_SST:      
3375 @DDE5   00               DB   0   
3376 @DDE6          BAM_START_SST:      
3376 @DDE6   00 00            DW   0   
3378 @DDE8          REGISTER_TO_USE:      
3378 @DDE8   00 00            DW   0   
337A @DDEA          REGISTER_VALUE:      
337A @DDEA   00               DB   0   
337B @DDEB          DELETE_FOR_SST:      
337B @DDEB   11 26 3A         LD   de,STR_FLASH_IC_SST   
337E @DDEE   01 0A 00         LD   bc,STR_FLASH_IC_SST_END-STR_FLASH_IC_SST   
3381 @DDF1   3E 02            LD   a,2   
3383 @DDF3   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3386 @DDF6   11 A7 3C         LD   de,STR_FLASH_CREATE_WORK_COPY   
3389 @DDF9   01 1B 00         LD   bc,STR_FLASH_CREATE_WORK_COPY_END-STR_FLASH_CREATE_WORK_COPY   
338C @DDFC   AF               XOR   a   
338D @DDFD   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3390 @DE00   CD F0 33         CALL   COPY_SST_BAM_DIR   ; OK
3393 @DE03   11 C2 3C         LD   de,STR_FLASH_MODIFY_FS   
3396 @DE06   01 20 00         LD   bc,STR_FLASH_MODIFY_FS_END-STR_FLASH_MODIFY_FS   
3399 @DE09   AF               XOR   a   
339A @DE0A   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
339D @DE0D   CD 56 34         CALL   remove_from_bam_sst   ; OK
33A0 @DE10   CD 01 35         CALL   move_sst_dir_entries   ; OK
33A3 @DE13   CD 53 35         CALL   move_sst_cart_records   ; OK
33A6 @DE16   CD 8D 35         CALL   fix_sst_cart_record_pointers   ; OK
33A9 @DE19   11 E2 3C         LD   de,STR_FLASH_UPDATE   
33AC @DE1C   01 1B 00         LD   bc,STR_FLASH_UPDATE_END-STR_FLASH_UPDATE   
33AF @DE1F   AF               XOR   a   
33B0 @DE20   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33B3 @DE23   CD DB 35         CALL   WRITE_BACK_BAM_SST   ; OK
33B6 @DE26   CD 9F 36         CALL   fix_pointers   ; OK
33B9 @DE29   11 FD 3C         LD   de,STR_FLASH_DONE   
33BC @DE2C   01 05 00         LD   bc,STR_FLASH_DONE_END-STR_FLASH_DONE   
33BF @DE2F   AF               XOR   a   
33C0 @DE30   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33C3 @DE33   C9               RET      
33C4 @DE34          DELETE_FOR_AMD:      
33C4 @DE34   11 30 3A         LD   de,STR_FLASH_IC_AMD   
33C7 @DE37   01 08 00         LD   bc,STR_FLASH_IC_AMD_END-STR_FLASH_IC_AMD   
33CA @DE3A   3E 02            LD   a,2   
33CC @DE3C   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33CF @DE3F   11 02 3D         LD   de,STR_FLASH_NOT_SUPPORTED   
33D2 @DE42   01 1B 00         LD   bc,STR_FLASH_NOT_SUPPORTED_END-STR_FLASH_NOT_SUPPORTED   
33D5 @DE45   AF               XOR   a   
33D6 @DE46   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33D9 @DE49   C9               RET      
33DA @DE4A          DELETE_FOR_ATMEL:      
33DA @DE4A   11 38 3A         LD   de,STR_FLASH_IC_ATMEL   
33DD @DE4D   01 08 00         LD   bc,STR_FLASH_IC_ATMEL_END-STR_FLASH_IC_ATMEL   
33E0 @DE50   3E 02            LD   a,2   
33E2 @DE52   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33E5 @DE55   11 02 3D         LD   de,STR_FLASH_NOT_SUPPORTED   
33E8 @DE58   01 1B 00         LD   bc,STR_FLASH_NOT_SUPPORTED_END-STR_FLASH_NOT_SUPPORTED   
33EB @DE5B   AF               XOR   a   
33EC @DE5C   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
33EF @DE5F   C9               RET      
33F0 @DE60          COPY_SST_BAM_DIR:      
33F0 @DE60   AF               XOR   a   
33F1 @DE61   32 02 C0         LD   (REGISTER_DISABLE_RESET),a   
33F4 @DE64   11 00 C0         LD   de,$C000   
33F7 @DE67          L_NEXT_TRY:      
33F7 @DE67   21 00 F0         LD   hl,BAM_START   
33FA @DE6A   AF               XOR   a   
33FB @DE6B   ED 52            SBC   hl,de   
33FD @DE6D   7C               LD   a,h   
33FE @DE6E   FE 10            CP   $10   
3400 @DE70   FA 0B 34         JP   m,L_START_COPY   
3403 @DE73   EB               EX   de,hl   
3404 @DE74   11 00 10         LD   de,$1000   
3407 @DE77   19               ADD   hl,de   
3408 @DE78   EB               EX   de,hl   
3409 @DE79   18 EC            JR   L_NEXT_TRY   
340B @DE7B          L_START_COPY:      
340B @DE7B   D5               PUSH   de   ; start the copy from here
340C @DE7C   7A               LD   a,d   
340D @DE7D   32 75 33         LD   (TARGET_HIGH_SST),a   
3410 @DE80   21 00 F0         LD   hl,BAM_START   
3413 @DE83   AF               XOR   a   
3414 @DE84   ED 52            SBC   hl,de   
3416 @DE86   11 00 60         LD   de,TVC_BAM_COPY_ADDRESS   
3419 @DE89   19               ADD   hl,de   
341A @DE8A   22 76 33         LD   (BAM_START_SST),hl   
341D @DE8D   3A 86 08         LD   a,(NUM_OF_IMAGES)   
3420 @DE90   4F               LD   c,a   
3421 @DE91   0C               INC   c   
3422 @DE92   CD 85 36         CALL   MUL_C_BY_14H   
3425 @DE95   01 01 00         LD   bc,$0001   
3428 @DE98   AF               XOR   a   
3429 @DE99   ED 42            SBC   hl,bc   
342B @DE9B   11 00 02         LD   de,$0200   
342E @DE9E   19               ADD   hl,de   
342F @DE9F   11 00 F0         LD   de,BAM_START   
3432 @DEA2   19               ADD   hl,de   
3433 @DEA3   D1               POP   de   
3434 @DEA4   E5               PUSH   hl   ; last pos of DIR
3435 @DEA5   21 74 33         LD   hl,NUM_OF_SST_SECTORS   
3438 @DEA8   AF               XOR   a   
3439 @DEA9   77               LD   (hl),a   
343A @DEAA   EB               EX   de,hl   
343B @DEAB   11 00 60         LD   de,TVC_BAM_COPY_ADDRESS   
343E @DEAE          L_COPY_ONE_SECTOR:      
343E @DEAE   E5               PUSH   hl   
343F @DEAF   21 74 33         LD   hl,NUM_OF_SST_SECTORS   
3442 @DEB2   34               INC   (hl)   
3443 @DEB3   E1               POP   hl   
3444 @DEB4   01 00 10         LD   bc,$1000   
3447 @DEB7   ED B0            LDIR      
3449 @DEB9   C1               POP   bc   
344A @DEBA   C5               PUSH   bc   
344B @DEBB   78               LD   a,b   
344C @DEBC   BC               CP   h   
344D @DEBD   F2 3E 34         JP   p,L_COPY_ONE_SECTOR   
3450 @DEC0   C1               POP   bc   
3451 @DEC1   AF               XOR   a   
3452 @DEC2   32 00 C0         LD   (REGISTER),a   
3455 @DEC5   C9               RET      
3456 @DEC6          REMOVE_FROM_BAM_SST:      
3456 @DEC6   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
3459 @DEC9   57               LD   d,a   
345A @DECA   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
345D @DECD   82               ADD   a,d   
345E @DECE   6F               LD   l,a   
345F @DECF   26 00            LD   h,0   
3461 @DED1   CB 25            SLA   l   
3463 @DED3   CB 14            RL   h   
3465 @DED5   CB 25            SLA   l   
3467 @DED7   CB 14            RL   h   
3469 @DED9   11 00 4C         LD   de,CART_NAME_STRUCT   
346C @DEDC   19               ADD   hl,de   ; points to the record in CART_NAME_STRUCT
346D @DEDD   7E               LD   a,(hl)   ; type of image
346E @DEDE   23               INC   hl   ; 
346F @DEDF   5E               LD   e,(hl)   
3470 @DEE0   23               INC   hl   
3471 @DEE1   56               LD   d,(hl)   
3472 @DEE2   EB               EX   de,hl   ; hl points to the record in DIRECTORY
3473 @DEE3   FE 02            CP   2   ; cart
3475 @DEE5   28 08            JR   z,L_REMOVE_CART_SST   
3477 @DEE7   FE 03            CP   3   ; cas
3479 @DEE9   28 39            JR   z,L_REMOVE_CAS_SST   
347B @DEEB   FE 04            CP   4   ; bin
347D @DEED   28 35            JR   z,L_REMOVE_CAS_SST   
347F @DEEF          L_REMOVE_CART_SST:      
347F @DEEF   23               INC   hl   
3480 @DEF0   7E               LD   a,(hl)   ; a is the bank of the cart
3481 @DEF1   23               INC   hl   
3482 @DEF2   23               INC   hl   
3483 @DEF3   46               LD   b,(hl)   ; b is the size in block of the cart
3484 @DEF4   6F               LD   l,a   
3485 @DEF5   26 00            LD   h,0   
3487 @DEF7   CB 25            SLA   l   ; mul by 8
3489 @DEF9   CB 14            RL   h   
348B @DEFB   CB 25            SLA   l   
348D @DEFD   CB 14            RL   h   
348F @DEFF   CB 25            SLA   l   
3491 @DF01   CB 14            RL   h   
3493 @DF03   ED 5B 76 33      LD   de,(BAM_START_SST)   
3497 @DF07   19               ADD   hl,de   
3498 @DF08          L_CART_FULL_BYTE_REMOVAL_SST:      
3498 @DF08   3E 07            LD   a,7   
349A @DF0A   B8               CP   b   
349B @DF0B   F2 A7 34         JP   p,L_LAST_FRACTION_SST   
349E @DF0E   78               LD   a,b   
349F @DF0F   D6 08            SUB   8   
34A1 @DF11   47               LD   b,a   
34A2 @DF12   AF               XOR   a   
34A3 @DF13   77               LD   (hl),a   
34A4 @DF14   23               INC   hl   
34A5 @DF15   18 F1            JR   L_CART_FULL_BYTE_REMOVAL_SST   
34A7 @DF17          L_LAST_FRACTION_SST:      
34A7 @DF17   AF               XOR   a   
34A8 @DF18   B8               CP   b   
34A9 @DF19   28 55            JR   z,L_DONE_REMOVE_SST   
34AB @DF1B          L_MASK_LOOP_SST:      
34AB @DF1B   37               SCF      
34AC @DF1C   17               RLA      
34AD @DF1D   10 FC            DJNZ   L_MASK_LOOP_SST   
34AF @DF1F   2F               CPL      
34B0 @DF20   A6               AND   (hl)   
34B1 @DF21   77               LD   (hl),a   
34B2 @DF22   18 4C            JR   L_DONE_REMOVE_SST   
34B4 @DF24          L_REMOVE_CAS_SST:      
34B4 @DF24   23               INC   hl   
34B5 @DF25          L_REMOVE_CAS_SST_LOOP:      
34B5 @DF25   46               LD   b,(hl)   ; b is the next bank of the cas
34B6 @DF26   23               INC   hl   
34B7 @DF27   4E               LD   c,(hl)   ; c is the next block of the cas
34B8 @DF28   3E FF            LD   a,$ff   ; no more blocks - this cannot happen in DIRECTORY!
34BA @DF2A   B8               CP   b   
34BB @DF2B   28 3F            JR   z,L_DONE_REMOVE_CAS_SST   
34BD @DF2D   68               LD   l,b   
34BE @DF2E   26 00            LD   h,0   
34C0 @DF30                       ; 8 bytes describe one bank
34C0 @DF30   CB 25            SLA   l   
34C2 @DF32   CB 14            RL   h   
34C4 @DF34   CB 25            SLA   l   
34C6 @DF36   CB 14            RL   h   
34C8 @DF38   CB 25            SLA   l   
34CA @DF3A   CB 14            RL   h   
34CC @DF3C   ED 5B 76 33      LD   de,(BAM_START_SST)   
34D0 @DF40   19               ADD   hl,de   
34D1 @DF41   51               LD   d,c   
34D2 @DF42          L_STEP_TO_ALLOCATION_BYTE:      
34D2 @DF42   3E 07            LD   a,$07   
34D4 @DF44   BA               CP   d   
34D5 @DF45   F2 DF 34         JP   p,L_ALLOCATION_BYTE_FOUND   
34D8 @DF48   7A               LD   a,d   
34D9 @DF49   D6 08            SUB   8   
34DB @DF4B   57               LD   d,a   
34DC @DF4C   23               INC   hl   
34DD @DF4D   18 F3            JR   L_STEP_TO_ALLOCATION_BYTE   
34DF @DF4F          L_ALLOCATION_BYTE_FOUND:      
34DF @DF4F   AF               XOR   a   
34E0 @DF50   BA               CP   d   
34E1 @DF51   28 09            JR   z,L_ALLOCATION_BIT_FOUND   
34E3 @DF53   3C               INC   a   
34E4 @DF54   15               DEC   d   
34E5 @DF55   28 05            JR   z,L_ALLOCATION_BIT_FOUND   
34E7 @DF57          L_STEP_TO_ALLOCATION_BIT:      
34E7 @DF57   CB 27            SLA   a   
34E9 @DF59   15               DEC   d   
34EA @DF5A   20 FB            JR   nz,L_STEP_TO_ALLOCATION_BIT   
34EC @DF5C          L_ALLOCATION_BIT_FOUND:      
34EC @DF5C   2F               CPL      
34ED @DF5D   A6               AND   (hl)   
34EE @DF5E   77               LD   (hl),a   
34EF @DF5F   78               LD   a,b   
34F0 @DF60   32 02 C0         LD   (register_disable_reset),a   
34F3 @DF63   2E 00            LD   l,0   
34F5 @DF65   61               LD   h,c   
34F6 @DF66   11 00 C0         LD   de,$C000   
34F9 @DF69   19               ADD   hl,de   
34FA @DF6A   18 B9            JR   L_REMOVE_CAS_SST_LOOP   
34FC @DF6C          L_DONE_REMOVE_CAS_SST:      
34FC @DF6C   AF               XOR   a   
34FD @DF6D   32 00 C0         LD   (register),a   
3500 @DF70          L_DONE_REMOVE_SST:      
3500 @DF70   C9               RET      
3501 @DF71          MOVE_SST_DIR_ENTRIES:      
3501 @DF71   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
3504 @DF74   57               LD   d,a   
3505 @DF75   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
3508 @DF78   82               ADD   a,d   
3509 @DF79   6F               LD   l,a   
350A @DF7A   26 00            LD   h,0   
350C @DF7C   CB 25            SLA   l   
350E @DF7E   CB 14            RL   h   
3510 @DF80   CB 25            SLA   l   
3512 @DF82   CB 14            RL   h   
3514 @DF84   11 01 4C         LD   de,CART_NAME_STRUCT + 1   ; no need for INC HL
3517 @DF87   19               ADD   hl,de   ; points to the record in CART_NAME_STRUCT
3518 @DF88                       ; inc HL is not needed because of DE initialization
3518 @DF88   5E               LD   e,(hl)   
3519 @DF89   23               INC   hl   
351A @DF8A   56               LD   d,(hl)   
351B @DF8B   EB               EX   de,hl   
351C @DF8C   B7               OR   a   
351D @DF8D   11 00 F0         LD   de,BAM_START   
3520 @DF90   ED 52            SBC   hl,de   
3522 @DF92   ED 5B 76 33      LD   de,(BAM_START_SST)   
3526 @DF96   19               ADD   hl,de   
3527 @DF97                       ;            LD      c,a
3527 @DF97                       ;            CALL    MUL_C_BY_14h
3527 @DF97                       ;            LD      de,(BAM_START_SST)
3527 @DF97                       ;            ADD     hl,de
3527 @DF97                       ;            LD      de,$0200
3527 @DF97                       ;            ADD     hl,de ; position of selected item in RAM
3527 @DF97   E5               PUSH   hl   
3528 @DF98   3A 86 08         LD   a,(NUM_OF_IMAGES)   
352B @DF9B   4F               LD   c,a   
352C @DF9C   CD 85 36         CALL   MUL_C_BY_14h   
352F @DF9F   ED 5B 76 33      LD   de,(BAM_START_SST)   
3533 @DFA3   19               ADD   hl,de   
3534 @DFA4   11 00 02         LD   de,$0200   
3537 @DFA7   19               ADD   hl,de   ; position of last item in RAM
3538 @DFA8   D1               POP   de   ; pos of selected item in RAM
3539 @DFA9   D5               PUSH   de   
353A @DFAA   AF               XOR   a   
353B @DFAB   ED 52            SBC   HL,DE   ; diff between them
353D @DFAD   44 4D            LD   bc,hl   
353F @DFAF   EB               EX   de,hl   
3540 @DFB0   11 14 00         LD   de,$0014   
3543 @DFB3   19               ADD   hl,de   ; copy from
3544 @DFB4   D1               POP   de   ; copy to
3545 @DFB5   AF               XOR   a   ; check if bc $0000
3546 @DFB6   B8               CP   b   
3547 @DFB7   20 05            JR   nz,L_DO_THE_DIR_MOVE_SST   
3549 @DFB9   B9               CP   c   
354A @DFBA   20 02            JR   nz,L_DO_THE_DIR_MOVE_SST   
354C @DFBC   18 03            JR   L_DIR_MOVE_DONE_SST   
354E @DFBE          L_DO_THE_DIR_MOVE_SST:      
354E @DFBE   ED B0            LDIR      
3550 @DFC0   AF               XOR   a   ; 00 after last entry
3551 @DFC1          L_DIR_MOVE_DONE_SST:      
3551 @DFC1   12               LD   (de),a   
3552 @DFC2   C9               RET      
3553 @DFC3          MOVE_SST_CART_RECORDS:      
3553 @DFC3   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
3556 @DFC6   57               LD   d,a   
3557 @DFC7   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
355A @DFCA   82               ADD   a,d   
355B @DFCB   6F               LD   l,a   ; abs position in list
355C @DFCC   3A 86 08         LD   a,(NUM_OF_IMAGES)   
355F @DFCF   95               SUB   l   
3560 @DFD0                       ;            CP      0 ; don't copy if last element is selected
3560 @DFD0                       ;            JR      z,L_SST_CART_RECS_DONE
3560 @DFD0   F5               PUSH   af   ; a: count of recs
3561 @DFD1   AF               XOR   a   
3562 @DFD2   67               LD   h,a   
3563 @DFD3   CB 25            SLA   l   
3565 @DFD5   CB 14            RL   h   
3567 @DFD7   CB 25            SLA   l   
3569 @DFD9   CB 14            RL   h   
356B @DFDB   11 00 4C         LD   de,CART_NAME_STRUCT   
356E @DFDE   19               ADD   hl,de   
356F @DFDF   C1               POP   bc   
3570 @DFE0   48               LD   c,b   
3571 @DFE1   06 00            LD   b,$00   
3573 @DFE3   CB 21            SLA   c   
3575 @DFE5   CB 10            RL   b   
3577 @DFE7   CB 21            SLA   c   
3579 @DFE9   CB 10            RL   b   
357B @DFEB   E5               PUSH   hl   ; target
357C @DFEC   11 04 00         LD   de,$0004   
357F @DFEF   19               ADD   hl,de   ; source
3580 @DFF0   D1               POP   de   ; target
3581 @DFF1   AF               XOR   a   
3582 @DFF2   B8               CP   b   
3583 @DFF3   20 03            JR   nz,L_MOVE_SST_CART_RECS   
3585 @DFF5   B9               CP   c   
3586 @DFF6   28 02            JR   z,L_SST_CART_RECS_DONE   
3588 @DFF8          L_MOVE_SST_CART_RECS:      
3588 @DFF8   ED B0            LDIR      
358A @DFFA          L_SST_CART_RECS_DONE:      
358A @DFFA   AF               XOR   a   
358B @DFFB   12               LD   (de),a   
358C @DFFC   C9               RET      
358D @DFFD          FIX_SST_CART_RECORD_POINTERS:      
358D @DFFD   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
3590 @E000   57               LD   d,a   
3591 @E001   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
3594 @E004   82               ADD   a,d   
3595 @E005   4F               LD   c,a   
3596 @E006   CD 85 36         CALL   MUL_C_BY_14h   ; result in HL
3599 @E009   11 00 F0         LD   de,BAM_START   
359C @E00C   19               ADD   hl,de   
359D @E00D   11 00 02         LD   de,$0200   
35A0 @E010   19               ADD   hl,de   
35A1 @E011                       ; compare to hl all pointers. Bigger: must decrement by $14
35A1 @E011   11 00 4C         LD   de,CART_NAME_STRUCT   
35A4 @E014   13               INC   de   
35A5 @E015   13               INC   de   
35A6 @E016   13               INC   de   
35A7 @E017   13               INC   de   
35A8 @E018   D5               PUSH   de   
35A9 @E019   DD E1            POP   ix   
35AB @E01B   3A 86 08         LD   a,(NUM_OF_IMAGES)   
35AE @E01E   47               LD   b,a   
35AF @E01F          L_FIX_STRUCT_LOOP:      
35AF @E01F   DD 56 02         LD   d,(IX+2)   
35B2 @E022   DD 5E 01         LD   e,(IX+1)   
35B5 @E025   7A               LD   a,d   
35B6 @E026   BC               CP   h   
35B7 @E027   38 17            JR   c,L_NO_NEED_TO_FIX   
35B9 @E029   20 04            JR   nz,L_FIXIT   
35BB @E02B   7B               LD   a,e   ; h and d are equal
35BC @E02C   BD               CP   l   
35BD @E02D   38 11            JR   c,L_NO_NEED_TO_FIX   
35BF @E02F          L_FIXIT:      
35BF @E02F   E5               PUSH   hl   
35C0 @E030   EB               EX   de,hl   
35C1 @E031   11 14 00         LD   de,$0014   
35C4 @E034   37               SCF      
35C5 @E035   3F               CCF      
35C6 @E036   ED 52            SBC   hl,de   
35C8 @E038   EB               EX   de,hl   
35C9 @E039   DD 72 02         LD   (ix+2),d   
35CC @E03C   DD 73 01         LD   (ix+1),e   
35CF @E03F   E1               POP   hl   
35D0 @E040          L_NO_NEED_TO_FIX:      
35D0 @E040   DD 23            INC   ix   
35D2 @E042   DD 23            INC   ix   
35D4 @E044   DD 23            INC   ix   
35D6 @E046   DD 23            INC   ix   
35D8 @E048   10 D5            DJNZ   L_FIX_STRUCT_LOOP   
35DA @E04A   C9               RET      
35DB @E04B          WRITE_BACK_BAM_SST:      
35DB @E04B   3E C0            LD   a,$C0   
35DD @E04D   32 79 33         LD   (register_to_use+1),a   
35E0 @E050   3A 75 33         LD   a,(TARGET_HIGH_SST)   
35E3 @E053   57               LD   d,a   
35E4 @E054   AF               XOR   a   
35E5 @E055   32 7A 33         LD   (register_value),a   
35E8 @E058   32 78 33         LD   (register_to_use),a   
35EB @E05B   5F               LD   e,a   
35EC @E05C   21 00 60         LD   hl,TVC_BAM_COPY_ADDRESS   
35EF @E05F   7A               LD   a,d   
35F0 @E060   FE C0            CP   $C0   
35F2 @E062   20 0D            JR   nz,L_SKIP_RELOC   
35F4 @E064   3E 80            LD   a,REGREL   
35F6 @E066   32 00 C0         LD   ($C000),a   
35F9 @E069   32 7A 33         LD   (register_value),a   
35FC @E06C   3E E0            LD   a,$E0   
35FE @E06E   32 79 33         LD   (register_to_use+1),a   
3601 @E071          L_SKIP_RELOC:      
3601 @E071          L_WRITE_SECTOR_SST_LOOP:      
3601 @E071   CD 4C 36         CALL   INIT_SST_SECTOR_ERASE   
3604 @E074   01 00 00         LD   bc,$0000   
3607 @E077          L_WRITE_ONE_SECTOR_SST:      
3607 @E077   E5               PUSH   hl   
3608 @E078   D5               PUSH   de   
3609 @E079                       ; 
3609 @E079   1E 00            LD   e,0   
360B @E07B   21 55 55         LD   hl,$5555   
360E @E07E   16 AA            LD   d,$AA   
3610 @E080   CD AF 30         CALL   f_set_pages   
3613 @E083   21 AA 2A         LD   hl,$2AAA   
3616 @E086   16 55            LD   d,$55   
3618 @E088   CD AF 30         CALL   f_set_pages   
361B @E08B   21 55 55         LD   hl,$5555   
361E @E08E   16 A0            LD   d,$A0   
3620 @E090   CD AF 30         CALL   f_set_pages   
3623 @E093   3A 7A 33         LD   a,(REGISTER_VALUE)   
3626 @E096   2A 78 33         LD   hl,(REGISTER_TO_USE)   
3629 @E099   77               LD   (hl),a   
362A @E09A   D1               POP   de   
362B @E09B   E1               POP   hl   
362C @E09C   7E               LD   a,(hl)   
362D @E09D   12               LD   (de),a   
362E @E09E   13               INC   de   
362F @E09F   23               INC   hl   
3630 @E0A0   03               INC   bc   
3631 @E0A1   78               LD   a,b   
3632 @E0A2   FE 10            CP   $10   
3634 @E0A4   20 D1            JR   nz,L_WRITE_ONE_SECTOR_SST   
3636 @E0A6   7A               LD   a,d   
3637 @E0A7   FE D0            CP   $D0   
3639 @E0A9   20 05            JR   nz,L_SKIP_BACKLOC   
363B @E0AB   AF               XOR   a   
363C @E0AC   21 78 33         LD   hl,REGISTER_TO_USE   
363F @E0AF   77               LD   (hl),a   
3640 @E0B0          L_SKIP_BACKLOC:      
3640 @E0B0   3A 74 33         LD   a,(NUM_OF_SST_SECTORS)   
3643 @E0B3   3D               DEC   a   
3644 @E0B4   32 74 33         LD   (NUM_OF_SST_SECTORS),a   
3647 @E0B7   FE 00            CP   $0   
3649 @E0B9   20 B6            JR   nz,L_WRITE_SECTOR_SST_LOOP   
364B @E0BB   C9               RET      
364C @E0BC          INIT_SST_SECTOR_ERASE:      
364C @E0BC   E5               PUSH   hl   
364D @E0BD   D5               PUSH   de   
364E @E0BE   1E 00            LD   e,0   ; probably not relevant, 'cos sector start is $x000
3650 @E0C0   21 55 55         LD   hl,$5555   
3653 @E0C3   16 AA            LD   d,$AA   
3655 @E0C5   CD AF 30         CALL   f_set_pages   
3658 @E0C8   21 AA 2A         LD   hl,$2AAA   
365B @E0CB   16 55            LD   d,$55   
365D @E0CD   CD AF 30         CALL   f_set_pages   
3660 @E0D0   21 55 55         LD   hl,$5555   
3663 @E0D3   16 80            LD   d,$80   
3665 @E0D5   CD AF 30         CALL   f_set_pages   
3668 @E0D8                       ; 
3668 @E0D8   21 55 55         LD   hl,$5555   
366B @E0DB   16 AA            LD   d,$AA   
366D @E0DD   CD AF 30         CALL   f_set_pages   
3670 @E0E0   21 AA 2A         LD   hl,$2AAA   
3673 @E0E3   16 55            LD   d,$55   
3675 @E0E5   CD AF 30         CALL   f_set_pages   
3678 @E0E8   D1               POP   de   
3679 @E0E9   EB               EX   de,hl   
367A @E0EA   3E 30            LD   a,$30   
367C @E0EC   77               LD   (hl),a   
367D @E0ED          L_POLLING:      
367D @E0ED   7E               LD   a,(hl)   
367E @E0EE   E6 80            AND   $80   
3680 @E0F0   28 FB            JR   z,L_POLLING   
3682 @E0F2                       ; 
3682 @E0F2   EB               EX   de,hl   
3683 @E0F3   E1               POP   hl   
3684 @E0F4   C9               RET      
3685 @E0F5          MUL_C_BY_14H:      
3685 @E0F5   69               LD   l,c   
3686 @E0F6   26 00            LD   h,0   
3688 @E0F8   06 04            LD   b,4   
368A @E0FA          L_MUL_LOOP_1:      
368A @E0FA   CB 25            SLA   l   
368C @E0FC   CB 14            RL   h   
368E @E0FE   10 FA            DJNZ   L_MUL_LOOP_1   
3690 @E100   E5               PUSH   hl   
3691 @E101   69               LD   l,c   
3692 @E102   26 00            LD   h,0   
3694 @E104   06 02            LD   b,2   
3696 @E106          L_MUL_LOOP_2:      
3696 @E106   CB 25            SLA   l   
3698 @E108   CB 14            RL   h   
369A @E10A   10 FA            DJNZ   L_MUL_LOOP_2   
369C @E10C   D1               POP   de   
369D @E10D   19               ADD   hl,de   
369E @E10E   C9               RET      
369F @E10F          FIX_POINTERS:      
369F @E10F   21 86 08         LD   hl,NUM_OF_IMAGES   
36A2 @E112   35               DEC   (hl)   
36A3 @E113   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
36A6 @E116   57               LD   d,a   
36A7 @E117   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
36AA @E11A   82               ADD   a,d   
36AB @E11B   4F               LD   c,a   
36AC @E11C   7E               LD   a,(hl)   
36AD @E11D   B9               CP   c   
36AE @E11E   F2 C0 36         JP   p,L_POINTERS_DONE   
36B1 @E121   21 85 08         LD   hl,LIST_SELECTED_ELEMENT   
36B4 @E124   7E               LD   a,(hl)   
36B5 @E125   FE 00            CP   0   
36B7 @E127   28 03            JR   z,L_DEC_FIRST_POS   
36B9 @E129   35               DEC   (hl)   
36BA @E12A   18 04            JR   L_POINTERS_DONE   
36BC @E12C          L_DEC_FIRST_POS:      
36BC @E12C   21 83 08         LD   hl,LIST_FIRST_ELEMENT   
36BF @E12F   35               DEC   (hl)   
36C0 @E130          L_POINTERS_DONE:      
36C0 @E130   C9               RET      
36C1 @E131          INPUT_BUF_LEN:   EQU   $08A0   
36C1 @E131          INPUT_BUFFER:   EQU   $08A1   
36C1 @E131          F_RENAME_FILE:      
36C1 @E131   01 09 0F         LD   bc,15*256+9   ; x;y => 15;9
36C4 @E134   11 08 22         LD   de,34*256+8   ; w;h => 34;6
36C7 @E137   CD BE C4         CALL   f_show_dialog_box   
36CA @E13A   3A 90 08         LD   a,(FLASH1_TYPE)   
36CD @E13D   FE 01            CP   $01   
36CF @E13F   20 02            JR   nz,L_check_sst   
36D1 @E141   18 0C            JR   RENAME_AMD   
36D3 @E143          L_CHECK_SST:      
36D3 @E143   FE 02            CP   $02   
36D5 @E145   20 02            JR   nz,L_check_atmel   
36D7 @E147   18 5A            JR   RENAME_SST   
36D9 @E149          L_CHECK_ATMEL:      
36D9 @E149   FE 03            CP   $03   
36DB @E14B   20 22            JR   nz,RENAME_UNKOWN   
36DD @E14D   18 10            JR   RENAME_ATMEL   
36DF @E14F          RENAME_AMD:      
36DF @E14F   CD 1D 37         CALL   PRINT_FOUND_FLASH_IC   
36E2 @E152   11 30 3A         LD   de,STR_FLASH_IC_AMD   
36E5 @E155   01 08 00         LD   bc,STR_FLASH_IC_AMD_END-STR_FLASH_IC_AMD   
36E8 @E158   3E 02            LD   a,2   
36EA @E15A   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
36ED @E15D   18 20            JR   FINISH_RENAME_NOT_SUPPORTED   
36EF @E15F          RENAME_ATMEL:      
36EF @E15F   CD 1D 37         CALL   PRINT_FOUND_FLASH_IC   
36F2 @E162   11 38 3A         LD   de,STR_FLASH_IC_ATMEL   
36F5 @E165   01 08 00         LD   bc,STR_FLASH_IC_ATMEL_END-STR_FLASH_IC_ATMEL   
36F8 @E168   3E 02            LD   a,2   
36FA @E16A   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
36FD @E16D   18 10            JR   FINISH_RENAME_NOT_SUPPORTED   
36FF @E16F          RENAME_UNKOWN:      
36FF @E16F   CD 1D 37         CALL   PRINT_FOUND_FLASH_IC   
3702 @E172   11 9D 3C         LD   de,STR_FLASH_IC_UNKNOWN   
3705 @E175   01 0A 00         LD   bc,STR_FLASH_IC_UNKNOWN_END-STR_FLASH_IC_UNKNOWN   
3708 @E178   3E 02            LD   a,2   
370A @E17A   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
370D @E17D   18 00            JR   FINISH_RENAME_NOT_SUPPORTED   
370F @E17F          FINISH_RENAME_NOT_SUPPORTED:      
370F @E17F   CD 28 37         CALL   PRINT_NOT_SUPPORTED   
3712 @E182   CD 95 C7         CALL   PRINT_PRESS_SPACE   
3715 @E185   CD A2 CB         CALL   WAIT_FOR_SPACE   
3718 @E188   CD DE C4         CALL   F_CLOSE_DIALOG_BOX   
371B @E18B   AF               XOR   a   
371C @E18C   C9               RET      
371D @E18D          PRINT_FOUND_FLASH_IC:      
371D @E18D   11 89 3C         LD   de,STR_FOUND_FLASH_CHIP   
3720 @E190   01 14 00         LD   bc,STR_FOUND_FLASH_CHIP_END-STR_FOUND_FLASH_CHIP   
3723 @E193   AF               XOR   a   
3724 @E194   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3727 @E197   C9               RET      
3728 @E198          PRINT_NOT_SUPPORTED:      
3728 @E198   11 3B 3D         LD   de,STR_FLASH_RENAME_NOT_SUPPORTED   
372B @E19B   01 1F 00         LD   bc,STR_FLASH_RENAME_NOT_SUPPORTED_END-STR_FLASH_RENAME_NOT_SUPPORTED   
372E @E19E   AF               XOR   a   
372F @E19F   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3732 @E1A2   C9               RET      
3733 @E1A3          RENAME_SST:      
3733 @E1A3   CD 1D 37         CALL   PRINT_FOUND_FLASH_IC   
3736 @E1A6   11 26 3A         LD   de,STR_FLASH_IC_SST   
3739 @E1A9   01 0A 00         LD   bc,STR_FLASH_IC_SST_END-STR_FLASH_IC_SST   
373C @E1AC   3E 02            LD   a,2   
373E @E1AE   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3741 @E1B1   11 5A 3D         LD   de,STR_RENAME_Q_NEW_NAME   
3744 @E1B4   01 17 00         LD   bc,STR_RENAME_Q_NEW_NAME_END-STR_RENAME_Q_NEW_NAME   
3747 @E1B7   AF               XOR   a   
3748 @E1B8   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
374B @E1BB   11 71 3D         LD   de,STR_RENAME_Q_INSTRUCTION   
374E @E1BE   01 1B 00         LD   bc,STR_RENAME_Q_INSTRUCTION_END-STR_RENAME_Q_INSTRUCTION   
3751 @E1C1   3E 01            LD   a,1   
3753 @E1C3   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
3756 @E1C6   CD B1 37         CALL   setup_input_field   
3759 @E1C9   CD D7 37         CALL   INPUT_STR   
375C @E1CC   B7               OR   A   
375D @E1CD   20 05            JR   nz,L_EXECUTE_SST_RENAME   
375F @E1CF                       ; cancelled rename
375F @E1CF   CD DE C4         CALL   F_CLOSE_DIALOG_BOX   
3762 @E1D2   AF               XOR   a   
3763 @E1D3   C9               RET      
3764 @E1D4          L_EXECUTE_SST_RENAME:      
3764 @E1D4   CD F0 33         CALL   COPY_SST_BAM_DIR   
3767 @E1D7   CD 8A 37         CALL   setup_string_pointers   
376A @E1DA   11 00 F0         LD   de,BAM_START   ; HL contains the TVC mem pointer of image name
376D @E1DD   B7               OR   a   ; clear C
376E @E1DE   ED 52            SBC   hl,de   
3770 @E1E0   EB               EX   de,hl   
3771 @E1E1   2A 76 33         LD   hl,(BAM_START_SST)   
3774 @E1E4   19               ADD   hl,de   
3775 @E1E5   11 A1 08         LD   de,INPUT_BUFFER   
3778 @E1E8   EB               EX   de,hl   
3779 @E1E9   ED B0            LDIR      
377B @E1EB   CD DB 35         CALL   WRITE_BACK_BAM_SST   
377E @E1EE   CD 95 C7         CALL   print_PRESS_SPACE   
3781 @E1F1   CD A2 CB         CALL   WAIT_FOR_SPACE   
3784 @E1F4   CD DE C4         CALL   F_CLOSE_DIALOG_BOX   
3787 @E1F7   3E 01            LD   a,1   
3789 @E1F9   C9               RET      
378A @E1FA          SETUP_STRING_POINTERS:      
378A @E1FA   3A 83 08         LD   a,(LIST_FIRST_ELEMENT)   
378D @E1FD   47               LD   b,a   
378E @E1FE   3A 85 08         LD   a,(LIST_SELECTED_ELEMENT)   
3791 @E201   80               ADD   a,b   
3792 @E202   11 00 00         LD   de,0   
3795 @E205   CB 27            SLA   a   
3797 @E207   CB 12            RL   d   
3799 @E209   CB 27            SLA   a   
379B @E20B   CB 12            RL   d   
379D @E20D   5F               LD   e,a   
379E @E20E   21 00 4C         LD   hl,CART_NAME_STRUCT   
37A1 @E211   19               ADD   hl,de   
37A2 @E212   23               INC   hl   
37A3 @E213   5E               LD   e,(hl)   
37A4 @E214   23               INC   hl   
37A5 @E215   56               LD   d,(hl)   
37A6 @E216   21 04 00         LD   hl,4   
37A9 @E219   19               ADD   hl,de   
37AA @E21A   01 10 00         LD   bc,$10   
37AD @E21D   11 A1 08         LD   de,INPUT_BUFFER   
37B0 @E220   C9               RET      
37B1 @E221          SETUP_INPUT_FIELD:      
37B1 @E221   CD 8A 37         CALL   setup_string_pointers   
37B4 @E224   ED B0            LDIR      
37B6 @E226   3E 20            LD   a,$20   ; let's find the last non-space
37B8 @E228   01 0F 00         LD   bc,$0f   
37BB @E22B   21 A1 08         LD   hl,INPUT_BUFFER   
37BE @E22E   09               ADD   hl,bc   
37BF @E22F   0C               INC   c   
37C0 @E230          L_STR_END_SEARCH_LOOP:      
37C0 @E230   BE               CP   (hl)   
37C1 @E231   20 04            JR   nz,L_STR_END_SEARCH_LOOP_DONE   
37C3 @E233   2B               DEC   hl   
37C4 @E234   0D               DEC   c   
37C5 @E235   20 F9            JR   nz,L_STR_END_SEARCH_LOOP   
37C7 @E237          L_STR_END_SEARCH_LOOP_DONE:      
37C7 @E237   79               LD   a,c   
37C8 @E238   32 A0 08         LD   (INPUT_BUF_LEN),a   
37CB @E23B   11 A1 08         LD   de,INPUT_BUFFER   
37CE @E23E   AF               XOR   a   
37CF @E23F   CD 04 C7         CALL   F_PRINT_ONE_LINE_IN_DIALOG   
37D2 @E242   0E 7F            LD   c,$7F   
37D4 @E244   F7               RST   $30   
37D5 @E245   21               DB   $21   
37D6 @E246   C9               RET      
37D7 @E247          INPUT_STR:      
37D7 @E247   FB               EI      
37D8 @E248          L_CHECK_TVC_INPUT_BUFFER:      
37D8 @E248   F7               RST   30h   
37D9 @E249   93               DB   $93   
37DA @E24A   AF               XOR   a   
37DB @E24B   B9               CP   c   
37DC @E24C   28 04            JR   z,L_INPUT_STR_LOOP   
37DE @E24E   F7               RST   30h   
37DF @E24F   91               DB   $91   
37E0 @E250   18 F6            JR   L_CHECK_TVC_INPUT_BUFFER   
37E2 @E252          L_INPUT_STR_LOOP:      
37E2 @E252   F7               RST   30h   
37E3 @E253   91               DB   $91   
37E4 @E254   3E 0D            LD   a,$0d   
37E6 @E256   B9               CP   c   
37E7 @E257   28 38            JR   z,L_INPUT_STR_EXIT   
37E9 @E259   3E 08            LD   a,$08   
37EB @E25B   B9               CP   c   
37EC @E25C   28 5E            JR   z,L_INPUT_STR_DEL   
37EE @E25E   3E 1B            LD   a,$1B   
37F0 @E260   B9               CP   c   
37F1 @E261   28 4E            JR   z,L_INPUT_STR_ESC   
37F3 @E263   3E 1F            LD   a,$1F   ; check non-printable characters (crsr move, etc..)
37F5 @E265   B9               CP   c   
37F6 @E266   30 EA            JR   nc,L_INPUT_STR_LOOP   
37F8 @E268   3E A0            LD   a,$A0   
37FA @E26A   B9               CP   c   
37FB @E26B   38 E5            JR   c,L_INPUT_STR_LOOP   
37FD @E26D   3A A0 08         LD   a,(INPUT_BUF_LEN)   
3800 @E270   FE 10            CP   $10   
3802 @E272   28 DE            JR   z,L_INPUT_STR_LOOP   
3804 @E274   3A A0 08         LD   a,(INPUT_BUF_LEN)   
3807 @E277   21 A1 08         LD   hl,INPUT_BUFFER   
380A @E27A   5F               LD   e,a   
380B @E27B   16 00            LD   d,0   
380D @E27D   19               ADD   hl,de   
380E @E27E   71               LD   (hl),c   
380F @E27F   C5               PUSH   bc   
3810 @E280   0E 13            LD   c,$13   
3812 @E282   F7               RST   30h   
3813 @E283   21               DB   $21   
3814 @E284   C1               POP   bc   
3815 @E285   F7               RST   30h   
3816 @E286   21               DB   $21   
3817 @E287   0E 7F            LD   c,$7f   
3819 @E289   F7               RST   30h   
381A @E28A   21               DB   $21   
381B @E28B   21 A0 08         LD   hl,INPUT_BUF_LEN   
381E @E28E   34               INC   (hl)   
381F @E28F   18 C1            JR   L_INPUT_STR_LOOP   
3821 @E291          L_INPUT_STR_EXIT:      
3821 @E291   0E 13            LD   c,$13   
3823 @E293   F7               RST   30h   
3824 @E294   21               DB   $21   
3825 @E295   0E 20            LD   c,$20   
3827 @E297   F7               RST   30h   
3828 @E298   21               DB   $21   
3829 @E299   F3               DI      
382A @E29A   3A A0 08         LD   a,(INPUT_BUF_LEN)   
382D @E29D   FE 10            CP   $10   
382F @E29F   C8               RET   z   
3830 @E2A0   21 A1 08         LD   hl,INPUT_BUFFER   
3833 @E2A3   5F               LD   e,a   
3834 @E2A4   16 00            LD   d,0   
3836 @E2A6   19               ADD   hl,de   
3837 @E2A7   16 20            LD   d,$20   
3839 @E2A9          L_STR_BUFFER_FILL_SPACE_LOOP:      
3839 @E2A9   72               LD   (hl),d   
383A @E2AA   3C               INC   a   
383B @E2AB   23               INC   hl   
383C @E2AC   FE 10            CP   $10   
383E @E2AE   20 F9            JR   nz,L_STR_BUFFER_FILL_SPACE_LOOP   
3840 @E2B0   C9               RET      
3841 @E2B1          L_INPUT_STR_ESC:      
3841 @E2B1   0E 13            LD   c,$13   
3843 @E2B3   F7               RST   30h   
3844 @E2B4   21               DB   $21   
3845 @E2B5   0E 20            LD   c,$20   
3847 @E2B7   F7               RST   30h   
3848 @E2B8   21               DB   $21   
3849 @E2B9   AF               XOR   a   
384A @E2BA   F3               DI      
384B @E2BB   C9               RET      
384C @E2BC          L_INPUT_STR_DEL:      
384C @E2BC   3A A0 08         LD   a,(INPUT_BUF_LEN)   
384F @E2BF   B7               OR   a   
3850 @E2C0   28 90            JR   z,L_INPUT_STR_LOOP   
3852 @E2C2   0E 13            LD   c,$13   
3854 @E2C4   F7               RST   30h   
3855 @E2C5   21               DB   $21   
3856 @E2C6   0E 20            LD   c,$20   
3858 @E2C8   F7               RST   30h   
3859 @E2C9   21               DB   $21   
385A @E2CA   0E 13            LD   c,$13   
385C @E2CC   F7               RST   30h   
385D @E2CD   21               DB   $21   
385E @E2CE   0E 13            LD   c,$13   
3860 @E2D0   F7               RST   30h   
3861 @E2D1   21               DB   $21   
3862 @E2D2   0E 7F            LD   c,$7F   
3864 @E2D4   F7               RST   30h   
3865 @E2D5   21               DB   $21   
3866 @E2D6   21 A0 08         LD   hl,INPUT_BUF_LEN   
3869 @E2D9   35               DEC   (hl)   
386A @E2DA   C3 E2 37         JP   L_INPUT_STR_LOOP   
386D @E2DD          SORT_TYPE_NAME:   EQU   1   
386D @E2DD          SORT_TYPE_SIZE:   EQU   2   
386D @E2DD          SORT_TYPE_TYPE:   EQU   3   
386D @E2DD          INITIAL_SORT_TYPES:      
386D @E2DD   01 02 01 01      DB   1,2,1,1   
3871 @E2E1          TYPE_ORDER:      
3871 @E2E1   02 03 01         DB   2,3,1   ; CART:CAS:BIN
3874 @E2E4          PREVIOUS_SORT_TYPE:      
3874 @E2E4   00               DB   00   
3875 @E2E5          CURRENT_SORT_TYPE:      
3875 @E2E5   00               DB   00   
3876 @E2E6          COMPARE_BY_SIZE:      ; de - hl  -> de < hl:C, de>=hl:c
3876 @E2E6   D5               PUSH   de   
3877 @E2E7   DD E1            POP   ix   
3879 @E2E9   E5               PUSH   hl   
387A @E2EA   FD E1            POP   iy   
387C @E2EC   DD 7E 03         LD   a,(ix+3)   
387F @E2EF   FD BE 03         CP   (iy+3)   
3882 @E2F2   C9               RET      
3883 @E2F3          COMPARE_BY_TYPE:      
3883 @E2F3   D5               PUSH   de   
3884 @E2F4   E5               PUSH   hl   
3885 @E2F5   7E               LD   a,(hl)   ; type of high record
3886 @E2F6   EB               EX   de,hl   
3887 @E2F7   46               LD   b,(hl)   ; type of low record
3888 @E2F8   21 70 38         LD   hl,TYPE_ORDER-1   
388B @E2FB          L_TYPE_LOOP_A:      
388B @E2FB   3D               DEC   a   
388C @E2FC   23               INC   hl   
388D @E2FD   20 FC            JR   nz,L_TYPE_LOOP_A   
388F @E2FF   7E               LD   a,(hl)   
3890 @E300   4F               LD   c,a   ; order of high type
3891 @E301   21 70 38         LD   hl,TYPE_ORDER-1   
3894 @E304          L_TYPE_LOOP_B:      
3894 @E304   2B               DEC   hl   
3895 @E305   10 FD            DJNZ   L_TYPE_LOOP_B   
3897 @E307   7E               LD   a,(hl)   ; order of low type
3898 @E308   B9               CP   c   
3899 @E309   E1               POP   hl   
389A @E30A   D1               POP   de   
389B @E30B   C9               RET      
389C @E30C          COMPARE_BY_NAME:      
389C @E30C   C5               PUSH   bc   
389D @E30D   E5               PUSH   hl   
389E @E30E   D5               PUSH   de   
389F @E30F   CD EA 38         CALL   GET_STRING_POINTER   
38A2 @E312   D1               POP   de   
38A3 @E313   D5               PUSH   de   
38A4 @E314   E5               PUSH   hl   
38A5 @E315   EB               EX   de,hl   
38A6 @E316   CD EA 38         CALL   GET_STRING_POINTER   
38A9 @E319   EB               EX   de,hl   
38AA @E31A   E1               POP   hl   
38AB @E31B   06 10            LD   b,16   
38AD @E31D          L_STR_COMPARE_LOOP:      
38AD @E31D   7E               LD   a,(hl)   
38AE @E31E   CD F4 38         CALL   convert_a   
38B1 @E321   CD C8 38         CALL   modify_char_code   
38B4 @E324   4F               LD   c,a   
38B5 @E325   1A               LD   a,(de)   
38B6 @E326   CD F4 38         CALL   convert_a   
38B9 @E329   CD C8 38         CALL   modify_char_code   
38BC @E32C   B9               CP   c   
38BD @E32D   20 05            JR   nz,L_STR_COMPARE_DONE   
38BF @E32F   23               INC   hl   
38C0 @E330   13               INC   de   
38C1 @E331   05               DEC   b   
38C2 @E332   20 E9            JR   nz,L_STR_COMPARE_LOOP   
38C4 @E334          L_STR_COMPARE_DONE:      
38C4 @E334   D1               POP   de   
38C5 @E335   E1               POP   hl   
38C6 @E336   C1               POP   bc   
38C7 @E337   C9               RET      
38C8 @E338          MODIFY_CHAR_CODE:      
38C8 @E338   FE 61            CP   $61   
38CA @E33A   D8               RET   c   
38CB @E33B   FE 99            CP   $99   
38CD @E33D   D0               RET   nc   
38CE @E33E   E5               PUSH   hl   
38CF @E33F   C5               PUSH   bc   
38D0 @E340   21 40 3A         LD   hl,STR_ABC_ORDER   
38D3 @E343   06 23            LD   b,STR_ABC_ORDER_END-STR_ABC_ORDER   
38D5 @E345          L_SEARCH_CHAR_LOOP:      
38D5 @E345   4E               LD   c,(hl)   
38D6 @E346   23               INC   hl   
38D7 @E347   B9               CP   c   
38D8 @E348   28 0A            JR   z,L_FOUND   
38DA @E34A   10 F9            DJNZ   L_SEARCH_CHAR_LOOP   
38DC @E34C   FE 80            CP   $80   
38DE @E34E   30 07            JR   nc,L_MODIFY_CHAR_END   
38E0 @E350   C6 09            ADD   a,$09   
38E2 @E352   18 03            JR   L_MODIFY_CHAR_END   
38E4 @E354          L_FOUND:      
38E4 @E354   3E 84            LD   a,$61 + STR_ABC_ORDER_END-STR_ABC_ORDER   
38E6 @E356   90               SUB   b   
38E7 @E357          L_MODIFY_CHAR_END:      
38E7 @E357   C1               POP   bc   
38E8 @E358   E1               POP   hl   
38E9 @E359   C9               RET      
38EA @E35A          GET_STRING_POINTER:      
38EA @E35A   23               INC   hl   
38EB @E35B   5E               LD   e,(hl)   
38EC @E35C   23               INC   hl   
38ED @E35D   56               LD   d,(hl)   
38EE @E35E   EB               EX   de,hl   
38EF @E35F   11 04 00         LD   de,0004   
38F2 @E362   19               ADD   hl,de   
38F3 @E363   C9               RET      
38F4 @E364          CONVERT_A:      
38F4 @E364   FE 41            CP   $41   
38F6 @E366   38 07            JR   c,L_NOT_CAPITAL_ASCII   
38F8 @E368   FE 5B            CP   $5b   
38FA @E36A   30 03            JR   nc,L_NOT_CAPITAL_ASCII   
38FC @E36C   C6 20            ADD   a,$20   ; capital, normal letter
38FE @E36E   C9               RET      
38FF @E36F          L_NOT_CAPITAL_ASCII:      
38FF @E36F   FE 80            CP   $80   
3901 @E371   38 06            JR   c,L_NOT_CAPITAL_ACUTE   
3903 @E373   FE 89            CP   $89   
3905 @E375   30 02            JR   nc,L_NOT_CAPITAL_ACUTE   
3907 @E377   C6 10            ADD   a,$10   
3909 @E379          L_NOT_CAPITAL_ACUTE:      
3909 @E379   C9               RET      
390A @E37A          SORT:        
390A @E37A   21 00 4C         LD   hl,CART_NAME_STRUCT   
390D @E37D   11 08 00         LD   de,0008   
3910 @E380   19               ADD   hl,de   
3911 @E381          L_BUBBLE_BIG_LOOP:      
3911 @E381   54               LD   d,h   
3912 @E382   5D               LD   e,l   
3913 @E383          L_BUBBLE_SMALL_LOOP:      
3913 @E383   1B               DEC   de   
3914 @E384   1B               DEC   de   
3915 @E385   1B               DEC   de   
3916 @E386   1B               DEC   de   
3917 @E387   7A               LD   a,d   
3918 @E388   FE 4C            CP   >CART_NAME_STRUCT   
391A @E38A   20 05            JR   nz,L_COMPARE_THEM   
391C @E38C   7B               LD   a,e   
391D @E38D   FE 00            CP   <CART_NAME_STRUCT   
391F @E38F   28 12            JR   z,L_END_ONE_BUBBLE   
3921 @E391          L_COMPARE_THEM:      
3921 @E391   3A 75 38         LD   a,(CURRENT_SORT_TYPE)   
3924 @E394   CD 76 39         CALL   SET_COMPARE_BITS   
3927 @E397   20 08            JR   nz,L_CHECK_C_BIT   
3929 @E399   3A 74 38         LD   a,(PREVIOUS_SORT_TYPE)   
392C @E39C   CD 76 39         CALL   SET_COMPARE_BITS   
392F @E39F   28 02            JR   z,L_END_ONE_BUBBLE   
3931 @E3A1          L_CHECK_C_BIT:      
3931 @E3A1   30 E0            JR   nc,L_BUBBLE_SMALL_LOOP   ; de^ bigger than hl^
3933 @E3A3          L_END_ONE_BUBBLE:      
3933 @E3A3   13               INC   de   
3934 @E3A4   13               INC   de   
3935 @E3A5   13               INC   de   
3936 @E3A6   13               INC   de   
3937 @E3A7   7A               LD   a,d   
3938 @E3A8   BC               CP   h   
3939 @E3A9   20 04            JR   nz,L_INDEED_MOVE_THE_BLOCK   
393B @E3AB   7B               LD   a,e   
393C @E3AC   BD               CP   l   
393D @E3AD   28 2D            JR   z,L_TRANSFER_DONE   ; de and hl are the same. No need to transfer anything
393F @E3AF          L_INDEED_MOVE_THE_BLOCK:      
393F @E3AF   D5               PUSH   de   
3940 @E3B0   E5               PUSH   hl   
3941 @E3B1   01 04 00         LD   bc,4   
3944 @E3B4   11 00 4B         LD   de,STR_TEMP_AREA   
3947 @E3B7   ED B0            LDIR      
3949 @E3B9   E1               POP   hl   
394A @E3BA   D1               POP   de   
394B @E3BB   E5               PUSH   hl   
394C @E3BC   D5               PUSH   de   
394D @E3BD   B7               OR   a   
394E @E3BE   ED 52            SBC   hl,de   
3950 @E3C0   E5               PUSH   hl   
3951 @E3C1   C1               POP   bc   
3952 @E3C2   D1               POP   de   
3953 @E3C3   E1               POP   hl   
3954 @E3C4   E5               PUSH   hl   
3955 @E3C5   D5               PUSH   de   
3956 @E3C6   54               LD   d,h   
3957 @E3C7   5D               LD   e,l   
3958 @E3C8   13               INC   de   
3959 @E3C9   13               INC   de   
395A @E3CA   13               INC   de   
395B @E3CB   2B               DEC   hl   
395C @E3CC   ED B8            LDDR      
395E @E3CE   D1               POP   de   
395F @E3CF   E1               POP   hl   
3960 @E3D0   E5               PUSH   hl   
3961 @E3D1   D5               PUSH   de   
3962 @E3D2   21 00 4B         LD   hl,STR_TEMP_AREA   
3965 @E3D5   01 04 00         LD   bc,4   
3968 @E3D8   ED B0            LDIR      
396A @E3DA   D1               POP   de   
396B @E3DB   E1               POP   hl   
396C @E3DC          L_TRANSFER_DONE:      
396C @E3DC   23               INC   hl   
396D @E3DD   23               INC   hl   
396E @E3DE   23               INC   hl   
396F @E3DF   23               INC   hl   
3970 @E3E0   7E               LD   a,(hl)   
3971 @E3E1   FE 00            CP   0   
3973 @E3E3   20 9C            JR   nz,L_BUBBLE_BIG_LOOP   
3975 @E3E5   C9               RET      
3976 @E3E6                       ; input:
3976 @E3E6                       ;  a - compare type
3976 @E3E6          SET_COMPARE_BITS:      
3976 @E3E6   FE 01            CP   SORT_TYPE_NAME   
3978 @E3E8   20 04            JR   nz,L_SCB_SKIP1   
397A @E3EA   CD 9C 38         CALL   COMPARE_BY_NAME   
397D @E3ED   C9               RET      
397E @E3EE          L_SCB_SKIP1:      
397E @E3EE   FE 02            CP   SORT_TYPE_SIZE   
3980 @E3F0   20 04            JR   nz,L_SCB_SKIP2   
3982 @E3F2   CD 76 38         CALL   COMPARE_BY_SIZE   
3985 @E3F5   C9               RET      
3986 @E3F6          L_SCB_SKIP2:      
3986 @E3F6   CD 83 38         CALL   COMPARE_BY_TYPE   
3989 @E3F9   C9               RET      
398A @E3FA                       ; input:
398A @E3FA                       ;  b - type of sorting
398A @E3FA          F_SORT:      
398A @E3FA   3A 86 08         LD   a,(NUM_OF_IMAGES)   
398D @E3FD   FE 02            CP   2   
398F @E3FF   38 1F            JR   c,L_SORT_DONE   
3991 @E401   3A 75 38         LD   a,(CURRENT_SORT_TYPE)   
3994 @E404   FE 00            CP   0   
3996 @E406   20 08            JR   nz,L_FSBT_CONT   
3998 @E408   21 6D 38         LD   hl,INITIAL_SORT_TYPES   
399B @E40B   58               LD   e,b   
399C @E40C   16 00            LD   d,0   
399E @E40E   19               ADD   hl,de   
399F @E40F   7E               LD   a,(hl)   
39A0 @E410          L_FSBT_CONT:      
39A0 @E410   32 74 38         LD   (PREVIOUS_SORT_TYPE),a   
39A3 @E413   78               LD   a,b   
39A4 @E414   32 75 38         LD   (CURRENT_SORT_TYPE),a   
39A7 @E417   21 74 38         LD   hl,PREVIOUS_SORT_TYPE   
39AA @E41A   BE               CP   (hl)   
39AB @E41B   28 04            JR   z,INVERT_LIST   
39AD @E41D   C3 0A 39         JP   SORT   
39B0 @E420          L_SORT_DONE:      
39B0 @E420   C9               RET      
39B1 @E421          INVERT_LIST:      
39B1 @E421   AF               XOR   a   
39B2 @E422   67               LD   h,a   
39B3 @E423   3A 86 08         LD   a,(NUM_OF_IMAGES)   
39B6 @E426   CB 27            SLA   a   
39B8 @E428   CB 14            RL   h   
39BA @E42A   CB 27            SLA   a   
39BC @E42C   CB 14            RL   h   
39BE @E42E   11 00 4C         LD   de,CART_NAME_STRUCT   
39C1 @E431   6F               LD   l,a   
39C2 @E432   19               ADD   hl,de   
39C3 @E433   E5               PUSH   hl   
39C4 @E434   21 00 4C         LD   hl,CART_NAME_STRUCT   
39C7 @E437   11 04 00         LD   de,0004   
39CA @E43A   19               ADD   hl,de   
39CB @E43B   D1               POP   de   
39CC @E43C   3A 86 08         LD   a,(NUM_OF_IMAGES)   
39CF @E43F   CB 3F            SRL   a   
39D1 @E441          L_INVERT_LOOP:      
39D1 @E441   F5               PUSH   af   
39D2 @E442   06 04            LD   b,4   
39D4 @E444          L_INVERT_LDIR_LOOP:      
39D4 @E444   1A               LD   a,(de)   
39D5 @E445   4E               LD   c,(hl)   
39D6 @E446   77               LD   (hl),a   
39D7 @E447   79               LD   a,c   
39D8 @E448   12               LD   (de),a   
39D9 @E449   23               INC   hl   
39DA @E44A   13               INC   de   
39DB @E44B   10 F7            DJNZ   L_INVERT_LDIR_LOOP   
39DD @E44D   F1               POP   af   
39DE @E44E   3D               DEC   a   
39DF @E44F   28 0A            JR   z,L_INVERT_DONE   
39E1 @E451          L_INVERT_DE_LOOP:      
39E1 @E451   1B               DEC   de   ; 48
39E2 @E452   1B               DEC   de   
39E3 @E453   1B               DEC   de   
39E4 @E454   1B               DEC   de   
39E5 @E455   1B               DEC   de   
39E6 @E456   1B               DEC   de   
39E7 @E457   1B               DEC   de   
39E8 @E458   1B               DEC   de   
39E9 @E459   18 E6            JR   L_INVERT_LOOP   
39EB @E45B          L_INVERT_DONE:      
39EB @E45B   C9               RET      
39EC @E45C          STR_AUTHOR:      
39EC @E45C   62 79 20 53 61 6E 79 69 20 28 32 30 31 38 2D 30 33 2D 33 30 20 2D 20 32 30 31 39 2D 30 38 2D 30 39 29 DB   "by Sanyi (2018-03-30 - 2019-08-09)"   
3A0E @E47E          STR_AUTHOR_END:      
3A0E @E47E          STR_MOPS:      
3A0E @E47E   4D 4F 50 53      DB   "MOPS"   
3A12 @E482          STR_MOPS_END:      
3A12 @E482          STR_TYPE_SIZE_BAS:      
3A12 @E482   2D 2D 2D 2D      DB   "----"   
3A16 @E486          STR_TYPE_SIZE_BAS_END:      
3A16 @E486          STR_TYPE_CART:      
3A16 @E486   43 41 52 54      DB   "CART"   
3A1A @E48A          STR_TYPE_CART_END:      
3A1A @E48A          STR_TYPE_CAS:      
3A1A @E48A   20 43 41 53      DB   " CAS"   
3A1E @E48E          STR_TYPE_CAS_END:      
3A1E @E48E          STR_TYPE_BIN:      
3A1E @E48E   20 42 49 4E      DB   " BIN"   
3A22 @E492          STR_TYPE_BIN_END:      
3A22 @E492          STR_TYPE_DAT:      
3A22 @E492   44 41 54 41      DB   "DATA"   
3A26 @E496          STR_TYPE_DAT_END:      
3A26 @E496          STR_FLASH_IC_SST:      
3A26 @E496   53 53 54 33 39 53 46 30 78 30 DB   "SST39SF0x0"   
3A30 @E4A0          STR_FLASH_IC_SST_END:      
3A30 @E4A0          STR_FLASH_IC_AMD:      
3A30 @E4A0   41 4D 32 39 46 30 78 30 DB   "AM29F0x0"   
3A38 @E4A8          STR_FLASH_IC_AMD_END:      
3A38 @E4A8          STR_FLASH_IC_ATMEL:      
3A38 @E4A8   41 54 32 39 43 30 78 30 DB   "AT29C0x0"   
3A40 @E4B0          STR_FLASH_IC_ATMEL_END:      
3A40 @E4B0          STR_ABC_ORDER:      
3A40 @E4B0   61               DB   "a"   
3A41 @E4B1   90               DB   $90   ; á
3A42 @E4B2   62 63 64 65      DB   "bcde"   
3A46 @E4B6   91               DB   $91   ; é
3A47 @E4B7   66 67 68 69      DB   "fghi"   
3A4B @E4BB   92               DB   $92   ; í
3A4C @E4BC   6A 6B 6C 6D 6E 6F DB   "jklmno"   
3A52 @E4C2   93 94 95         DB   $93,$94,$95   ; ó, ö, ő
3A55 @E4C5   70 71 72 73 74 75 DB   "pqrstu"   
3A5B @E4CB   96 97 98         DB   $96,$97,$98   ; ú, ü, ű
3A5E @E4CE   76 77 78 79 7A   DB   "vwxyz"   
3A63 @E4D3          STR_ABC_ORDER_END:      
3A63 @E4D3                    IF   LANG = EN   
                    EXIT_TO_BASIC:   EQU   " EXIT to BASIC  "   
                    STR_LANG_LETTER:   EQU   "e"   
                    STR_MESSAGE:      
                              DB   "Videoton TV Computer MultiCart ROM selection tool v"   
                    STR_MESSAGE_END:      
                    STR_RAM_FOUND:      
                              DB   "RAM detected: "   
                    STR_RAM_FOUND_END:      
                    STR_FLASH_FOUND:      
                              DB   "Flash detected: "   
                    STR_FLASH_FOUND_END:      
                    STR_FREE_SPACE:      
                              DB   "Free space on cart: "   
                    STR_FREE_SPACE_END:      
                    STR_BLOCKS:      
                              DB   " blocks"   
                    STR_BLOCKS_END:      
                    STR_FLASH_SIZES:      
                              DB   "none "   
                              DB   "128kB"   
                              DB   "256kB"   
                              DB   "512kB"   
                    FLASH_SIZES_POS:      
                              DW   STR_FLASH_SIZES,STR_FLASH_SIZES+5,STR_FLASH_SIZES+10,STR_FLASH_SIZES,STR_FLASH_SIZES+15   
                    STR_RAM_SIZES:      
                              DB   " none"   
                              DB   "  8kB"   
                              DB   " "   
                    STR_CART_SIZE:      
                              DB   "16kB"   
                              DB   " 32kB"   
                              DB   " 64kB"   
                              DB   "128kB"   
                              DB   "256kB"   
                              DB   "512kB"   
                    RAM_SIZES_POS:      
                                 ;                   nincs        ,8kB            ,16kB            ,32kB            ,64kB            ,128kB           ,256kB           ,512kB
                              DW   STR_RAM_SIZES,STR_RAM_SIZES+5,STR_RAM_SIZES+10,STR_RAM_SIZES+15,STR_RAM_SIZES+20,STR_RAM_SIZES+25,STR_RAM_SIZES+30,STR_RAM_SIZES+35   
                    STR_NAME:      
                              DB   "Name"   
                    STR_NAME_END:      
                    STR_SIZE:      
                              DB   "Size"   
                    STR_SIZE_END:      
                    STR_TYPE:      
                              DB   "Type"   
                    STR_TYPE_END:      
                    STR_USAGE:      
                              DB   "Usage:"   
                    STR_USAGE_END:      
                    STR_UPDN:      
                              DB   "Up/Down: A/Y or Joy Up/Down"   
                    STR_UPDN_END:      
                    STR_PGUPDN:      
                              DB   "Page up/down: "   
                              DB   129   
                              DB   "/: or Joy L/R"   
                    STR_PGUPDN_END:      
                    STR_TOGGLE_RESET:      
                              DB   "Toggle reset enable: Space"   
                    STR_TOGGLE_RESET_END:      
                    STR_START_PROGRAM:      
                              DB   "Start selected image: Return"   
                    STR_START_PROGRAM_END:      
                    STR_DELETE_PROGRAM:      
                              DB   "Delete selected image: Del"   
                    STR_DELETE_PROGRAM_END:      
                    STR_SORT_INSTRUCTIONS:      
                              DB   "Sort by Name,Type,Size: N,T,S"   
                    STR_SORT_INSTRUCTIONS_END:      
                    STR_SORT_RESET:      
                              DB   "Reset to Original order: O"   
                    STR_SORT_RESET_END:      
                    STR_RENAME:      
                              DB   "Rename selected file: R"   
                    STR_RENAME_END:      
                    STR_RESET_CART:      
                              DB   "Reset MultiCart on TVC reset: "   
                    STR_RESET_CART_END:      
                    STR_ENABLED:      
                              DB   "YES"   
                    STR_ENABLED_END:      
                    STR_DISABLED:      
                              DB   "NO "   
                    STR_DISABLED_END:      
                    STR_RAM_TEST:      
                              DB   "RAMTEST"   
                    STR_RAM_TEST_END:      
                    TEST_CONTENT:      
                              DB   "Test content, FLASH WRITTEN!..."   
                    TEST_CONTENT_END:      
                    STR_DELETE_QUESTION:      
                              DB   "Do you want to remove file:"   
                    STR_DELETE_QUESTION_END:      
                    STR_DELETE_ANSWER:      
                              DB   "Y/N"   
                    STR_DELETE_ANSWER_END:      
                    STR_FOUND_FLASH_CHIP:      
                              DB   "Found flash IC: "   
                    STR_FOUND_FLASH_CHIP_END:      
                    STR_FLASH_IC_UNKNOWN:      
                              DB   "unknown"   
                    STR_FLASH_IC_UNKNOWN_END:      
                    STR_FLASH_CREATE_WORK_COPY:      
                              DB   "Creating working copy..."   
                    STR_FLASH_CREATE_WORK_COPY_END:      
                    STR_FLASH_MODIFY_FS:      
                              DB   "Removing file from filesystem..."   
                    STR_FLASH_MODIFY_FS_END:      
                    STR_FLASH_UPDATE:      
                              DB   "Writing back data to flash IC..."   
                    STR_FLASH_UPDATE_END:      
                    STR_FLASH_DONE:      
                              DB   "Done."   
                    STR_FLASH_DONE_END:      
                    STR_FLASH_NOT_SUPPORTED:      
                              DB   "Deleting file is not supported."   
                    STR_FLASH_NOT_SUPPORTED_END:      
                    STR_FLASH_PRESS_SPACE:      
                              DB   "Press SPACE to continue!"   
                    STR_FLASH_PRESS_SPACE_END:      
                    STR_FLASH_RENAME_NOT_SUPPORTED:      
                              DB   "Renaming file is not supported."   
                    STR_FLASH_RENAME_NOT_SUPPORTED_END:      
                    STR_RENAME_Q_NEW_NAME:      
                              DB   "Enter the new name of the file:"   
                    STR_RENAME_Q_NEW_NAME_END:      
                    STR_RENAME_Q_INSTRUCTION:      
                              DB   "  (max 16 chars, ESC: cancel)"   
                    STR_RENAME_Q_INSTRUCTION_END:      
                    STR_TEST_CART_RAM:      
                              DB   "Test Cart RAM: M"   
                    STR_TEST_CART_RAM_END:      
                    STR_PASSED_SO_FAR:      
                              DB   "Passed: "   
                    STR_PASSED_SO_FAR_END:      
                    STR_TESTING_RAM:      
                              DB   "Testing MultiCart RAM..."   
                    STR_TESTING_RAM_END:      
                    STR_RAM_TEST_OK:      
                              DB   "MultiCart RAM test PASSED !"   
                    STR_RAM_TEST_OK_END:      
                    STR_RAM_TEST_NOK:      
                              DB   "MULTICART RAM TEST FAILED !!!"   
                    STR_RAM_TEST_NOK_END:      
3A63 @E4D3                    ENDIF      
3A63 @E4D3                    IF   LANG = HU   
3A63 @E4D3          EXIT_TO_BASIC:   EQU   "KIL\u0081P\u0081S BASIC-be"   
3A63 @E4D3          STR_LANG_LETTER:   EQU   "h"   
3A63 @E4D3          STR_MESSAGE:      
3A63 @E4D3   56 69 64 65 6F 74 6F 6E 20 54 56 20 43 6F 6D 70 75 74 65 72 20 4D 75 6C 74 69 43 61 72 74 20 52 4F 4D 20 73 65 6C 65 63 74 69 6F 6E 20 74 6F 6F 6C 20 76 DB   "Videoton TV Computer MultiCart ROM selection tool v"   
3A96 @E506          STR_MESSAGE_END:      
3A96 @E506          STR_RAM_FOUND:      
3A96 @E506   46 65 6C 69 73 6D 65 72 74 20 52 41 4D 3A 20 DB   "Felismert RAM: "   
3AA5 @E515          STR_RAM_FOUND_END:      
3AA5 @E515          STR_FLASH_FOUND:      
3AA5 @E515   46 65 6C 69 73 6D 65 72 74 20 66 6C 61 73 68 3A 20 DB   "Felismert flash: "   
3AB6 @E526          STR_FLASH_FOUND_END:      
3AB6 @E526          STR_FREE_SPACE:      
3AB6 @E526   53 7A 61 62 61 64 20 74 65 72 97 6C 65 74 20 61 20 6D 6F 64 75 6C 6F 6E 3A 20 DB   "Szabad ter\u0097let a modulon: "   
3AD0 @E540          STR_FREE_SPACE_END:      
3AD0 @E540          STR_BLOCKS:      
3AD0 @E540   20 62 6C 6F 6B 6B DB   " blokk"   
3AD6 @E546          STR_BLOCKS_END:      
3AD6 @E546          STR_FLASH_SIZES:      
3AD6 @E546   6E 69 6E 63 73   DB   "nincs"   
3ADB @E54B   31 32 38 6B 42   DB   "128kB"   
3AE0 @E550   32 35 36 6B 42   DB   "256kB"   
3AE5 @E555   35 31 32 6B 42   DB   "512kB"   
3AEA @E55A          FLASH_SIZES_POS:      
3AEA @E55A   D6 3A DB 3A E0 3A D6 3A E5 3A DW   STR_FLASH_SIZES,STR_FLASH_SIZES+5,STR_FLASH_SIZES+10,STR_FLASH_SIZES,STR_FLASH_SIZES+15   
3AF4 @E564          STR_RAM_SIZES:      
3AF4 @E564   6E 69 6E 63 73   DB   "nincs"   
3AF9 @E569   20 20 38 6B 42   DB   "  8kB"   
3AFE @E56E   20               DB   " "   
3AFF @E56F          STR_CART_SIZE:      
3AFF @E56F   31 36 6B 42      DB   "16kB"   
3B03 @E573   20 33 32 6B 42   DB   " 32kB"   
3B08 @E578   20 36 34 6B 42   DB   " 64kB"   
3B0D @E57D   31 32 38 6B 42   DB   "128kB"   
3B12 @E582   32 35 36 6B 42   DB   "256kB"   
3B17 @E587   35 31 32 6B 42   DB   "512kB"   
3B1C @E58C          RAM_SIZES_POS:      
3B1C @E58C                       ;                   nincs        ,8kB            ,16kB            ,32kB            ,64kB            ,128kB           ,256kB           ,512kB
3B1C @E58C   F4 3A F9 3A FE 3A 03 3B 08 3B 0D 3B 12 3B 17 3B DW   STR_RAM_SIZES,STR_RAM_SIZES+5,STR_RAM_SIZES+10,STR_RAM_SIZES+15,STR_RAM_SIZES+20,STR_RAM_SIZES+25,STR_RAM_SIZES+30,STR_RAM_SIZES+35   
3B2C @E59C          STR_NAME:      
3B2C @E59C   4E 91 76         DB   "N\u0091v"   
3B2F @E59F          STR_NAME_END:      
3B2F @E59F          STR_SIZE:      
3B2F @E59F   4D 91 72 2E      DB   "M\u0091r."   
3B33 @E5A3          STR_SIZE_END:      
3B33 @E5A3          STR_TYPE:      
3B33 @E5A3   54 92 70 2E      DB   "T\u0092p."   
3B37 @E5A7          STR_TYPE_END:      
3B37 @E5A7          STR_USAGE:      
3B37 @E5A7   48 61 73 7A 6E 90 6C 61 74 69 20 75 74 61 73 92 74 90 73 3A DB   "Haszn\u0090lati utas\u0092t\u0090s:"   
3B4B @E5BB          STR_USAGE_END:      
3B4B @E5BB          STR_UPDN:      
3B4B @E5BB   46 65 6C 2F 4C 65 3A 20 41 2F 59 20 76 61 67 79 20 4A 6F 79 20 46 65 6C 2F 4C 65 DB   "Fel/Le: A/Y vagy Joy Fel/Le"   
3B66 @E5D6          STR_UPDN_END:      
3B66 @E5D6          STR_PGUPDN:      
3B66 @E5D6   4C 61 70 6F 7A 90 73 3A 20 DB   "Lapoz\u0090s: "   
3B6F @E5DF   81               DB   129   
3B70 @E5E0   2F 3A 20 76 2E 20 4A 6F 79 20 42 61 6C 2F 4A 6F 62 62 DB   "/: v. Joy Bal/Jobb"   
3B82 @E5F2          STR_PGUPDN_END:      
3B82 @E5F2          STR_TOGGLE_RESET:      
3B82 @E5F2   52 65 73 65 74 20 65 6E 67 65 64 2F 74 69 6C 74 3A 20 53 70 61 63 65 DB   "Reset enged/tilt: Space"   
3B99 @E609          STR_TOGGLE_RESET_END:      
3B99 @E609          STR_START_PROGRAM:      
3B99 @E609   4B 69 6A 65 6C 94 6C 74 20 70 72 6F 67 2E 69 6E 64 92 74 90 73 61 3A 52 65 74 75 72 6E DB   "Kijel\u0094lt prog.ind\u0092t\u0090sa:Return"   
3BB6 @E626          STR_START_PROGRAM_END:      
3BB6 @E626          STR_DELETE_PROGRAM:      
3BB6 @E626   4B 69 6A 65 6C 94 6C 74 20 70 72 6F 67 2E 20 74 94 72 6C 91 73 65 3A 20 44 65 6C DB   "Kijel\u0094lt prog. t\u0094rl\u0091se: Del"   
3BD1 @E641          STR_DELETE_PROGRAM_END:      
3BD1 @E641          STR_SORT_INSTRUCTIONS:      
3BD1 @E641   52 65 6E 64 65 7A 91 73 20 28 4E 91 76 2C 54 92 70 2C 4D 91 72 29 3A 4E 2C 54 2C 53 DB   "Rendez\u0091s (N\u0091v,T\u0092p,M\u0091r):N,T,S"   
3BED @E65D          STR_SORT_INSTRUCTIONS_END:      
3BED @E65D          STR_SORT_RESET:      
3BED @E65D   45 72 65 64 65 74 69 20 73 6F 72 72 65 6E 64 3A 20 4F DB   "Eredeti sorrend: O"   
3BFF @E66F          STR_SORT_RESET_END:      
3BFF @E66F          STR_RENAME:      
3BFF @E66F   4B 69 6A 65 6C 94 6C 74 20 70 72 6F 67 2E 20 90 74 6E 65 76 65 7A 91 73 65 3A 20 52 DB   "Kijel\u0094lt prog. \u0090tnevez\u0091se: R"   
3C1B @E68B          STR_RENAME_END:      
3C1B @E68B          STR_RESET_CART:      
3C1B @E68B   4D 75 6C 74 69 43 61 72 74 20 72 65 73 65 74 20 68 61 20 54 56 43 20 72 65 73 65 74 3A 20 DB   "MultiCart reset ha TVC reset: "   
3C39 @E6A9          STR_RESET_CART_END:      
3C39 @E6A9          STR_ENABLED:      
3C39 @E6A9   49 67 65 6E      DB   "Igen"   
3C3D @E6AD          STR_ENABLED_END:      
3C3D @E6AD          STR_DISABLED:      
3C3D @E6AD   4E 65 6D 20      DB   "Nem "   
3C41 @E6B1          STR_DISABLED_END:      
3C41 @E6B1          STR_RAM_TEST:      
3C41 @E6B1   52 41 4D 54 45 53 54 DB   "RAMTEST"   
3C48 @E6B8          STR_RAM_TEST_END:      
3C48 @E6B8          TEST_CONTENT:      
3C48 @E6B8   54 65 73 74 20 63 6F 6E 74 65 6E 74 2C 20 46 4C 41 53 48 20 57 52 49 54 54 45 4E 21 2E 2E 2E DB   "Test content, FLASH WRITTEN!..."   
3C67 @E6D7          TEST_CONTENT_END:      
3C67 @E6D7          STR_DELETE_QUESTION:      
3C67 @E6D7   4C 65 20 61 6B 61 72 6F 64 20 74 94 72 94 6C 6E 69 20 65 7A 74 20 61 20 66 69 6C 65 2D 74 3F DB   "Le akarod t\u0094r\u0094lni ezt a file-t?"   
3C86 @E6F6          STR_DELETE_QUESTION_END:      
3C86 @E6F6          STR_DELETE_ANSWER:      
3C86 @E6F6   59 2F 4E         DB   "Y/N"   
3C89 @E6F9          STR_DELETE_ANSWER_END:      
3C89 @E6F9          STR_FOUND_FLASH_CHIP:      
3C89 @E6F9   46 65 6C 69 73 6D 65 72 74 20 46 6C 61 73 68 20 49 43 3A 20 DB   "Felismert Flash IC: "   
3C9D @E70D          STR_FOUND_FLASH_CHIP_END:      
3C9D @E70D          STR_FLASH_IC_UNKNOWN:      
3C9D @E70D   69 73 6D 65 72 65 74 6C 65 6E DB   "ismeretlen"   
3CA7 @E717          STR_FLASH_IC_UNKNOWN_END:      
3CA7 @E717          STR_FLASH_CREATE_WORK_COPY:      
3CA7 @E717   4D 75 6E 6B 61 74 65 72 97 6C 65 74 20 6C 91 74 72 65 68 6F 7A 90 73 61 2E 2E 2E DB   "Munkater\u0097let l\u0091trehoz\u0090sa..."   
3CC2 @E732          STR_FLASH_CREATE_WORK_COPY_END:      
3CC2 @E732          STR_FLASH_MODIFY_FS:      
3CC2 @E732   46 69 6C 65 20 74 94 72 6C 91 73 65 20 61 20 66 69 6C 65 72 65 6E 64 73 7A 65 72 62 95 6C 2E 2E DB   "File t\u0094rl\u0091se a filerendszerb\u0095l.."   
3CE2 @E752          STR_FLASH_MODIFY_FS_END:      
3CE2 @E752          STR_FLASH_UPDATE:      
3CE2 @E752   41 64 61 74 20 76 69 73 73 7A 61 92 72 90 73 61 20 61 7A 20 49 43 72 65 2E 2E 2E DB   "Adat vissza\u0092r\u0090sa az ICre..."   
3CFD @E76D          STR_FLASH_UPDATE_END:      
3CFD @E76D          STR_FLASH_DONE:      
3CFD @E76D   4B 91 73 7A 2E   DB   "K\u0091sz."   
3D02 @E772          STR_FLASH_DONE_END:      
3D02 @E772          STR_FLASH_NOT_SUPPORTED:      
3D02 @E772   46 69 6C 65 20 74 94 72 6C 91 73 20 6E 65 6D 20 74 90 6D 6F 67 61 74 6F 74 74 2E DB   "File t\u0094rl\u0091s nem t\u0090mogatott."   
3D1D @E78D          STR_FLASH_NOT_SUPPORTED_END:      
3D1D @E78D          STR_FLASH_PRESS_SPACE:      
3D1D @E78D   41 20 66 6F 6C 79 74 61 74 90 73 68 6F 7A 20 6E 79 6F 6D 6A 20 53 50 41 43 45 20 2D 74 21 DB   "A folytat\u0090shoz nyomj SPACE -t!"   
3D3B @E7AB          STR_FLASH_PRESS_SPACE_END:      
3D3B @E7AB          STR_FLASH_RENAME_NOT_SUPPORTED:      
3D3B @E7AB   46 69 6C 65 20 90 74 6E 65 76 65 7A 91 73 65 20 6E 65 6D 20 74 90 6D 6F 67 61 74 6F 74 74 2E DB   "File \u0090tnevez\u0091se nem t\u0090mogatott."   
3D5A @E7CA          STR_FLASH_RENAME_NOT_SUPPORTED_END:      
3D5A @E7CA          STR_RENAME_Q_NEW_NAME:      
3D5A @E7CA   82 72 64 20 62 65 20 61 20 66 69 6C 65 20 96 6A 20 6E 65 76 91 74 3A DB   "\u0082rd be a file \u0096j nev\u0091t:"   
3D71 @E7E1          STR_RENAME_Q_NEW_NAME_END:      
3D71 @E7E1          STR_RENAME_Q_INSTRUCTION:      
3D71 @E7E1   28 6D 61 78 20 31 36 20 63 68 61 72 2C 20 45 53 43 3A 20 6B 69 6C 91 70 91 73 29 DB   "(max 16 char, ESC: kil\u0091p\u0091s)"   
3D8C @E7FC          STR_RENAME_Q_INSTRUCTION_END:      
3D8C @E7FC          STR_TEST_CART_RAM:      
3D8C @E7FC   43 61 72 74 20 52 41 4D 20 65 6C 6C 65 6E 95 72 7A 91 73 3A 20 4D DB   "Cart RAM ellen\u0095rz\u0091s: M"   
3DA2 @E812          STR_TEST_CART_RAM_END:      
3DA2 @E812          STR_PASSED_SO_FAR:      
3DA2 @E812   52 65 6E 64 62 65 6E 3A 20 DB   "Rendben: "   
3DAB @E81B          STR_PASSED_SO_FAR_END:      
3DAB @E81B          STR_TESTING_RAM:      
3DAB @E81B   4D 75 6C 74 69 43 61 72 74 20 52 41 4D 20 65 6C 6C 65 6E 95 72 7A 91 73 65 2E 2E 2E DB   "MultiCart RAM ellen\u0095rz\u0091se..."   
3DC7 @E837          STR_TESTING_RAM_END:      
3DC7 @E837          STR_RAM_TEST_OK:      
3DC7 @E837   4D 75 6C 74 69 43 61 72 74 20 52 41 4D 20 68 65 6C 79 65 73 65 6E 20 6D 98 6B 94 64 69 6B 20 21 DB   "MultiCart RAM helyesen m\u0098k\u0094dik !"   
3DE7 @E857          STR_RAM_TEST_OK_END:      
3DE7 @E857          STR_RAM_TEST_NOK:      
3DE7 @E857   43 41 52 54 20 52 41 4D 20 54 45 53 5A 54 20 53 49 4B 45 52 54 45 4C 45 4E 20 21 21 21 DB   "CART RAM TESZT SIKERTELEN !!!"   
3E04 @E874          STR_RAM_TEST_NOK_END:      
3E04 @E874                       ; á 90   é 91   í 92   ó 93   ö 94   ő 95   ú 96  ü 97  ű 98
3E04 @E874                    ENDIF      
3E04 @E874                    IF   LANG = ES   
                    EXIT_TO_BASIC:   EQU   " SALIR a BASIC  "   
                    STR_LANG_LETTER:   EQU   "s"   
                    STR_MESSAGE:      
                              DB   "Aplicacion para el MultiCart de Videoton TVC v"   
                    STR_MESSAGE_END:      
                    STR_RAM_FOUND:      
                              DB   "RAM encontrado: "   
                    STR_RAM_FOUND_END:      
                    STR_FLASH_FOUND:      
                              DB   "Flash encontrado: "   
                    STR_FLASH_FOUND_END:      
                    STR_FREE_SPACE:      
                              DB   "Espacio libre: "   
                    STR_FREE_SPACE_END:      
                    STR_BLOCKS:      
                              DB   " bloques"   
                    STR_BLOCKS_END:      
                    STR_FLASH_SIZES:      
                              DB   "nada "   
                              DB   "128kB"   
                              DB   "256kB"   
                              DB   "512kB"   
                    FLASH_SIZES_POS:      
                              DW   STR_FLASH_SIZES,STR_FLASH_SIZES+5,STR_FLASH_SIZES+10,STR_FLASH_SIZES,STR_FLASH_SIZES+15   
                    STR_RAM_SIZES:      
                              DB   " nada"   
                              DB   "  8kB"   
                              DB   " "   
                    STR_CART_SIZE:      
                              DB   "16kB"   
                              DB   " 32kB"   
                              DB   " 64kB"   
                              DB   "128kB"   
                              DB   "256kB"   
                              DB   "512kB"   
                    RAM_SIZES_POS:      
                                 ;                   nincs        ,8kB            ,16kB            ,32kB            ,64kB            ,128kB           ,256kB           ,512kB
                              DW   STR_RAM_SIZES,STR_RAM_SIZES+5,STR_RAM_SIZES+10,STR_RAM_SIZES+15,STR_RAM_SIZES+20,STR_RAM_SIZES+25,STR_RAM_SIZES+30,STR_RAM_SIZES+35   
                    STR_NAME:      
                              DB   "Nombre"   
                    STR_NAME_END:      
                    STR_SIZE:      
                              DB   "Tam."   
                    STR_SIZE_END:      
                    STR_TYPE:      
                              DB   "Tipo"   
                    STR_TYPE_END:      
                    STR_USAGE:      
                              DB   "Teclas:"   
                    STR_USAGE_END:      
                    STR_UPDN:      
                              DB   "Subir(A)/Bajar(Y) o joystick"   
                    STR_UPDN_END:      
                    STR_PGUPDN:      
                              DB   "Re Pag/Av Pag "   
                              DB   129   
                              DB   "/: o joy I/D"   
                    STR_PGUPDN_END:      
                    STR_TOGGLE_RESET:      
                              DB   "Cambiar funcion de reset: Spc"   
                    STR_TOGGLE_RESET_END:      
                    STR_START_PROGRAM:      
                              DB   "Seleccionar imagen: Intro"   
                    STR_START_PROGRAM_END:      
                    STR_DELETE_PROGRAM:      
                              DB   "Eliminar la imagen: Del"   
                    STR_DELETE_PROGRAM_END:      
                    STR_SORT_INSTRUCTIONS:      
                              DB   "Ordenar (N)om,(T)ipo,tam(S)"   
                    STR_SORT_INSTRUCTIONS_END:      
                    STR_SORT_RESET:      
                              DB   "Deshacer (O)rdenacion"   
                    STR_SORT_RESET_END:      
                    STR_RENAME:      
                              DB   "(R)enombrar archivo seleccio."   
                    STR_RENAME_END:      
                    STR_RESET_CART:      
                              DB   "Reiniciar MultiCart al resetear TVC: "   
                    STR_RESET_CART_END:      
                    STR_ENABLED:      
                              DB   "SI"   
                    STR_ENABLED_END:      
                    STR_DISABLED:      
                              DB   "NO "   
                    STR_DISABLED_END:      
                    STR_RAM_TEST:      
                              DB   "RAMTEST"   
                    STR_RAM_TEST_END:      
                    TEST_CONTENT:      
                              DB   "Comprobando, FLASH GRABADA!"   
                    TEST_CONTENT_END:      
                    STR_DELETE_QUESTION:      
                              DB   "Quieres borrar el archivo:"   
                    STR_DELETE_QUESTION_END:      
                    STR_DELETE_ANSWER:      
                              DB   "Y/N"   
                    STR_DELETE_ANSWER_END:      
                    STR_FOUND_FLASH_CHIP:      
                              DB   "Flash encontrado: "   
                    STR_FOUND_FLASH_CHIP_END:      
                    STR_FLASH_IC_UNKNOWN:      
                              DB   "desconocido"   
                    STR_FLASH_IC_UNKNOWN_END:      
                    STR_FLASH_CREATE_WORK_COPY:      
                              DB   "Generando copia de trabajo..."   
                    STR_FLASH_CREATE_WORK_COPY_END:      
                    STR_FLASH_MODIFY_FS:      
                              DB   "Eliminando archivo..."   
                    STR_FLASH_MODIFY_FS_END:      
                    STR_FLASH_UPDATE:      
                              DB   "Escribiendo en la flash..."   
                    STR_FLASH_UPDATE_END:      
                    STR_FLASH_DONE:      
                              DB   "Hecho"   
                    STR_FLASH_DONE_END:      
                    STR_FLASH_NOT_SUPPORTED:      
                              DB   "No se puede borrar archivo"   
                    STR_FLASH_NOT_SUPPORTED_END:      
                    STR_FLASH_PRESS_SPACE:      
                              DB   "ESPACIO para continuar!"   
                    STR_FLASH_PRESS_SPACE_END:      
                    STR_FLASH_RENAME_NOT_SUPPORTED:      
                              DB   "No se puede renombrar archivo"   
                    STR_FLASH_RENAME_NOT_SUPPORTED_END:      
                    STR_RENAME_Q_NEW_NAME:      
                              DB   "Nuevo nombre:"   
                    STR_RENAME_Q_NEW_NAME_END:      
                    STR_RENAME_Q_INSTRUCTION:      
                              DB   "  (max 16 cars, ESC: cancel)"   
                    STR_RENAME_Q_INSTRUCTION_END:      
                    STR_TEST_CART_RAM:      
                              DB   "Comprobar RAM: M"   
                    STR_TEST_CART_RAM_END:      
                    STR_PASSED_SO_FAR:      
                              DB   "OK: "   
                    STR_PASSED_SO_FAR_END:      
                    STR_TESTING_RAM:      
                              DB   "Comprobando RAM del MultiCart"   
                    STR_TESTING_RAM_END:      
                    STR_RAM_TEST_OK:      
                              DB   "RAM del MultiCart OK !"   
                    STR_RAM_TEST_OK_END:      
                    STR_RAM_TEST_NOK:      
                              DB   "Error en la RAM del MULTICART !!!"   
                    STR_RAM_TEST_NOK_END:      
3E04 @E874                    ENDIF      
3E04 @E874          F_REWRITE_FLASH:      
3E04 @E874   CD 20 3E         CALL   f_winbond_write_128   
3E07 @E877   3E 00            LD   A,0   
3E09 @E879   32 00 C0         LD   (register),A   
3E0C @E87C   01 1F 00         LD   bc,TEST_CONTENT_END-TEST_CONTENT   
3E0F @E87F   21 48 3C         LD   hl,TEST_CONTENT   
3E12 @E882   11 00 CC         LD   de,$CC00   
3E15 @E885   ED B0            LDIR      
3E17 @E887   01 10 00         LD   bc,$0010   
3E1A @E88A          WAITREWRITE:      
3E1A @E88A   10 FE            DJNZ   WAITREWRITE   
3E1C @E88C   0D               DEC   C   
3E1D @E88D   20 FB            JR   nz,WAITREWRITE   
3E1F @E88F   C9               RET      
3E20 @E890          F_WINBOND_WRITE_128:      
3E20 @E890                       ;5555 AA
3E20 @E890                       ;2AAA 55
3E20 @E890                       ;5555 A0
3E20 @E890   21 55 55         LD   hl,$5555   
3E23 @E893   16 AA            LD   d,$aa   
3E25 @E895   CD AF 30         CALL   f_set_pages   
3E28 @E898   21 AA 2A         LD   hl,$2AAA   
3E2B @E89B   16 55            LD   d,$55   
3E2D @E89D   CD AF 30         CALL   f_set_pages   
3E30 @E8A0   21 55 55         LD   hl,$5555   
3E33 @E8A3   16 A0            LD   d,$A0   
3E35 @E8A5   CD AF 30         CALL   f_set_pages   
3E38 @E8A8   C9               RET      
3E39 @E8A9          END_RELOC:      
3E39 @E8A9                    .DEPHASE      
E8A9                          .ENT   TEST_GET_DIRS   
E8A9                          .ENT   TEST_COPY_NO_FILE   
E8A9                          .ENT   TEST_COPY_FILE   
E8A9                          .ENT   TEST_LOAD_BIN_FILE   
1000                          .ORG   $1000   
1000                TEST_DIR_STRUCT:      
1000                          DS   22   
1016                TEST_GET_DIRS:      
1016   11 00 10               LD   de,TEST_DIR_STRUCT   
1019   CD 1D D6               CALL   GET_FIRST_DIRECTORY_ENTRY   
101C   CD 53 D6               CALL   GET_NEXT_DIRECTORY_ENTRY   
101F   CD 53 D6               CALL   GET_NEXT_DIRECTORY_ENTRY   
1022   CD 53 D6               CALL   GET_NEXT_DIRECTORY_ENTRY   
1025   CD 53 D6               CALL   GET_NEXT_DIRECTORY_ENTRY   
1028   CD 53 D6               CALL   GET_NEXT_DIRECTORY_ENTRY   
102B                TEST_DIR_LOOP:      
102B   18 FE                  JR   test_DIR_loop   
102D                TEST_NO_FILE_STRUCT:      
102D   00 20                  DW   $2000   
102F   00 10                  DW   $1000   
1031   02                     DB   $02   
1032   6E 6F 20 66 69 6C 65 20 70 72 65 73 65 6E 74 DB   "no file present"   
1041   00                     DB   0   
1042                TEST_COPY_NO_FILE:      
1042   11 2D 10               LD   de,TEST_NO_FILE_STRUCT   
1045   CD 84 D6               CALL   LOAD_FILE_TO_TVCRAM   
1048                TEST_LOAD_NO_FILE_LOOP:      
1048   18 FE                  JR   test_Load_no_file_loop   
104A                TEST_COPY_FILE_STRUCT:      
104A   00 20                  DW   $2000   
104C   00 F0                  DW   $F000   
104E   03                     DB   $03   
104F   72 6C 61 64 61 72      DB   "rladar"   
1055   00                     DB   0   
1056                TEST_COPY_FILE:      
1056   11 4A 10               LD   de,TEST_COPY_FILE_STRUCT   
1059   CD 84 D6               CALL   LOAD_FILE_TO_TVCRAM   
105C                TEST_LOAD_FILE_LOOP:      
105C   18 FE                  JR   test_Load_file_loop   
105E                TEST_LOAD_BIN_FILE_STRUCT:      
105E   00 20                  DW   $2000   
1060   00 00                  DW   $0000   
1062   04                     DB   $04   
1063   7A 6F 6C 69            DB   "zoli"   
1067   00                     DB   0   
1068                TEST_LOAD_BIN_FILE:      
1068   11 5E 10               LD   de,TEST_LOAD_BIN_FILE_STRUCT   
106B   CD 84 D6               CALL   LOAD_FILE_TO_TVCRAM   
106E                TEST_LOAD_BIN_FILE_LOOP:      
106E   18 FE                  JR   TEST_LOAD_BIN_FILE_LOOP   
FA00                          .ORG   $FA00   
FA00                             ; <last block>, <size of block>, <BASIC program: 10 PRINT 5>
FA00   01 3B 07 0A 00 DD 20 35 FF 00 DB   $01,$3B,$07,$0A,$00,$DD,$20,$35,$FF,$00   
FB00                          .ORG   $FB00   
FB00                             ; <last block>, <size of block>, <BASIC program: 10 PRINT 5>
FB00   FF 08 07 0A 00 DD 20 35 FF 00 DB   $FF,$08,$07,$0A,$00,$DD,$20,$35,$FF,$00   
FC00                          .ORG   $FC00   
FC00                             ; <last block>, <size of block>, <BASIC program: 10 PRINT 5>
FC00   FF 0A EF 19 07 0A 00 DD 20 35 FF 00 DB   $FF,$0A,$EF,$19,$07,$0A,$00,$DD,$20,$35,$FF,$00   
EF00                          .ORG   $EF00   
EF00                PRINTPRG:      ; <last block>, <size of block>, <BASIC program: 10 PRINT 5>
EF00   FF 08 07 0A 00 DD 20 35 FF 00 DB   $FF,$08,$07,$0A,$00,$DD,$20,$35,$FF,$00   
EF0A                             ;            .org $C000 + 60*$100
EF0A                             ;            db 1,61
EF0A                             ;            .org $C000 + 61*$100
EF0A                             ;            db $ff,0
F000                          .ORG   BAM_START   ; sector #2
F000   FF FF FF FF FF FF FF FF FILL   $FF,8   ; first bank is allocated for firmware
F008   FF FF F3 FF            DB   $ff,$ff,$f3,$ff   ; 32 blocks
F00C   FF 01 00 00            DB   $ff,$01,$00,$00   
F200                          .ORG   BAM_START+$0200   
F200                CART_NAMES:      
F200   01 00 00 00            DB   1,0,0,0   
F204   4B 49 4C 81 50 81 53 20 42 41 53 49 43 2D 62 65 DB   EXIT_TO_BASIC   
F214   03 01 2F 01            DB   3,1,47,1   
F218   70 72 69 6E 74 20 35 20 20 20 20 20 20 20 20 20 DB   "print 5         "   
F228   02 01 02 02 5F         DB   2,1,2,2,$5F   
F22D   75 6E 64 65 72 73 63 6F 72 65 20 20 20 20 20 DB   "underscore     "   
F23C   04 01 3C 03            DB   4,1,$3C,3   
F240   7A 6F 6C 69 20 20 20 20 20 20 20 20 20 20 20 20 DB   "zoli            "   
F250   03 01 3A 02            DB   3,1,$3A,2   
F254   72 6C 61 64 61 72 20 20 20 20 20 20 20 20 20 20 DB   "rladar          "   
F264   02 01 02 03 7B         DB   2,1,2,3,$7B   
F269   20 76 61 6C 61 6D 69 20 20 20 20 20 20 20 20 DB   " valami        "   
F278   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FILL   $00,$14   
F28C                LAST_ADDRESS:      


CARTSTART:          C000 DEFINED AT LINE 9
                    > USED AT LINE 220
RELOC:              3000 DEFINED AT LINE 10
                    > USED AT LINE 279
                    > USED AT LINE 281
                    > USED AT LINE 316
TEMP_MEMORY_U0:     08A0 DEFINED AT LINE 11
                    > USED AT LINE 3 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 9 IN multicart_v2.1_CAS_starter.z80
REGISTER:           C000 DEFINED AT LINE 12
                    > USED AT LINE 14
                    > USED AT LINE 369 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 129 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 21 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 629 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 642 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 666 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 739 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1008 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 131 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 5 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 22 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 61 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 67 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 270 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 296 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 171 IN multicart_v2.1_flash.z80
                    > USED AT LINE 296 IN multicart_v2.1_flash.z80
                    > USED AT LINE 339
REGISTER_RELOC:     E000 DEFINED AT LINE 13
                    > USED AT LINE 15
                    > USED AT LINE 670 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1017 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1021 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1029 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 15 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 29 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 36 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 43 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 50 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 60 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 71 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 85 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 274 IN multicart_v2.1_RAM_check.z80
REGISTER_DISABLE_RESET: C002 DEFINED AT LINE 14
                    > USED AT LINE 32 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 65 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 102 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 571 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 616 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 118 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 144 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 111 IN multicart_v2.1_flash.z80
                    > USED AT LINE 287 IN multicart_v2.1_flash.z80
REGISTER_RELOC_DISABLE_RESET: E002 DEFINED AT LINE 15
A19:                0020 DEFINED AT LINE 16
                    > USED AT LINE 648 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 14 IN multicart_v2.1_ROM_check.z80
RAM:                0040 DEFINED AT LINE 17
                    > USED AT LINE 1012 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 540 IN multicart_v2.1_functions.z80
                    > USED AT LINE 640 IN multicart_v2.1_functions.z80
                    > USED AT LINE 658 IN multicart_v2.1_functions.z80
                    > USED AT LINE 845 IN multicart_v2.1_functions.z80
                    > USED AT LINE 904 IN multicart_v2.1_functions.z80
                    > USED AT LINE 4 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 14 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 21 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 28 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 35 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 42 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 49 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 69 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 173 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 185 IN multicart_v2.1_RAM_check.z80
REGREL:             0080 DEFINED AT LINE 18
                    > USED AT LINE 664 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1007 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1012 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1020 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 4 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 21 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 28 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 35 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 42 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 49 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 66 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 69 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 173 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 486 IN multicart_v2.1_flash.z80
CYCLE_COUNT1:       0100 DEFINED AT LINE 19
                    > USED AT LINE 31 IN multicart_v2.1_input_routines.z80
CYCLE_COUNT2:       0080 DEFINED AT LINE 20
                    > USED AT LINE 42 IN multicart_v2.1_input_routines.z80
X0:                 0001 DEFINED AT LINE 21
                    > USED AT LINE 305 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 314 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 324 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 334 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 346 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 351 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 354 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 357 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 360 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 368 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 434 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 455 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 503 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 532 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 549 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 594 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 648 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 655 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 662 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_print_routines.z80
Y0:                 0005 DEFINED AT LINE 22
                    > USED AT LINE 304 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 313 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 323 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 333 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 346 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 351 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 354 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 357 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 360 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 368 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 431 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 452 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 500 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 529 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 546 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 594 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 648 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 655 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 662 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_print_routines.z80
N_NUM:              0003 DEFINED AT LINE 23
                    > USED AT LINE 314 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 324 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 334 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 354 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 357 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 360 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 377 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 434 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 455 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 503 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 549 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 650 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 655 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 662 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 720 IN multicart_v2.1_print_routines.z80
N_NAME:             0010 DEFINED AT LINE 24
                    > USED AT LINE 324 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 334 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 357 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 360 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 377 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 434 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 455 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 503 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 657 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 662 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 720 IN multicart_v2.1_print_routines.z80
N_TYPE:             0004 DEFINED AT LINE 25
                    > USED AT LINE 334 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 360 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 377 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 455 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 503 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 664 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 668 IN multicart_v2.1_print_routines.z80
N_SIZE:             0004 DEFINED AT LINE 26
                    > USED AT LINE 363 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 377 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 670 IN multicart_v2.1_print_routines.z80
N_HEIGHT:           0010 DEFINED AT LINE 27
                    > USED AT LINE 368 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 393 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 630 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 115 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 128 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 149 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 150 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 158 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 163 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 492 IN multicart_v2.1_input_routines.z80
EN:                 0000 DEFINED AT LINE 28
HU:                 0001 DEFINED AT LINE 29
                    > USED AT LINE 31
ES:                 0002 DEFINED AT LINE 30
LANG:               0001 DEFINED AT LINE 31
WARM_FLAG:          0B21 DEFINED AT LINE 35
                    > USED AT LINE 213 IN multicart_v2.1_input_routines.z80
INT_DES:            0B10 DEFINED AT LINE 38
                    > USED AT LINE 303
BASIC_FLAG:         0EB6 DEFINED AT LINE 41
                    > USED AT LINE 295 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 406 IN multicart_v2.1_input_routines.z80
BASIC_ENTRY:        0322 DEFINED AT LINE 44
                    > USED AT LINE 412 IN multicart_v2.1_input_routines.z80
STR_TEMP_AREA:      4B00 DEFINED AT LINE 47
                    > USED AT LINE 568 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 574 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 352 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 355 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 378 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 193 IN multicart_v2.1_sort.z80
                    > USED AT LINE 223 IN multicart_v2.1_sort.z80
CART_NAME_STRUCT:   4C00 DEFINED AT LINE 53
                    > USED AT LINE 286
                    > USED AT LINE 287
                    > USED AT LINE 300
                    > USED AT LINE 420 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 342 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 227 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 4 IN multicart_v2.1_images.z80
                    > USED AT LINE 12 IN multicart_v2.1_images.z80
                    > USED AT LINE 185 IN multicart_v2.1_flash.z80
                    > USED AT LINE 314 IN multicart_v2.1_flash.z80
                    > USED AT LINE 389 IN multicart_v2.1_flash.z80
                    > USED AT LINE 430 IN multicart_v2.1_flash.z80
                    > USED AT LINE 136 IN multicart_v2.1_rename.z80
                    > USED AT LINE 147 IN multicart_v2.1_sort.z80
                    > USED AT LINE 161 IN multicart_v2.1_sort.z80
                    > USED AT LINE 164 IN multicart_v2.1_sort.z80
                    > USED AT LINE 294 IN multicart_v2.1_sort.z80
                    > USED AT LINE 298 IN multicart_v2.1_sort.z80
TYPE_EXIT_TO_BASIC: 0001 DEFINED AT LINE 54
                    > USED AT LINE 299
                    > USED AT LINE 442 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 242 IN multicart_v2.1_input_routines.z80
TYPE_CART:          0002 DEFINED AT LINE 55
                    > USED AT LINE 465 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 349 IN multicart_v2.1_input_routines.z80
TYPE_CAS:           0003 DEFINED AT LINE 56
                    > USED AT LINE 473 IN multicart_v2.1_print_routines.z80
TYPE_BIN:           0004 DEFINED AT LINE 57
                    > USED AT LINE 482 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 384 IN multicart_v2.1_input_routines.z80
TYPE_DAT:           0005 DEFINED AT LINE 58
                    > USED AT LINE 229 IN multicart_v2.1_input_routines.z80
SW_MAJOR_VERSION:   0021 DEFINED AT LINE 61
                    > USED AT LINE 225
                    > USED AT LINE 15 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 21 IN multicart_v2.1_print_routines.z80
SW_MINOR_VERSION:   000C DEFINED AT LINE 62
                    > USED AT LINE 226
                    > USED AT LINE 27 IN multicart_v2.1_print_routines.z80
KEYBOARD_COUNTER:   0880 DEFINED AT LINE 65
                    > USED AT LINE 32 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 36 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 38 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 43 IN multicart_v2.1_input_routines.z80
KEYBOARD_LAST_KEY:  0882 DEFINED AT LINE 67
                    > USED AT LINE 22 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 26 IN multicart_v2.1_input_routines.z80
LIST_FIRST_ELEMENT: 0883 DEFINED AT LINE 69
                    > USED AT LINE 292
                    > USED AT LINE 412 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 426 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 334 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 98 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 110 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 121 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 126 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 146 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 215 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 434 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 486 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 519 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 175 IN multicart_v2.1_flash.z80
                    > USED AT LINE 303 IN multicart_v2.1_flash.z80
                    > USED AT LINE 370 IN multicart_v2.1_flash.z80
                    > USED AT LINE 417 IN multicart_v2.1_flash.z80
                    > USED AT LINE 608 IN multicart_v2.1_flash.z80
                    > USED AT LINE 623 IN multicart_v2.1_flash.z80
                    > USED AT LINE 126 IN multicart_v2.1_rename.z80
LIST_SELECTED_ELEMENT: 0885 DEFINED AT LINE 71
                    > USED AT LINE 293
                    > USED AT LINE 583 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 332 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 89 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 112 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 141 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 180 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 217 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 436 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 521 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 177 IN multicart_v2.1_flash.z80
                    > USED AT LINE 305 IN multicart_v2.1_flash.z80
                    > USED AT LINE 372 IN multicart_v2.1_flash.z80
                    > USED AT LINE 419 IN multicart_v2.1_flash.z80
                    > USED AT LINE 610 IN multicart_v2.1_flash.z80
                    > USED AT LINE 616 IN multicart_v2.1_flash.z80
                    > USED AT LINE 128 IN multicart_v2.1_rename.z80
NUM_OF_IMAGES:      0886 DEFINED AT LINE 73
                    > USED AT LINE 108 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 147 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 488 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 14 IN multicart_v2.1_images.z80
                    > USED AT LINE 61 IN multicart_v2.1_images.z80
                    > USED AT LINE 137 IN multicart_v2.1_flash.z80
                    > USED AT LINE 337 IN multicart_v2.1_flash.z80
                    > USED AT LINE 375 IN multicart_v2.1_flash.z80
                    > USED AT LINE 437 IN multicart_v2.1_flash.z80
                    > USED AT LINE 606 IN multicart_v2.1_flash.z80
                    > USED AT LINE 260 IN multicart_v2.1_sort.z80
                    > USED AT LINE 289 IN multicart_v2.1_sort.z80
                    > USED AT LINE 303 IN multicart_v2.1_sort.z80
SIZE_OF_FLASH1:     0888 DEFINED AT LINE 75
                    > USED AT LINE 211 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 10 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 158 IN multicart_v2.1_ROM_check.z80
SIZE_OF_FLASH2:     0889 DEFINED AT LINE 77
                    > USED AT LINE 219 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 21 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 164 IN multicart_v2.1_ROM_check.z80
SIZE_OF_CART_RAM:   088A DEFINED AT LINE 80
                    > USED AT LINE 136 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 194 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 534 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 1054 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 58 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 161 IN multicart_v2.1_RAM_check.z80
RESET_ENABLED:      088B DEFINED AT LINE 82
                    > USED AT LINE 296
                    > USED AT LINE 172 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 185 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 370 IN multicart_v2.1_input_routines.z80
DIRECTORY_POS:      088C DEFINED AT LINE 84
                    > USED AT LINE 424 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 438 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 508 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 553 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 561 IN multicart_v2.1_print_routines.z80
FREE_BLOCKS_IN_BAMS: 088E DEFINED AT LINE 86
                    > USED AT LINE 235 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 248 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 1128 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 168 IN multicart_v2.1_ROM_check.z80
FLASH1_TYPE:        0890 DEFINED AT LINE 88
                    > USED AT LINE 311 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 342 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 12 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 9 IN multicart_v2.1_flash.z80
                    > USED AT LINE 10 IN multicart_v2.1_rename.z80
FLASH2_TYPE:        0891 DEFINED AT LINE 89
                    > USED AT LINE 23 IN multicart_v2.1_ROM_check.z80
FLASH1_MAN:         0892 DEFINED AT LINE 91
                    > USED AT LINE 6 IN multicart_v2.1_ROM_check.z80
FLASH1_CHIP:        0893 DEFINED AT LINE 92
                    > USED AT LINE 8 IN multicart_v2.1_ROM_check.z80
FLASH2_MAN:         0894 DEFINED AT LINE 93
                    > USED AT LINE 17 IN multicart_v2.1_ROM_check.z80
FLASH2_CHIP:        0895 DEFINED AT LINE 94
                    > USED AT LINE 19 IN multicart_v2.1_ROM_check.z80
EXT0_BASE:          08A0 DEFINED AT LINE 96
                    > USED AT LINE 3 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 11 IN multicart_v2.1_save_routines.z80
BASIC_PROGRAM_START: 19EF DEFINED AT LINE 99
                    > USED AT LINE 398 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 57 IN multicart_v2.1_CAS_starter.z80
TVC_TOP:            1726 DEFINED AT LINE 100
                    > USED AT LINE 127 IN multicart_v2.1_CAS_starter.z80
BAM_START:          F000 DEFINED AT LINE 101
                    > USED AT LINE 228
                    > USED AT LINE 443 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 444 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 509 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 531 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 926 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 927 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 991 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1010 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 22 IN multicart_v2.1_functions.z80
                    > USED AT LINE 29 IN multicart_v2.1_functions.z80
                    > USED AT LINE 32 IN multicart_v2.1_functions.z80
                    > USED AT LINE 142 IN multicart_v2.1_functions.z80
                    > USED AT LINE 417 IN multicart_v2.1_functions.z80
                    > USED AT LINE 616 IN multicart_v2.1_functions.z80
                    > USED AT LINE 637 IN multicart_v2.1_functions.z80
                    > USED AT LINE 114 IN multicart_v2.1_flash.z80
                    > USED AT LINE 130 IN multicart_v2.1_flash.z80
                    > USED AT LINE 146 IN multicart_v2.1_flash.z80
                    > USED AT LINE 322 IN multicart_v2.1_flash.z80
                    > USED AT LINE 424 IN multicart_v2.1_flash.z80
                    > USED AT LINE 107 IN multicart_v2.1_rename.z80
                    > USED AT LINE 391
                    > USED AT LINE 395
ENTRY:              C004 DEFINED AT LINE 223
BAM_START_ADDRESS:  C008 DEFINED AT LINE 227
                    > USED AT LINE 157 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 161 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 8 IN multicart_v2.1_images.z80
                    > USED AT LINE 16 IN multicart_v2.1_images.z80
MAIN:               C014 DEFINED AT LINE 235
                    > USED AT LINE 224
MAIN_LOOP:          C045 DEFINED AT LINE 264
                    > USED AT LINE 269
F_INIT:             C051 DEFINED AT LINE 271
                    > USED AT LINE 246
USG_X:              0022 DEFINED AT LINE 1 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 47 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 57 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 67 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 77 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 87 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 97 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 107 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 117 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 127 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 141 IN multicart_v2.1_print_routines.z80
USG_Y:              000D DEFINED AT LINE 2 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 46 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 56 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 66 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 76 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 86 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 96 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 106 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 116 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 126 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 140 IN multicart_v2.1_print_routines.z80
F_PRINT_HEADER:     C082 DEFINED AT LINE 4 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 249
L_PRINT_RESET_HEADER: C14B DEFINED AT LINE 150 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 138 IN multicart_v2.1_print_routines.z80
F_PRINT_RESET_STATUS: C15D DEFINED AT LINE 165 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 266
                    > USED AT LINE 161 IN multicart_v2.1_print_routines.z80
PRS_SKIP_DISABLED:  C174 DEFINED AT LINE 177 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 175 IN multicart_v2.1_print_routines.z80
F_PRINT_RAM_FOUND:  C177 DEFINED AT LINE 182 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 258
F_PRINT_ROM_SIZE:   C18F DEFINED AT LINE 199 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 252
F_PRINT_FREE_SPACE: C1B4 DEFINED AT LINE 224 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 255
                    > USED AT LINE 484 IN multicart_v2.1_input_routines.z80
F_PRINT_FROM_ARRAY: C1FB DEFINED AT LINE 276 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 195 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 212 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 220 IN multicart_v2.1_print_routines.z80
F_PRINT_FRAME:      C20A DEFINED AT LINE 294 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 260
F_PRINT_FRAME_TOP:  C251 DEFINED AT LINE 345 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 298 IN multicart_v2.1_print_routines.z80
F_PRINT_FRAME_MID:  C258 DEFINED AT LINE 350 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 299 IN multicart_v2.1_print_routines.z80
F_PRINT_FRAME_BTM:  C277 DEFINED AT LINE 367 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 300 IN multicart_v2.1_print_routines.z80
F_PRINT_H_LINE:     C27E DEFINED AT LINE 374 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 347 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 369 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_P1:      C283 DEFINED AT LINE 378 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 381 IN multicart_v2.1_print_routines.z80
F_PRINT_V_LINE:     C28B DEFINED AT LINE 385 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 352 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 355 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 358 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 361 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 364 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_P2:      C290 DEFINED AT LINE 388 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 391 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_P3:      C297 DEFINED AT LINE 394 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 401 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_P4:      C299 DEFINED AT LINE 396 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 399 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_P5:      C2A3 DEFINED AT LINE 404 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 407 IN multicart_v2.1_print_routines.z80
F_REWRITE_LIST:     C2A9 DEFINED AT LINE 411 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 265
RL_DIRECTORY_POS_DONE: C2BB DEFINED AT LINE 423 IN multicart_v2.1_print_routines.z80
PRINT_LOOP_LINES:   C2C4 DEFINED AT LINE 429 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 632 IN multicart_v2.1_print_routines.z80
PRINT_RL_CHECK_CART: C2F6 DEFINED AT LINE 464 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 444 IN multicart_v2.1_print_routines.z80
PRINT_RL_CAS:       C303 DEFINED AT LINE 472 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 467 IN multicart_v2.1_print_routines.z80
PRINT_RL_BIN:       C310 DEFINED AT LINE 481 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 475 IN multicart_v2.1_print_routines.z80
PRINT_RL_DAT:       C31D DEFINED AT LINE 490 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 484 IN multicart_v2.1_print_routines.z80
L_PRINT_ACTUAL_TYPE: C325 DEFINED AT LINE 495 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 470 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 479 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 488 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 493 IN multicart_v2.1_print_routines.z80
PRINT_RL_SIZE:      C331 DEFINED AT LINE 507 IN multicart_v2.1_print_routines.z80
PRINT_RL_ROW_NUM:   C352 DEFINED AT LINE 526 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 462 IN multicart_v2.1_print_routines.z80
ADD_ONE_LINE:       C3A8 DEFINED AT LINE 595 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 597 IN multicart_v2.1_print_routines.z80
NEXT_LINE:          C3AD DEFINED AT LINE 600 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 622 IN multicart_v2.1_print_routines.z80
NEXT_WORD:          C3B4 DEFINED AT LINE 605 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 617 IN multicart_v2.1_print_routines.z80
PRINT_NEGATE:       C3B6 DEFINED AT LINE 608 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 613 IN multicart_v2.1_print_routines.z80
PRINT_RL_SKIP_HIGHTLIGHT: C3CD DEFINED AT LINE 627 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 585 IN multicart_v2.1_print_routines.z80
PRINT_RL_EXIT:      C3D6 DEFINED AT LINE 636 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 441 IN multicart_v2.1_print_routines.z80
F_CLEAR_ONE_LINE_IN_BOX: C3D8 DEFINED AT LINE 640 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 497 IN multicart_v2.1_input_routines.z80
SPACE_STRING:       C40F DEFINED AT LINE 677 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 651 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 658 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 665 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 671 IN multicart_v2.1_print_routines.z80
L_CLEAR_LOOP:       C414 DEFINED AT LINE 682 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 685 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 693 IN multicart_v2.1_print_routines.z80
MULTIPLE_C_BY_640:  C425 DEFINED AT LINE 697 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 645 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 81 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 296 IN multicart_v2.1_dialogbox.z80
L_MUL_64:           C43F DEFINED AT LINE 713 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 716 IN multicart_v2.1_print_routines.z80
ONE_LIST_LENGTHS:   C446 DEFINED AT LINE 719 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 603 IN multicart_v2.1_print_routines.z80
F_PRINT_NUMBER_NON_ZERO_LEAD: C44A DEFINED AT LINE 726 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 28 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 236 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 255 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 282 IN multicart_v2.1_RAM_check.z80
F_PRINT_NUMBER_4:   C46D DEFINED AT LINE 750 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 733 IN multicart_v2.1_print_routines.z80
F_PRINT_NUMBER_3:   C473 DEFINED AT LINE 753 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 543 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 740 IN multicart_v2.1_print_routines.z80
F_PRINT_NUMBER_2:   C479 DEFINED AT LINE 756 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 521 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 747 IN multicart_v2.1_print_routines.z80
F_PRINT_NUMBER_1:   C47F DEFINED AT LINE 759 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 748 IN multicart_v2.1_print_routines.z80
NUM1:               C482 DEFINED AT LINE 761 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 752 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 755 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 758 IN multicart_v2.1_print_routines.z80
NUM2:               C484 DEFINED AT LINE 763 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 766 IN multicart_v2.1_print_routines.z80
F_PRINT_HEX_NUMBER: C490 DEFINED AT LINE 775 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 419 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1071 IN multicart_v2.1_save_routines.z80
L_PRINT_HEX_DIGIT:  C4B0 DEFINED AT LINE 801 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 782 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 786 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 794 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 797 IN multicart_v2.1_print_routines.z80
L_HEX_LESS_THAN_TEN: C4B8 DEFINED AT LINE 806 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 804 IN multicart_v2.1_print_routines.z80
DIALOG_XY:          2000 DEFINED AT LINE 3 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 23 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 42 IN multicart_v2.1_dialogbox.z80
DIALOG_Y:           2000 DEFINED AT LINE 4 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 79 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 322 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 372 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 385 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 423 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 475 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 494 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 514 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 526 IN multicart_v2.1_dialogbox.z80
DIALOG_X:           2001 DEFINED AT LINE 5 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 84 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 297 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 319 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 367 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 382 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 481 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 489 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 509 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 532 IN multicart_v2.1_dialogbox.z80
DIALOG_WH:          2002 DEFINED AT LINE 6 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 24 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 43 IN multicart_v2.1_dialogbox.z80
DIALOG_H:           2002 DEFINED AT LINE 7 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 140 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 304 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 560 IN multicart_v2.1_dialogbox.z80
DIALOG_W:           2003 DEFINED AT LINE 8 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 55 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 92 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 119 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 150 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 186 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 220 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 249 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 276 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 313 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 363 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 434 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 486 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 505 IN multicart_v2.1_dialogbox.z80
DIALOG_CUR_X:       2004 DEFINED AT LINE 9 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 29 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 474 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 493 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 503 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 534 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 546 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 548 IN multicart_v2.1_dialogbox.z80
DIALOG_CUR_Y:       2005 DEFINED AT LINE 10 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 30 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 477 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 496 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 516 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 523 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 528 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 554 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 562 IN multicart_v2.1_dialogbox.z80
DIALOG_BACKGROUND_COPY: 2006 DEFINED AT LINE 12 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 315 IN multicart_v2.1_dialogbox.z80
F_SHOW_DIALOG_BOX:  C4BE DEFINED AT LINE 18 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 443 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 138 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 8 IN multicart_v2.1_rename.z80
F_CLOSE_DIALOG_BOX: C4DE DEFINED AT LINE 37 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 465 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 481 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 226 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 60 IN multicart_v2.1_rename.z80
                    > USED AT LINE 100 IN multicart_v2.1_rename.z80
                    > USED AT LINE 121 IN multicart_v2.1_rename.z80
SAVE_DIALOG_BACKGROUND: C4F3 DEFINED AT LINE 51 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 26 IN multicart_v2.1_dialogbox.z80
L_SD_LOOP:          C4F7 DEFINED AT LINE 54 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 70 IN multicart_v2.1_dialogbox.z80
L_SD_ONE_LINE_LOOP: C4FB DEFINED AT LINE 57 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 62 IN multicart_v2.1_dialogbox.z80
DRAW_DIALOG:        C50E DEFINED AT LINE 75 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 27 IN multicart_v2.1_dialogbox.z80
L_TOP_LINE_LOOP:    C52E DEFINED AT LINE 97 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 100 IN multicart_v2.1_dialogbox.z80
L_TOP_LINES_NO_SHADOW_LOOP: C53E DEFINED AT LINE 113 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 135 IN multicart_v2.1_dialogbox.z80
L_TOP_LINES_NO_SHADOW_LINE_LOOP: C54C DEFINED AT LINE 123 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 126 IN multicart_v2.1_dialogbox.z80
L_VERT_LINES_SHADOW_LOOP: C56C DEFINED AT LINE 149 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 179 IN multicart_v2.1_dialogbox.z80
L_VERT_LINES_SHADOW_LINE_LOOP: C57A DEFINED AT LINE 159 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 162 IN multicart_v2.1_dialogbox.z80
ODD_PATTERN:        C58A DEFINED AT LINE 170 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 167 IN multicart_v2.1_dialogbox.z80
SKIP_ODD_PATTERN:   C58C DEFINED AT LINE 172 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 169 IN multicart_v2.1_dialogbox.z80
L_VERT_LAST_LINES_SHADOW_LOOP: C598 DEFINED AT LINE 185 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 215 IN multicart_v2.1_dialogbox.z80
L_VERT_LAST_LINES_SHADOW_LINE_LOOP: C5A6 DEFINED AT LINE 195 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 198 IN multicart_v2.1_dialogbox.z80
ODD_PATTERN_LAST4:  C5B6 DEFINED AT LINE 206 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 203 IN multicart_v2.1_dialogbox.z80
SKIP_ODD_PATTERN_LAST4: C5B8 DEFINED AT LINE 208 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 205 IN multicart_v2.1_dialogbox.z80
L_LAST_LINE_LOOP:   C5D1 DEFINED AT LINE 229 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 232 IN multicart_v2.1_dialogbox.z80
L_LAST_LINES_SHADOW_LOOP: C5E5 DEFINED AT LINE 247 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 267 IN multicart_v2.1_dialogbox.z80
L_LAST_LINES_SHADOW_LINE_LOOP: C5EB DEFINED AT LINE 252 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 257 IN multicart_v2.1_dialogbox.z80
RESTORE_DIALOG_BACKGROUND: C5FF DEFINED AT LINE 272 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 45 IN multicart_v2.1_dialogbox.z80
L_RD_LOOP:          C603 DEFINED AT LINE 275 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 291 IN multicart_v2.1_dialogbox.z80
L_RD_ONE_LINE_LOOP: C607 DEFINED AT LINE 278 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 283 IN multicart_v2.1_dialogbox.z80
SETUP_VARIABLES_FOR_COPY: C61A DEFINED AT LINE 295 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 52 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 273 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 426 IN multicart_v2.1_dialogbox.z80
F_PRINT_DELETE_QUESTION: C63E DEFINED AT LINE 318 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 445 IN multicart_v2.1_input_routines.z80
STR_RTRIM:          C6BE DEFINED AT LINE 396 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 357 IN multicart_v2.1_dialogbox.z80
L_SRT_LOOP:         C6C4 DEFINED AT LINE 402 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 409 IN multicart_v2.1_dialogbox.z80
L_SRT_EMPTY_STR:    C6D2 DEFINED AT LINE 414 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 405 IN multicart_v2.1_dialogbox.z80
F_CLEAR_BOX:        C6D5 DEFINED AT LINE 418 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 470 IN multicart_v2.1_input_routines.z80
L_CLEAR_DB_LOOP:    C6EA DEFINED AT LINE 433 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 447 IN multicart_v2.1_dialogbox.z80
L_CLEAR_DB_ONE_LINE_LOOP: C6F1 DEFINED AT LINE 438 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 441 IN multicart_v2.1_dialogbox.z80
F_PRINT_ONE_LINE_IN_DIALOG: C704 DEFINED AT LINE 461 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 566 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 477 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 143 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 149 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 209 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 220 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 7 IN multicart_v2.1_flash.z80
                    > USED AT LINE 22 IN multicart_v2.1_flash.z80
                    > USED AT LINE 27 IN multicart_v2.1_flash.z80
                    > USED AT LINE 48 IN multicart_v2.1_flash.z80
                    > USED AT LINE 53 IN multicart_v2.1_flash.z80
                    > USED AT LINE 60 IN multicart_v2.1_flash.z80
                    > USED AT LINE 70 IN multicart_v2.1_flash.z80
                    > USED AT LINE 78 IN multicart_v2.1_flash.z80
                    > USED AT LINE 86 IN multicart_v2.1_flash.z80
                    > USED AT LINE 91 IN multicart_v2.1_flash.z80
                    > USED AT LINE 99 IN multicart_v2.1_flash.z80
                    > USED AT LINE 104 IN multicart_v2.1_flash.z80
                    > USED AT LINE 29 IN multicart_v2.1_rename.z80
                    > USED AT LINE 40 IN multicart_v2.1_rename.z80
                    > USED AT LINE 51 IN multicart_v2.1_rename.z80
                    > USED AT LINE 68 IN multicart_v2.1_rename.z80
                    > USED AT LINE 75 IN multicart_v2.1_rename.z80
                    > USED AT LINE 84 IN multicart_v2.1_rename.z80
                    > USED AT LINE 89 IN multicart_v2.1_rename.z80
                    > USED AT LINE 93 IN multicart_v2.1_rename.z80
                    > USED AT LINE 170 IN multicart_v2.1_rename.z80
L_DB_PRINT_NEXT_LINE_LEFT: C716 DEFINED AT LINE 472 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 465 IN multicart_v2.1_dialogbox.z80
L_DB_PRINT_NEXT_LINE_RIGHT: C72D DEFINED AT LINE 485 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 467 IN multicart_v2.1_dialogbox.z80
L_DB_PRINT_NEXT_LINE_CENTER: C748 DEFINED AT LINE 501 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 471 IN multicart_v2.1_dialogbox.z80
L_DB_PRINT_AFTER:   C767 DEFINED AT LINE 522 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 469 IN multicart_v2.1_dialogbox.z80
L_DB_PRINT:         C782 DEFINED AT LINE 540 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 484 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 500 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 520 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 538 IN multicart_v2.1_dialogbox.z80
PRINT_PRESS_SPACE:  C795 DEFINED AT LINE 559 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 223 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 58 IN multicart_v2.1_rename.z80
                    > USED AT LINE 119 IN multicart_v2.1_rename.z80
KEY_UP:             0001 DEFINED AT LINE 1 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 46 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 587 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 645 IN multicart_v2.1_input_routines.z80
KEY_DN:             0002 DEFINED AT LINE 2 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 49 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 614 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 650 IN multicart_v2.1_input_routines.z80
KEY_PG_UP:          0003 DEFINED AT LINE 3 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 52 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 596 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 660 IN multicart_v2.1_input_routines.z80
KEY_PG_DN:          0004 DEFINED AT LINE 4 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 55 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 627 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 655 IN multicart_v2.1_input_routines.z80
KEY_TGL_RST:        0005 DEFINED AT LINE 5 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 58 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 632 IN multicart_v2.1_input_routines.z80
KEY_RETURN:         0006 DEFINED AT LINE 6 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 61 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 606 IN multicart_v2.1_input_routines.z80
KEY_DEL:            0007 DEFINED AT LINE 7 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 64 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 601 IN multicart_v2.1_input_routines.z80
KEY_N:              0008 DEFINED AT LINE 8 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 70 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 619 IN multicart_v2.1_input_routines.z80
KEY_T:              0009 DEFINED AT LINE 9 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 76 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 559 IN multicart_v2.1_input_routines.z80
KEY_S:              000A DEFINED AT LINE 10 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 73 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 581 IN multicart_v2.1_input_routines.z80
KEY_R:              000B DEFINED AT LINE 11 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 79 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 564 IN multicart_v2.1_input_routines.z80
KEY_O:              000C DEFINED AT LINE 12 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 67 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 572 IN multicart_v2.1_input_routines.z80
KEY_M:              000D DEFINED AT LINE 13 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 82 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 637 IN multicart_v2.1_input_routines.z80
F_HANDLE_INPUT:     C7A9 DEFINED AT LINE 17 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 268
                    > USED AT LINE 23 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 41 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 102 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 114 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 231 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 439 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 466 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 524 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 529 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 536 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 548 IN multicart_v2.1_input_routines.z80
KEY_PRESSED:        C7B5 DEFINED AT LINE 25 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 21 IN multicart_v2.1_input_routines.z80
INPUT_OLD_KEY:      C7C5 DEFINED AT LINE 35 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 29 IN multicart_v2.1_input_routines.z80
KEYBOARD_PROCESS:   C7D8 DEFINED AT LINE 45 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 33 IN multicart_v2.1_input_routines.z80
KEYPRESS_KEYUP:     C829 DEFINED AT LINE 88 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 48 IN multicart_v2.1_input_routines.z80
AT_TOP:             C835 DEFINED AT LINE 97 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 93 IN multicart_v2.1_input_routines.z80
KEYPRESS_KEYDOWN:   C842 DEFINED AT LINE 107 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 51 IN multicart_v2.1_input_routines.z80
AT_LAST_LINE:       C858 DEFINED AT LINE 120 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 117 IN multicart_v2.1_input_routines.z80
KEYPRESS_KEYPGUP:   C85D DEFINED AT LINE 125 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 54 IN multicart_v2.1_input_routines.z80
PG_UP_TOP_PAGE:     C869 DEFINED AT LINE 133 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 130 IN multicart_v2.1_input_routines.z80
PG_UP_FIRST_LINE:   C871 DEFINED AT LINE 140 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 136 IN multicart_v2.1_input_routines.z80
KEYPRESS_KEYPGDOWN: C876 DEFINED AT LINE 145 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 57 IN multicart_v2.1_input_routines.z80
END_REACHED1:       C88C DEFINED AT LINE 161 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 156 IN multicart_v2.1_input_routines.z80
END_REACHED2:       C89C DEFINED AT LINE 175 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 167 IN multicart_v2.1_input_routines.z80
KEYPRESS_SPACE:     C8A5 DEFINED AT LINE 184 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 60 IN multicart_v2.1_input_routines.z80
KEYPRESS_RETURN:    C8AE DEFINED AT LINE 192 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 63 IN multicart_v2.1_input_routines.z80
L_DELAY_LOOP:       C8B2 DEFINED AT LINE 195 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 200 IN multicart_v2.1_input_routines.z80
L_KEYBOARD_READ:    C8C1 DEFINED AT LINE 209 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 206 IN multicart_v2.1_input_routines.z80
L_EXIT_TO_BASIC:    C8F4 DEFINED AT LINE 245 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 408 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 426 IN multicart_v2.1_input_routines.z80
EBE:                08DE DEFINED AT LINE 256 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 259 IN multicart_v2.1_input_routines.z80
JUMP_TO_BASIC_FROM_U1: C906 DEFINED AT LINE 258 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 247 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 248 IN multicart_v2.1_input_routines.z80
TVC12:              08ED DEFINED AT LINE 267 IN multicart_v2.1_input_routines.z80
L_TVC12_FILL_STACK_LOOP: 08F7 DEFINED AT LINE 273 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 276 IN multicart_v2.1_input_routines.z80
TVC22:              0921 DEFINED AT LINE 294 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 266 IN multicart_v2.1_input_routines.z80
L_TVC22_LOOP_OUT:   092D DEFINED AT LINE 301 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 312 IN multicart_v2.1_input_routines.z80
L_TVC22_LOOP_IN:    0930 DEFINED AT LINE 304 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 309 IN multicart_v2.1_input_routines.z80
L_TVC22_FILL_STACK_LOOP: 0945 DEFINED AT LINE 319 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 322 IN multicart_v2.1_input_routines.z80
L_SKIP_NEW:         0957 DEFINED AT LINE 329 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 327 IN multicart_v2.1_input_routines.z80
JUMP_TO_BASIC_FROM_U1_END: C99D DEFINED AT LINE 346 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 247 IN multicart_v2.1_input_routines.z80
CHECK_CART_EXEC:    C99D DEFINED AT LINE 348 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 244 IN multicart_v2.1_input_routines.z80
JUMP_TO_CART_FROM_U1: C9B7 DEFINED AT LINE 368 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 362 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_input_routines.z80
JUMP_TO_CART_FROM_U1_END: C9CB DEFINED AT LINE 380 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 362 IN multicart_v2.1_input_routines.z80
EXEC_CAS:           C9CB DEFINED AT LINE 382 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 351 IN multicart_v2.1_input_routines.z80
LOAD_BIN:           CA03 DEFINED AT LINE 414 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 385 IN multicart_v2.1_input_routines.z80
KEYPRESS_DEL:       CA16 DEFINED AT LINE 432 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 66 IN multicart_v2.1_input_routines.z80
L_ANSWER_SCAN_LOOP: CA30 DEFINED AT LINE 448 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 451 IN multicart_v2.1_input_routines.z80
L_ANSWER_SCAN_RELEASE: CA38 DEFINED AT LINE 455 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 459 IN multicart_v2.1_input_routines.z80
L_TO_DELETE:        CA4A DEFINED AT LINE 468 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 464 IN multicart_v2.1_input_routines.z80
L_SKIP_DELETE:      CA79 DEFINED AT LINE 499 IN multicart_v2.1_input_routines.z80
DELETE_DONE:        CA79 DEFINED AT LINE 500 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 493 IN multicart_v2.1_input_routines.z80
KEYPRESS_SORT_SIZE: CA7A DEFINED AT LINE 503 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 75 IN multicart_v2.1_input_routines.z80
KEYPRESS_SORT_TYPE: CA7F DEFINED AT LINE 506 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 78 IN multicart_v2.1_input_routines.z80
KEYPRESS_SORT_NAME: CA84 DEFINED AT LINE 509 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 72 IN multicart_v2.1_input_routines.z80
KEYPRESS_RESET_SORT: CA89 DEFINED AT LINE 512 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 69 IN multicart_v2.1_input_routines.z80
KEYPRESS_RENAME:    CA93 DEFINED AT LINE 518 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 81 IN multicart_v2.1_input_routines.z80
RENAME_DONE:        CAA7 DEFINED AT LINE 531 IN multicart_v2.1_input_routines.z80
KEYPRESS_RAM_TEST:  CAA8 DEFINED AT LINE 533 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 84 IN multicart_v2.1_input_routines.z80
KEY_NOT_FOUND:      CAB4 DEFINED AT LINE 540 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 86 IN multicart_v2.1_input_routines.z80
TEST_LOOP2:         CAB7 DEFINED AT LINE 542 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 543 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 547 IN multicart_v2.1_input_routines.z80
F_KEYBOARD_SCAN:    CAC2 DEFINED AT LINE 550 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 18 IN multicart_v2.1_input_routines.z80
CHECK_R:            CAD2 DEFINED AT LINE 561 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 558 IN multicart_v2.1_input_routines.z80
CHECK_O:            CAD9 DEFINED AT LINE 566 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 563 IN multicart_v2.1_input_routines.z80
CHECK_S:            CAE6 DEFINED AT LINE 575 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 571 IN multicart_v2.1_input_routines.z80
CHECK_A:            CAF3 DEFINED AT LINE 583 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 580 IN multicart_v2.1_input_routines.z80
CHECKE_ACUTE:       CAFA DEFINED AT LINE 589 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 585 IN multicart_v2.1_input_routines.z80
CHECK_DEL:          CB07 DEFINED AT LINE 598 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 595 IN multicart_v2.1_input_routines.z80
CHECK_RETURN:       CB0E DEFINED AT LINE 603 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 600 IN multicart_v2.1_input_routines.z80
CHECK_Y:            CB15 DEFINED AT LINE 608 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 605 IN multicart_v2.1_input_routines.z80
CHECK_N:            CB22 DEFINED AT LINE 616 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 613 IN multicart_v2.1_input_routines.z80
CHECK_COLON:        CB29 DEFINED AT LINE 621 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 618 IN multicart_v2.1_input_routines.z80
CHECK_SPACE:        CB36 DEFINED AT LINE 629 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 626 IN multicart_v2.1_input_routines.z80
CHECK_M:            CB3D DEFINED AT LINE 634 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 631 IN multicart_v2.1_input_routines.z80
JOY_UP:             CB44 DEFINED AT LINE 639 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 636 IN multicart_v2.1_input_routines.z80
JOY_DOWN:           CB51 DEFINED AT LINE 647 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 644 IN multicart_v2.1_input_routines.z80
JOY_RIGHT:          CB58 DEFINED AT LINE 652 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 649 IN multicart_v2.1_input_routines.z80
JOY_LEFT:           CB5F DEFINED AT LINE 657 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 654 IN multicart_v2.1_input_routines.z80
DONE_KEYSCAN:       CB65 DEFINED AT LINE 662 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 659 IN multicart_v2.1_input_routines.z80
GET_ANSWER:         CB66 DEFINED AT LINE 665 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 449 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 456 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 710 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 716 IN multicart_v2.1_input_routines.z80
L_SCAN_LOOP:        CB6A DEFINED AT LINE 668 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 675 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 678 IN multicart_v2.1_input_routines.z80
L_SAME_KEY_PRESSED: CB76 DEFINED AT LINE 676 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 672 IN multicart_v2.1_input_routines.z80
SCAN_ANSWER_KEYS:   CB7A DEFINED AT LINE 681 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 669 IN multicart_v2.1_input_routines.z80
L_SCAN_DONE_Y:      CB99 DEFINED AT LINE 698 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 689 IN multicart_v2.1_input_routines.z80
L_SCAN_DONE_N:      CB9C DEFINED AT LINE 701 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 687 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 694 IN multicart_v2.1_input_routines.z80
L_SCAN_DONE_SPC:    CB9F DEFINED AT LINE 704 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 696 IN multicart_v2.1_input_routines.z80
WAIT_FOR_SPACE:     CBA2 DEFINED AT LINE 708 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 479 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 224 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 59 IN multicart_v2.1_rename.z80
                    > USED AT LINE 120 IN multicart_v2.1_rename.z80
L_SPACE_SCAN_LOOP:  CBA2 DEFINED AT LINE 709 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 712 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 714 IN multicart_v2.1_input_routines.z80
L_SPACE_SCAN_RELEASE: CBAD DEFINED AT LINE 715 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 718 IN multicart_v2.1_input_routines.z80
F_COPY_BASIC_INIT:  CBB5 DEFINED AT LINE 1 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 392 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 421 IN multicart_v2.1_input_routines.z80
F_COPY_CAS_FROM_CART: CBC1 DEFINED AT LINE 8 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 2 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 4 IN multicart_v2.1_CAS_starter.z80
CURRENT_TVC_POS:    08A0 DEFINED AT LINE 10 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 51 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 58 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 81 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 95 IN multicart_v2.1_CAS_starter.z80
CURRENT_CART_POS:   08A2 DEFINED AT LINE 12 IN multicart_v2.1_CAS_starter.z80
CURRENT_NUM_OF_COPIED_BYTES: 08A4 DEFINED AT LINE 14 IN multicart_v2.1_CAS_starter.z80
REMAINIG_SIZE_OF_CAS: 08A6 DEFINED AT LINE 16 IN multicart_v2.1_CAS_starter.z80
REMAINING_BYTES_IN_BANK: 08A8 DEFINED AT LINE 18 IN multicart_v2.1_CAS_starter.z80
CAS_BYTES_ABOVE_C000: 08AA DEFINED AT LINE 20 IN multicart_v2.1_CAS_starter.z80
BANK_SELECT:        08AC DEFINED AT LINE 22 IN multicart_v2.1_CAS_starter.z80
F_BASIC_INIT:       08AD DEFINED AT LINE 1 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 393 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 422 IN multicart_v2.1_input_routines.z80
BASIC_INIT_END:     08DC DEFINED AT LINE 23 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 8 IN multicart_v2.1_CAS_starter.z80
BASIC_VERSION:      08E4 DEFINED AT LINE 29 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 401 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 9 IN multicart_v2.1_CAS_starter.z80
MEMORY_PAGING:      08E5 DEFINED AT LINE 33 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 404 IN multicart_v2.1_input_routines.z80
F_COPY_BIN_FROM_CART_INU0: 08F8 DEFINED AT LINE 27 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 424 IN multicart_v2.1_input_routines.z80
L_BIN_BLOCK_SIZE_OK: 0911 DEFINED AT LINE 45 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 41 IN multicart_v2.1_CAS_starter.z80
F_COPY_CAS_FROM_CART_INU0: 091C DEFINED AT LINE 56 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 395 IN multicart_v2.1_input_routines.z80
CC_LOOP_SECTOR_COPY: 0931 DEFINED AT LINE 72 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 109 IN multicart_v2.1_CAS_starter.z80
CC_COPY_ONE_SECTOR: 093B DEFINED AT LINE 79 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 52 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 77 IN multicart_v2.1_CAS_starter.z80
CC_FINISHED_COPY:   094D DEFINED AT LINE 94 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 124 IN multicart_v2.1_CAS_starter.z80
CC_COPY_INTO_U3:    0967 DEFINED AT LINE 110 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 92 IN multicart_v2.1_CAS_starter.z80
CC_COPY_INTO_U3_LOOP: 0968 DEFINED AT LINE 112 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 123 IN multicart_v2.1_CAS_starter.z80
CC_EXIT:            097A DEFINED AT LINE 125 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 99 IN multicart_v2.1_CAS_starter.z80
F_COPY_CAS_FROM_CART_END: CCA7 DEFINED AT LINE 134 IN multicart_v2.1_CAS_starter.z80
                    > USED AT LINE 2 IN multicart_v2.1_CAS_starter.z80
CONFIGURE_EXT0:     CCA7 DEFINED AT LINE 1 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 229
                    > USED AT LINE 285 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 338 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 403 IN multicart_v2.1_input_routines.z80
EXT0_BOOT_ROUTINE:  CCB7 DEFINED AT LINE 10 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 2 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 5 IN multicart_v2.1_save_routines.z80
PROGRAM_SIZE_TO_SAVE: 08C3 DEFINED AT LINE 34 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 203 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 811 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 842 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 849 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 850 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 851 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 862 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 952 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1036 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1070 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1126 IN multicart_v2.1_save_routines.z80
BAM_IN_TVC_RAM:     08C5 DEFINED AT LINE 36 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 415 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 418 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 448 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 530 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 676 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 731 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 826 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 880 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 933 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 988 IN multicart_v2.1_save_routines.z80
MAPPED_IN_SECTOR:   08C7 DEFINED AT LINE 38 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 395 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 755 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 770 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 795 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 896 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 908 IN multicart_v2.1_save_routines.z80
PREV_BANK_BLOCK:    08C8 DEFINED AT LINE 40 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 396 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 802 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 878 IN multicart_v2.1_save_routines.z80
CURRENT_BAM_ADDRESS: 08CA DEFINED AT LINE 42 IN multicart_v2.1_save_routines.z80
PROGRAM_POS:        08CC DEFINED AT LINE 44 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 183 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 198 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 399 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 837 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 869 IN multicart_v2.1_save_routines.z80
EXT0_TEMP_STR:      08CE DEFINED AT LINE 47 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 88 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 110 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 112 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 113 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 160 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 166 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 168 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 169 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 206 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 215 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 221 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 275 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 964 IN multicart_v2.1_save_routines.z80
EXT0_BASE_END:      08DE DEFINED AT LINE 50 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 249 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 255 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 256 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 434 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 436 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 440 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1000 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1002 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1006 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1096 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1106 IN multicart_v2.1_save_routines.z80
EXT0_BOOT_ROUTINE_END: CCF5 DEFINED AT LINE 52 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 5 IN multicart_v2.1_save_routines.z80
EXT0_ROUTINE:       CCF5 DEFINED AT LINE 55 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 23 IN multicart_v2.1_save_routines.z80
EXT0_INIT_CHIP_VARIABLES: CCFF DEFINED AT LINE 62 IN multicart_v2.1_save_routines.z80
SELECT_MENU:        CD27 DEFINED AT LINE 83 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 59 IN multicart_v2.1_save_routines.z80
NOT_EXPECTED:       CD45 DEFINED AT LINE 98 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 87 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 129 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 155 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 178 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 180 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 182 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 191 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 193 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 196 IN multicart_v2.1_save_routines.z80
L_SELECT_MENU_INTERRUPTED: CD4D DEFINED AT LINE 102 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 97 IN multicart_v2.1_save_routines.z80
L_SELECT_MENU_EXIT: CD53 DEFINED AT LINE 105 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 101 IN multicart_v2.1_save_routines.z80
INPUT_FILE_NAME:    CD54 DEFINED AT LINE 108 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 126 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 152 IN multicart_v2.1_save_routines.z80
MENU_1_SELECTED:    CD68 DEFINED AT LINE 119 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 91 IN multicart_v2.1_save_routines.z80
MENU_INTERRUPTED:   CD85 DEFINED AT LINE 136 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 132 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 158 IN multicart_v2.1_save_routines.z80
MENU_2_SELECTED_SKIP: CD8C DEFINED AT LINE 141 IN multicart_v2.1_save_routines.z80
EXT0_CONVERT_STR_TO_INT: CE15 DEFINED AT LINE 213 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 181 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 195 IN multicart_v2.1_save_routines.z80
L_CONVERT_STR2INT_LOOP: CE23 DEFINED AT LINE 222 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 255 IN multicart_v2.1_save_routines.z80
L_CONVERT_FAILED:   CE52 DEFINED AT LINE 257 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 227 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 229 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 246 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 252 IN multicart_v2.1_save_routines.z80
L_CONVERT_DONE:     CE54 DEFINED AT LINE 260 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 225 IN multicart_v2.1_save_routines.z80
MENU_2_SELECTED:    CE57 DEFINED AT LINE 264 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 93 IN multicart_v2.1_save_routines.z80
MENU_3_SELECTED:    CE57 DEFINED AT LINE 265 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 95 IN multicart_v2.1_save_routines.z80
EXT0_INPUT_STRING:  CE5E DEFINED AT LINE 270 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 84 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 116 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 175 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 188 IN multicart_v2.1_save_routines.z80
L_EXT0_CHIN_LOOP:   CE67 DEFINED AT LINE 278 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 302 IN multicart_v2.1_save_routines.z80
L_EXIT_ED_CHIN:     CE81 DEFINED AT LINE 304 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 295 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 297 IN multicart_v2.1_save_routines.z80
L_ED_CHIN_INTERRUPTED: CE82 DEFINED AT LINE 306 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 293 IN multicart_v2.1_save_routines.z80
CHECK_IC_SAVE_BINARY_PROGRAM: CE85 DEFINED AT LINE 310 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 143 IN multicart_v2.1_save_routines.z80
NEXT_CHECK:         CE96 DEFINED AT LINE 323 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 319 IN multicart_v2.1_save_routines.z80
SAVE_BASIC_PROGRAM: CEAC DEFINED AT LINE 341 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 133 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 210 IN multicart_v2.1_save_routines.z80
SAVE_BIN_FOR_AMD:   CECB DEFINED AT LINE 360 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 314 IN multicart_v2.1_save_routines.z80
SAVE_FOR_AMD:       CECB DEFINED AT LINE 361 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 344 IN multicart_v2.1_save_routines.z80
SAVE_BIN_FOR_ATMEL: CED8 DEFINED AT LINE 370 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 326 IN multicart_v2.1_save_routines.z80
SAVE_FOR_ATMEL:     CED8 DEFINED AT LINE 371 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 350 IN multicart_v2.1_save_routines.z80
SAVE_FOR_SST:       CEE5 DEFINED AT LINE 380 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 347 IN multicart_v2.1_save_routines.z80
L_USE_CART_RAM:     CF10 DEFINED AT LINE 408 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 404 IN multicart_v2.1_save_routines.z80
L_USE_TVC_RAM:      CF1A DEFINED AT LINE 413 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 406 IN multicart_v2.1_save_routines.z80
L_NOT_ENOUGH_RAM_TO_PROGRAM_FLASH: CF36 DEFINED AT LINE 426 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 391 IN multicart_v2.1_save_routines.z80
TVC_RAM_COPY_PROGRAM_TO_FLASH: CF3D DEFINED AT LINE 431 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 424 IN multicart_v2.1_save_routines.z80
CART_COPY_PROG_TVC: CF4C DEFINED AT LINE 439 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 432 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 433 IN multicart_v2.1_save_routines.z80
L_SEARCH_FREE_BLOCK: 08F0 DEFINED AT LINE 451 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 461 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 467 IN multicart_v2.1_save_routines.z80
L_CHECK_BANK_BLOCK_POINTERS: 08FA DEFINED AT LINE 459 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 481 IN multicart_v2.1_save_routines.z80
L_FREE_BLOCK_FOUND: 0903 DEFINED AT LINE 468 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 454 IN multicart_v2.1_save_routines.z80
L_ALLOCATE_LOOP:    0905 DEFINED AT LINE 470 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 478 IN multicart_v2.1_save_routines.z80
L_FINALIZE_SST_COPY_FROM_TVC_RAM_AND_DONE: 0916 DEFINED AT LINE 483 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 475 IN multicart_v2.1_save_routines.z80
WRITE_BACK_SST_BAM_FROM_TVC: 0924 DEFINED AT LINE 497 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 493 IN multicart_v2.1_save_routines.z80
F_SET_PAGES_REG_LOC_USED: 0965 DEFINED AT LINE 547 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 688 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 692 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 696 IN multicart_v2.1_save_routines.z80
F_SET_PAGES_NOREGREL: 0977 DEFINED AT LINE 565 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 589 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 593 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 597 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 601 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 605 IN multicart_v2.1_save_routines.z80
INIT_SST_ARBITRARY_SECTOR_ERASE: 0986 DEFINED AT LINE 580 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 517 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 757 IN multicart_v2.1_save_routines.z80
L_SST_FINISH_ARBITRARY_SECTORY_CLEAR_LOOP: 09CD DEFINED AT LINE 623 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 626 IN multicart_v2.1_save_routines.z80
A19_STORE:          09D7 DEFINED AT LINE 633 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 506 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 649 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 667 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 669 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 683 IN multicart_v2.1_save_routines.z80
REGISTER_STORE:     09D8 DEFINED AT LINE 635 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 507 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 647 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 663 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 665 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 698 IN multicart_v2.1_save_routines.z80
REGISTER_LOCATION:  09D9 DEFINED AT LINE 637 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 504 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 555 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 643 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 671 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 699 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 707 IN multicart_v2.1_save_routines.z80
SST_WRITE_ONE_SECTOR: 09DB DEFINED AT LINE 641 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 772 IN multicart_v2.1_save_routines.z80
L_SST_WRITE_REGISTER_PLACED_WELL: 0A19 DEFINED AT LINE 673 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 662 IN multicart_v2.1_save_routines.z80
L_SST_WRITE_ONE_SECTOR_LOOP: 0A21 DEFINED AT LINE 679 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 534 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 705 IN multicart_v2.1_save_routines.z80
SST_READ_ONE_SECTOR: 0A53 DEFINED AT LINE 714 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 786 IN multicart_v2.1_save_routines.z80
CART_COPY_PROG_TVC_END: D0EC DEFINED AT LINE 743 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 433 IN multicart_v2.1_save_routines.z80
MAP_OUT_SECTOR:     D0EC DEFINED AT LINE 746 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 492 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 906 IN multicart_v2.1_save_routines.z80
MAP_IN_SECTOR:      D111 DEFINED AT LINE 778 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 910 IN multicart_v2.1_save_routines.z80
ALLOCATE_BLOCK:     D11C DEFINED AT LINE 790 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 474 IN multicart_v2.1_save_routines.z80
CHECK_FINISH_SST_PROGRAM_COPY_TVC_RAM: D139 DEFINED AT LINE 810 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 804 IN multicart_v2.1_save_routines.z80
COPY_PROGRAM_BLOCK_TO_TVC_RAM: D140 DEFINED AT LINE 816 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 800 IN multicart_v2.1_save_routines.z80
L_SST_BLOCK_COPY_LAST_BLOCK: D16B DEFINED AT LINE 848 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 846 IN multicart_v2.1_save_routines.z80
L_SST_BLOCK_COPY_NORMAL_BLOCK: D17E DEFINED AT LINE 860 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 847 IN multicart_v2.1_save_routines.z80
L_SST_COPY_BLOCK:   D184 DEFINED AT LINE 863 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 859 IN multicart_v2.1_save_routines.z80
WRITE_PREV_SECTOR_HEADER: D18E DEFINED AT LINE 875 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 798 IN multicart_v2.1_save_routines.z80
MAP_SECTOR:         D1A2 DEFINED AT LINE 893 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 799 IN multicart_v2.1_save_routines.z80
L_MAP_FINISHED:     D1C2 DEFINED AT LINE 911 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 904 IN multicart_v2.1_save_routines.z80
CREATE_DIRECTORY_ENTRY: D1C5 DEFINED AT LINE 916 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 797 IN multicart_v2.1_save_routines.z80
L_CHECK_ENTRY_TYPE: D1E3 DEFINED AT LINE 939 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 943 IN multicart_v2.1_save_routines.z80
L_CALC_BLOCKS_LOOP: D1F9 DEFINED AT LINE 955 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 959 IN multicart_v2.1_save_routines.z80
COPY_BAM_TO_TVC_RAM: D21A DEFINED AT LINE 983 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 423 IN multicart_v2.1_save_routines.z80
COPY_BAM_TO_CART_RAM: D22D DEFINED AT LINE 996 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 411 IN multicart_v2.1_save_routines.z80
CART_BAM_TO_CART_RAM: D23C DEFINED AT LINE 1005 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 998 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 999 IN multicart_v2.1_save_routines.z80
BAM_TO_TVC_RAM_COPY_LOOP: 08EF DEFINED AT LINE 1014 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1026 IN multicart_v2.1_save_routines.z80
CART_BAM_TO_CART_RAM_END: D265 DEFINED AT LINE 1032 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 999 IN multicart_v2.1_save_routines.z80
CALCULATE_USABLE_8K: D265 DEFINED AT LINE 1034 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 388 IN multicart_v2.1_save_routines.z80
L_CHECK_CART_RAM:   D28B DEFINED AT LINE 1053 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1047 IN multicart_v2.1_save_routines.z80
L_CALC_USABLE_8K_DONE: D292 DEFINED AT LINE 1058 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1040 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1052 IN multicart_v2.1_save_routines.z80
CHECK_BASIC_PROGRAM_SIZE: D297 DEFINED AT LINE 1064 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 387 IN multicart_v2.1_save_routines.z80
L_NO_SPACE_ON_BAM:  D2B9 DEFINED AT LINE 1083 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1080 IN multicart_v2.1_save_routines.z80
L_ZERO_FILE:        D2C1 DEFINED AT LINE 1088 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1082 IN multicart_v2.1_save_routines.z80
PRINT_CSTRING:      D2C9 DEFINED AT LINE 1094 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 26 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 58 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 100 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 104 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 121 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 124 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 138 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 147 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 150 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 173 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 186 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 267 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 331 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 334 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 353 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 356 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 363 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 366 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 373 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 376 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 382 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 385 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 410 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 417 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 421 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 428 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1069 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1073 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1085 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1090 IN multicart_v2.1_save_routines.z80
L_PC_LOOP:          D2D0 DEFINED AT LINE 1098 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1104 IN multicart_v2.1_save_routines.z80
L_PC_COPY_DONE:     D2D9 DEFINED AT LINE 1105 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1100 IN multicart_v2.1_save_routines.z80
CHECK_IF_BASIC_PROGRAM_FIT: D2DF DEFINED AT LINE 1111 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1065 IN multicart_v2.1_save_routines.z80
L_CPS_NON_ZERO_SIZE: D2F1 DEFINED AT LINE 1123 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1120 IN multicart_v2.1_save_routines.z80
CHECK_IF_MEMORY_AREA_FIT: D2F2 DEFINED AT LINE 1125 IN multicart_v2.1_save_routines.z80
L_CPS_CHECK_LOOP:   D2FF DEFINED AT LINE 1134 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1143 IN multicart_v2.1_save_routines.z80
L_ENOUGH_SPACE:     D30C DEFINED AT LINE 1144 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1142 IN multicart_v2.1_save_routines.z80
L_NOT_ENOUGH_SPACE: D30E DEFINED AT LINE 1147 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1140 IN multicart_v2.1_save_routines.z80
L_CPS_ZERO_SIZE:    D311 DEFINED AT LINE 1150 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1122 IN multicart_v2.1_save_routines.z80
CALC_PROGRAM_END_POS: D314 DEFINED AT LINE 1154 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1112 IN multicart_v2.1_save_routines.z80
CPS_LOOP:           D31E DEFINED AT LINE 1159 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1180 IN multicart_v2.1_save_routines.z80
STR_EXT0_MENU1_SELECTED: D336 DEFINED AT LINE 1 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 120 IN multicart_v2.1_save_routines.z80
STR_EXT0_MENU2_SELECTED: D359 DEFINED AT LINE 4 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 146 IN multicart_v2.1_save_routines.z80
STR_EXT0_FILENAME_Q: D389 DEFINED AT LINE 7 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 123 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 149 IN multicart_v2.1_save_routines.z80
STR_EXT0_Q1:        D39D DEFINED AT LINE 9 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 57 IN multicart_v2.1_save_routines.z80
STR_EXT0_INTERRUPTED: D42D DEFINED AT LINE 15 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 103 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 137 IN multicart_v2.1_save_routines.z80
STR_EXT0_NOT_EXPECTED: D444 DEFINED AT LINE 17 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 99 IN multicart_v2.1_save_routines.z80
STR_EXT0_CRLF:      D45E DEFINED AT LINE 19 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 25 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 420 IN multicart_v2.1_save_routines.z80
STR_EXT0_IC_AMD:    D461 DEFINED AT LINE 21 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 362 IN multicart_v2.1_save_routines.z80
STR_EXT0_IC_SST:    D46A DEFINED AT LINE 23 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 381 IN multicart_v2.1_save_routines.z80
STR_EXT0_IC_ATMEL:  D475 DEFINED AT LINE 25 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 372 IN multicart_v2.1_save_routines.z80
STR_EXT0_IC_UNKNOWN: D47E DEFINED AT LINE 27 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 330 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 352 IN multicart_v2.1_save_routines.z80
STR_EXT0_SUPPORTED: D489 DEFINED AT LINE 29 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 384 IN multicart_v2.1_save_routines.z80
STR_EXT0_NOT_SUPPORTED: D4AD DEFINED AT LINE 31 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 333 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 355 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 365 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 375 IN multicart_v2.1_save_routines.z80
STR_EXT0_NOT_ENOUGH_SPACE: D4CA DEFINED AT LINE 33 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1084 IN multicart_v2.1_save_routines.z80
STR_EXT0_ZERO_COPY: D4ED DEFINED AT LINE 35 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1089 IN multicart_v2.1_save_routines.z80
STR_EXT0_FEATURE_NOT_SUPPORTED: D515 DEFINED AT LINE 37 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 266 IN multicart_v2.1_save_routines.z80
STR_EXT0_NOT_ENOUGH_RAM_TO_SAVE: D53E DEFINED AT LINE 39 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 427 IN multicart_v2.1_save_routines.z80
STR_EXT0_USING_CART_RAM: D56A DEFINED AT LINE 41 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 409 IN multicart_v2.1_save_routines.z80
STR_EXT0_USING_TVC_RAM: D58D DEFINED AT LINE 43 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 416 IN multicart_v2.1_save_routines.z80
STR_EXT0_SIZE_TO_SAVE: D5B3 DEFINED AT LINE 45 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1068 IN multicart_v2.1_save_routines.z80
STR_EXT0_BYTES:     D5C4 DEFINED AT LINE 47 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 1072 IN multicart_v2.1_save_routines.z80
STR_EXT0_ENTER_START_ADDR: D5CC DEFINED AT LINE 1194 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 172 IN multicart_v2.1_save_routines.z80
STR_EXT0_ENTER_LAST_ADDR: D5F1 DEFINED AT LINE 1196 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 185 IN multicart_v2.1_save_routines.z80
GET_FIRST_DIRECTORY_ENTRY: D61D DEFINED AT LINE 21 IN multicart_v2.1_functions.z80
                    > USED AT LINE 230
                    > USED AT LINE 12 IN multicart_v2.1_tests.z80
L_FILL_DIRECTORY_STRUCUTRE: D647 DEFINED AT LINE 49 IN multicart_v2.1_functions.z80
                    > USED AT LINE 27 IN multicart_v2.1_functions.z80
L_FILL_STRUCTURE_LOOP: D64C DEFINED AT LINE 54 IN multicart_v2.1_functions.z80
                    > USED AT LINE 57 IN multicart_v2.1_functions.z80
GET_NEXT_DIRECTORY_ENTRY: D653 DEFINED AT LINE 73 IN multicart_v2.1_functions.z80
                    > USED AT LINE 231
                    > USED AT LINE 13 IN multicart_v2.1_tests.z80
                    > USED AT LINE 14 IN multicart_v2.1_tests.z80
                    > USED AT LINE 15 IN multicart_v2.1_tests.z80
                    > USED AT LINE 16 IN multicart_v2.1_tests.z80
                    > USED AT LINE 17 IN multicart_v2.1_tests.z80
L_NEXT_DIR_DONE:    D681 DEFINED AT LINE 110 IN multicart_v2.1_functions.z80
                    > USED AT LINE 85 IN multicart_v2.1_functions.z80
LOAD_FILE_TO_TVCRAM: D684 DEFINED AT LINE 138 IN multicart_v2.1_functions.z80
                    > USED AT LINE 232
                    > USED AT LINE 29 IN multicart_v2.1_tests.z80
                    > USED AT LINE 41 IN multicart_v2.1_tests.z80
                    > USED AT LINE 54 IN multicart_v2.1_tests.z80
L_COPY_FILE_LOOP:   D68A DEFINED AT LINE 143 IN multicart_v2.1_functions.z80
                    > USED AT LINE 158 IN multicart_v2.1_functions.z80
L_FILE_DOESNT_MATCH: D697 DEFINED AT LINE 153 IN multicart_v2.1_functions.z80
                    > USED AT LINE 189 IN multicart_v2.1_functions.z80
L_FILE_TYPE_MATCHES: D69F DEFINED AT LINE 159 IN multicart_v2.1_functions.z80
                    > USED AT LINE 152 IN multicart_v2.1_functions.z80
L_COPY_FILE_FILENAME_COMP_LOOP: D6B0 DEFINED AT LINE 172 IN multicart_v2.1_functions.z80
                    > USED AT LINE 181 IN multicart_v2.1_functions.z80
L_FILE_FOUND:       D6BC DEFINED AT LINE 182 IN multicart_v2.1_functions.z80
                    > USED AT LINE 175 IN multicart_v2.1_functions.z80
L_FILENAME_DOESNT_MATCH: D6C0 DEFINED AT LINE 186 IN multicart_v2.1_functions.z80
                    > USED AT LINE 177 IN multicart_v2.1_functions.z80
L_NO_FILE_FOUND:    D6C4 DEFINED AT LINE 190 IN multicart_v2.1_functions.z80
                    > USED AT LINE 146 IN multicart_v2.1_functions.z80
L_COPY_FILE_ROUTINE: D6C9 DEFINED AT LINE 196 IN multicart_v2.1_functions.z80
                    > USED AT LINE 185 IN multicart_v2.1_functions.z80
TVCRAM_CALLER_ROUTINE: D6E2 DEFINED AT LINE 215 IN multicart_v2.1_functions.z80
                    > USED AT LINE 210 IN multicart_v2.1_functions.z80
                    > USED AT LINE 390 IN multicart_v2.1_functions.z80
                    > USED AT LINE 402 IN multicart_v2.1_functions.z80
                    > USED AT LINE 502 IN multicart_v2.1_functions.z80
                    > USED AT LINE 524 IN multicart_v2.1_functions.z80
COPY_FILE_TVCRAM_ROUTINE: D6E3 DEFINED AT LINE 218 IN multicart_v2.1_functions.z80
                    > USED AT LINE 204 IN multicart_v2.1_functions.z80
                    > USED AT LINE 205 IN multicart_v2.1_functions.z80
L_DADDR_SET_PROPERLY: D70F DEFINED AT LINE 255 IN multicart_v2.1_functions.z80
                    > USED AT LINE 228 IN multicart_v2.1_functions.z80
                    > USED AT LINE 230 IN multicart_v2.1_functions.z80
                    > USED AT LINE 233 IN multicart_v2.1_functions.z80
L_COPY_FILE_COPY_LOOP: D712 DEFINED AT LINE 260 IN multicart_v2.1_functions.z80
                    > USED AT LINE 291 IN multicart_v2.1_functions.z80
                    > USED AT LINE 312 IN multicart_v2.1_functions.z80
L_LOAD_BIN_FIRST_ENTRY: D724 DEFINED AT LINE 274 IN multicart_v2.1_functions.z80
                    > USED AT LINE 253 IN multicart_v2.1_functions.z80
L_COPY_FILE_BLOCKSIZE_SET: D72D DEFINED AT LINE 281 IN multicart_v2.1_functions.z80
                    > USED AT LINE 279 IN multicart_v2.1_functions.z80
L_COPY_UNDER_U3:    D73F DEFINED AT LINE 293 IN multicart_v2.1_functions.z80
                    > USED AT LINE 285 IN multicart_v2.1_functions.z80
L_COPY_U3_LOOP:     D740 DEFINED AT LINE 295 IN multicart_v2.1_functions.z80
                    > USED AT LINE 307 IN multicart_v2.1_functions.z80
L_COPY_FILE_DONE:   D75C DEFINED AT LINE 314 IN multicart_v2.1_functions.z80
                    > USED AT LINE 292 IN multicart_v2.1_functions.z80
COPY_FILE_TVCRAM_ROUTINE_END: D762 DEFINED AT LINE 319 IN multicart_v2.1_functions.z80
                    > USED AT LINE 205 IN multicart_v2.1_functions.z80
ERR_OK:             0000 DEFINED AT LINE 356 IN multicart_v2.1_functions.z80
ERR_NOT_ENOUGH_CART_RAM: 0001 DEFINED AT LINE 357 IN multicart_v2.1_functions.z80
                    > USED AT LINE 393 IN multicart_v2.1_functions.z80
ERR_FILE_EXIST:     0002 DEFINED AT LINE 358 IN multicart_v2.1_functions.z80
                    > USED AT LINE 459 IN multicart_v2.1_functions.z80
ERR_FILE_DOESNT_EXIST: 0003 DEFINED AT LINE 359 IN multicart_v2.1_functions.z80
                    > USED AT LINE 450 IN multicart_v2.1_functions.z80
ERR_NOT_ENOUGH_FREE_SPACE: 0004 DEFINED AT LINE 360 IN multicart_v2.1_functions.z80
                    > USED AT LINE 484 IN multicart_v2.1_functions.z80
ERR_FLASH_NOT_SUPPORTED: 0005 DEFINED AT LINE 361 IN multicart_v2.1_functions.z80
                    > USED AT LINE 405 IN multicart_v2.1_functions.z80
CACHED_DIRECTORY_ENTRY: 00-2 DEFINED AT LINE 364 IN multicart_v2.1_functions.z80
CACHED_BANK:        00-4 DEFINED AT LINE 365 IN multicart_v2.1_functions.z80
CACHED_BLOCK:       00-3 DEFINED AT LINE 366 IN multicart_v2.1_functions.z80
TEMP_AREA_SIZE_SAVE: 0100 DEFINED AT LINE 368 IN multicart_v2.1_functions.z80
                    > USED AT LINE 381 IN multicart_v2.1_functions.z80
SAVE_FILE_TO_MULTICART: D762 DEFINED AT LINE 370 IN multicart_v2.1_functions.z80
                    > USED AT LINE 233
L_PROCEED_TO_FLASH_CHECK: D789 DEFINED AT LINE 395 IN multicart_v2.1_functions.z80
                    > USED AT LINE 392 IN multicart_v2.1_functions.z80
L_PROCEED_TO_FILE_EXIST_CHECK: D79F DEFINED AT LINE 407 IN multicart_v2.1_functions.z80
                    > USED AT LINE 404 IN multicart_v2.1_functions.z80
L_FILE_SAVE_FILE_EXISTS_CHECK_LOOP: D7B0 DEFINED AT LINE 418 IN multicart_v2.1_functions.z80
                    > USED AT LINE 442 IN multicart_v2.1_functions.z80
L_FILE_SAVE_FILE_NAME_CHECK_LOOP: D7BD DEFINED AT LINE 429 IN multicart_v2.1_functions.z80
                    > USED AT LINE 436 IN multicart_v2.1_functions.z80
L_FILE_DONT_MATCH:  D7CA DEFINED AT LINE 437 IN multicart_v2.1_functions.z80
                    > USED AT LINE 434 IN multicart_v2.1_functions.z80
L_FILE_SAVE_FILE_DOESNT_EXIST: D7D2 DEFINED AT LINE 443 IN multicart_v2.1_functions.z80
                    > USED AT LINE 423 IN multicart_v2.1_functions.z80
L_FILE_SAVE_FILE_EXISTS: D7DF DEFINED AT LINE 452 IN multicart_v2.1_functions.z80
                    > USED AT LINE 432 IN multicart_v2.1_functions.z80
L_SAVE_FILE_RELEASE_FILE: D7EC DEFINED AT LINE 461 IN multicart_v2.1_functions.z80
                    > USED AT LINE 458 IN multicart_v2.1_functions.z80
L_FILE_SAVE_CREATE_FILE: D7EC DEFINED AT LINE 463 IN multicart_v2.1_functions.z80
                    > USED AT LINE 449 IN multicart_v2.1_functions.z80
L_FILE_SAVE_THERE_IS_ENOUGH_SPACE: D809 DEFINED AT LINE 486 IN multicart_v2.1_functions.z80
                    > USED AT LINE 480 IN multicart_v2.1_functions.z80
                    > USED AT LINE 483 IN multicart_v2.1_functions.z80
L_SAVE_FILE_OVERWRITE_FILE: D83F DEFINED AT LINE 528 IN multicart_v2.1_functions.z80
L_SAVE_FILE_FINISHED_OK: D83F DEFINED AT LINE 531 IN multicart_v2.1_functions.z80
                    > USED AT LINE 526 IN multicart_v2.1_functions.z80
L_SAVE_FILE_FINISHED: D840 DEFINED AT LINE 533 IN multicart_v2.1_functions.z80
                    > USED AT LINE 394 IN multicart_v2.1_functions.z80
                    > USED AT LINE 406 IN multicart_v2.1_functions.z80
                    > USED AT LINE 451 IN multicart_v2.1_functions.z80
                    > USED AT LINE 460 IN multicart_v2.1_functions.z80
                    > USED AT LINE 485 IN multicart_v2.1_functions.z80
L_SAVE_CHECK_RAM:   D844 DEFINED AT LINE 539 IN multicart_v2.1_functions.z80
                    > USED AT LINE 385 IN multicart_v2.1_functions.z80
                    > USED AT LINE 386 IN multicart_v2.1_functions.z80
L_SAVE_CHECK_RAM_LOOP: D851 DEFINED AT LINE 546 IN multicart_v2.1_functions.z80
                    > USED AT LINE 564 IN multicart_v2.1_functions.z80
L_RAM_CHECK_FAILED: D86B DEFINED AT LINE 565 IN multicart_v2.1_functions.z80
                    > USED AT LINE 550 IN multicart_v2.1_functions.z80
                    > USED AT LINE 554 IN multicart_v2.1_functions.z80
                    > USED AT LINE 558 IN multicart_v2.1_functions.z80
                    > USED AT LINE 562 IN multicart_v2.1_functions.z80
L_SAVE_CHECK_RAM_END: D872 DEFINED AT LINE 571 IN multicart_v2.1_functions.z80
                    > USED AT LINE 386 IN multicart_v2.1_functions.z80
L_SAVE_CHECK_FLASH: D872 DEFINED AT LINE 574 IN multicart_v2.1_functions.z80
                    > USED AT LINE 397 IN multicart_v2.1_functions.z80
                    > USED AT LINE 398 IN multicart_v2.1_functions.z80
L_SAVE_CHECK_FLASH_END: D8A9 DEFINED AT LINE 612 IN multicart_v2.1_functions.z80
                    > USED AT LINE 398 IN multicart_v2.1_functions.z80
CALCULATE_AVAILABLE_SPACE: D8A9 DEFINED AT LINE 615 IN multicart_v2.1_functions.z80
                    > USED AT LINE 465 IN multicart_v2.1_functions.z80
L_CAS_LOOP:         D8AF DEFINED AT LINE 618 IN multicart_v2.1_functions.z80
                    > USED AT LINE 630 IN multicart_v2.1_functions.z80
L_CAS_ONEBYTE_LOOP: D8B2 DEFINED AT LINE 621 IN multicart_v2.1_functions.z80
                    > USED AT LINE 627 IN multicart_v2.1_functions.z80
L_CAS_NEXT_CYCLE:   D8B7 DEFINED AT LINE 625 IN multicart_v2.1_functions.z80
                    > USED AT LINE 623 IN multicart_v2.1_functions.z80
L_CREATE_FILE_ENTRY_IN_MULTICART_RAM: D8C2 DEFINED AT LINE 635 IN multicart_v2.1_functions.z80
                    > USED AT LINE 496 IN multicart_v2.1_functions.z80
                    > USED AT LINE 497 IN multicart_v2.1_functions.z80
L_CREATE_BAM_COPY_LOOP: D8CF DEFINED AT LINE 642 IN multicart_v2.1_functions.z80
                    > USED AT LINE 655 IN multicart_v2.1_functions.z80
L_CREATE_FILE_SEARCH_LAST_ENTRY_LOOP: D8EE DEFINED AT LINE 662 IN multicart_v2.1_functions.z80
                    > USED AT LINE 666 IN multicart_v2.1_functions.z80
L_LAST_ENTRY_FOUND: D8F4 DEFINED AT LINE 668 IN multicart_v2.1_functions.z80
                    > USED AT LINE 664 IN multicart_v2.1_functions.z80
L_CREATE_FILE_FILL_FILENAME_LOOP: D90B DEFINED AT LINE 687 IN multicart_v2.1_functions.z80
                    > USED AT LINE 690 IN multicart_v2.1_functions.z80
L_SEARCH_FIRST_FREE_BLOCK_BYTE_LOOP: D91D DEFINED AT LINE 699 IN multicart_v2.1_functions.z80
                    > USED AT LINE 716 IN multicart_v2.1_functions.z80
L_SEARCH_FIRST_FREE_BLOCK_LOOP: D920 DEFINED AT LINE 702 IN multicart_v2.1_functions.z80
                    > USED AT LINE 714 IN multicart_v2.1_functions.z80
L_SEARCH_FIRST_FREE_BLOCK_BANK_OK: D92D DEFINED AT LINE 711 IN multicart_v2.1_functions.z80
                    > USED AT LINE 708 IN multicart_v2.1_functions.z80
L_FIRST_EMPTY_BLOCK_FOUND: D934 DEFINED AT LINE 717 IN multicart_v2.1_functions.z80
                    > USED AT LINE 704 IN multicart_v2.1_functions.z80
L_CREATE_FILE_ENTRY_IN_MULTICART_RAM_END: D94B DEFINED AT LINE 746 IN multicart_v2.1_functions.z80
                    > USED AT LINE 496 IN multicart_v2.1_functions.z80
L_CREATE_FILE_IN_MULTICART: D94B DEFINED AT LINE 749 IN multicart_v2.1_functions.z80
                    > USED AT LINE 507 IN multicart_v2.1_functions.z80
                    > USED AT LINE 508 IN multicart_v2.1_functions.z80
                    > USED AT LINE 513 IN multicart_v2.1_functions.z80
                    > USED AT LINE 516 IN multicart_v2.1_functions.z80
L_SEARCH_FREE_BLOCK_BYTE_LOOP: D951 DEFINED AT LINE 752 IN multicart_v2.1_functions.z80
                    > USED AT LINE 772 IN multicart_v2.1_functions.z80
L_SEARCH_FREE_BLOCK_LOOP: D954 DEFINED AT LINE 755 IN multicart_v2.1_functions.z80
                    > USED AT LINE 770 IN multicart_v2.1_functions.z80
L_SEARCH_FREE_BLOCK_LOOP_CONTINUE: D958 DEFINED AT LINE 758 IN multicart_v2.1_functions.z80
                    > USED AT LINE 811 IN multicart_v2.1_functions.z80
L_SEARCH_FREE_BLOCK_BANK_OK: D962 DEFINED AT LINE 766 IN multicart_v2.1_functions.z80
                    > USED AT LINE 763 IN multicart_v2.1_functions.z80
L_EMPTY_BLOCK_FOUND: D96A DEFINED AT LINE 773 IN multicart_v2.1_functions.z80
                    > USED AT LINE 757 IN multicart_v2.1_functions.z80
L_CACHE_IS_FRESH:   D97C DEFINED AT LINE 786 IN multicart_v2.1_functions.z80
                    > USED AT LINE 856 IN multicart_v2.1_functions.z80
L_SHIFT_BIT:        D98F DEFINED AT LINE 802 IN multicart_v2.1_functions.z80
                    > USED AT LINE 804 IN multicart_v2.1_functions.z80
L_SHIFT_DONE:       D992 DEFINED AT LINE 805 IN multicart_v2.1_functions.z80
                    > USED AT LINE 800 IN multicart_v2.1_functions.z80
L_REFRESH_CACHE:    D998 DEFINED AT LINE 813 IN multicart_v2.1_functions.z80
                    > USED AT LINE 781 IN multicart_v2.1_functions.z80
                    > USED AT LINE 785 IN multicart_v2.1_functions.z80
L_MODIFY_TARGET_1:  D99C DEFINED AT LINE 817 IN multicart_v2.1_functions.z80
                    > USED AT LINE 516 IN multicart_v2.1_functions.z80
L_REFRESH_CACHE_CONTINUE: D99F DEFINED AT LINE 819 IN multicart_v2.1_functions.z80
                    > USED AT LINE 952 IN multicart_v2.1_functions.z80
L_SAVE_FILE_COPY_BANK_TO_CACHE_SECTOR_LOOP: D9B9 DEFINED AT LINE 834 IN multicart_v2.1_functions.z80
                    > USED AT LINE 855 IN multicart_v2.1_functions.z80
L_COPY_BLOCK:       D9DE DEFINED AT LINE 857 IN multicart_v2.1_functions.z80
                    > USED AT LINE 787 IN multicart_v2.1_functions.z80
L_STORE_SECTOR:     D9DF DEFINED AT LINE 859 IN multicart_v2.1_functions.z80
                    > USED AT LINE 513 IN multicart_v2.1_functions.z80
                    > USED AT LINE 818 IN multicart_v2.1_functions.z80
L_CREATE_FILE_ERASE_SECTOR_POLLING_LOOP: DA23 DEFINED AT LINE 900 IN multicart_v2.1_functions.z80
                    > USED AT LINE 903 IN multicart_v2.1_functions.z80
L_STORE_FILE_SECTOR_WRITE_LOOP: DA38 DEFINED AT LINE 912 IN multicart_v2.1_functions.z80
                    > USED AT LINE 946 IN multicart_v2.1_functions.z80
L_STORE_FILE_ONE_BYTE_WRITE_LOOP: DA5F DEFINED AT LINE 936 IN multicart_v2.1_functions.z80
                    > USED AT LINE 938 IN multicart_v2.1_functions.z80
L_CREATE_FILE_IN_MULTICART_END: DA70 DEFINED AT LINE 953 IN multicart_v2.1_functions.z80
                    > USED AT LINE 508 IN multicart_v2.1_functions.z80
CODE_IN_CART:       DA70 DEFINED AT LINE 315
                    > USED AT LINE 280
                    > USED AT LINE 68 IN multicart_v2.1_save_routines.z80
ROM_CHECK_START:    3000 DEFINED AT LINE 1 IN multicart_v2.1_ROM_check.z80
F_CHECK_ROM_IDS:    3000 DEFINED AT LINE 2 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 251
                    > USED AT LINE 73 IN multicart_v2.1_save_routines.z80
CHIP_DATA_BLOCK:    3033 DEFINED AT LINE 42 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 61 IN multicart_v2.1_ROM_check.z80
MANUFACTURER_CHECK_CNT: 304C DEFINED AT LINE 55 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 11 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 22 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 60 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 67 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 92 IN multicart_v2.1_ROM_check.z80
GET_SIZE_OF_CHIP:   304D DEFINED AT LINE 58 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 9 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 20 IN multicart_v2.1_ROM_check.z80
CHIP_SIZE_LOOP:     3054 DEFINED AT LINE 62 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 89 IN multicart_v2.1_ROM_check.z80
CHIP_ID_LOOP:       3064 DEFINED AT LINE 73 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 79 IN multicart_v2.1_ROM_check.z80
CHIP_FOUND:         306E DEFINED AT LINE 81 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 78 IN multicart_v2.1_ROM_check.z80
NEXT_MANUFACTURER:  3071 DEFINED AT LINE 86 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 71 IN multicart_v2.1_ROM_check.z80
CHIP_ID_NOT_FOUND:  3077 DEFINED AT LINE 90 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 65 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 80 IN multicart_v2.1_ROM_check.z80
F_READ_ID:          307C DEFINED AT LINE 96 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 4 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 15 IN multicart_v2.1_ROM_check.z80
F_SET_PAGES:        30AF DEFINED AT LINE 135 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 107 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 111 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 115 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 504 IN multicart_v2.1_flash.z80
                    > USED AT LINE 508 IN multicart_v2.1_flash.z80
                    > USED AT LINE 512 IN multicart_v2.1_flash.z80
                    > USED AT LINE 550 IN multicart_v2.1_flash.z80
                    > USED AT LINE 554 IN multicart_v2.1_flash.z80
                    > USED AT LINE 558 IN multicart_v2.1_flash.z80
                    > USED AT LINE 562 IN multicart_v2.1_flash.z80
                    > USED AT LINE 566 IN multicart_v2.1_flash.z80
                    > USED AT LINE 361
                    > USED AT LINE 365
                    > USED AT LINE 369
F_CALC_FREE_SPACE:  30C6 DEFINED AT LINE 156 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 254
                    > USED AT LINE 483 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 74 IN multicart_v2.1_save_routines.z80
F_CFS_CHECK_BAMS:   30E3 DEFINED AT LINE 171 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 159 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 165 IN multicart_v2.1_ROM_check.z80
CFS_CHECK_256:      30EB DEFINED AT LINE 176 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 173 IN multicart_v2.1_ROM_check.z80
CFS_CHECK_128:      30F3 DEFINED AT LINE 181 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 178 IN multicart_v2.1_ROM_check.z80
CFS_NOT_INSTALLED:  30FB DEFINED AT LINE 186 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 183 IN multicart_v2.1_ROM_check.z80
CFS_CHECK_DONE:     30FC DEFINED AT LINE 188 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 175 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 180 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 185 IN multicart_v2.1_ROM_check.z80
F_CHECK_ONE_BAM_BANK: 3104 DEFINED AT LINE 196 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 193 IN multicart_v2.1_ROM_check.z80
CFS_LOOP:           3105 DEFINED AT LINE 198 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 233 IN multicart_v2.1_ROM_check.z80
CFS_BIT_1:          310A DEFINED AT LINE 202 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 200 IN multicart_v2.1_ROM_check.z80
CFS_BIT_2:          310F DEFINED AT LINE 206 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 204 IN multicart_v2.1_ROM_check.z80
CFS_BIT_3:          3114 DEFINED AT LINE 210 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 208 IN multicart_v2.1_ROM_check.z80
CFS_BIT_4:          3119 DEFINED AT LINE 214 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 212 IN multicart_v2.1_ROM_check.z80
CFS_BIT_5:          311E DEFINED AT LINE 218 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 216 IN multicart_v2.1_ROM_check.z80
CFS_BIT_6:          3123 DEFINED AT LINE 222 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 220 IN multicart_v2.1_ROM_check.z80
CFS_BIT_7:          3128 DEFINED AT LINE 226 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 224 IN multicart_v2.1_ROM_check.z80
CFS_BIT_8:          312D DEFINED AT LINE 230 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 228 IN multicart_v2.1_ROM_check.z80
ROM_CHECK_END:      3132 DEFINED AT LINE 236 IN multicart_v2.1_ROM_check.z80
                    > USED AT LINE 70 IN multicart_v2.1_save_routines.z80
                    > USED AT LINE 70 IN multicart_v2.1_save_routines.z80
F_CHECK_RAM_SIZE:   3132 DEFINED AT LINE 1 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 247
CHECK_RAM_EXIT:     319D DEFINED AT LINE 56 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 9 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 18 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 25 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 32 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 39 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 46 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 53 IN multicart_v2.1_RAM_check.z80
F_FILL_RAM:         31A9 DEFINED AT LINE 64 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 2 IN multicart_v2.1_RAM_check.z80
FR_LOOP:            31B0 DEFINED AT LINE 68 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 82 IN multicart_v2.1_RAM_check.z80
FR_LOOP_IN:         31BC DEFINED AT LINE 75 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 78 IN multicart_v2.1_RAM_check.z80
F_CHECK_BYTE:       31CB DEFINED AT LINE 88 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 8 IN multicart_v2.1_RAM_check.z80
CHECK_BYTE_EXIT:    31E1 DEFINED AT LINE 104 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 92 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 96 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 100 IN multicart_v2.1_RAM_check.z80
F_COPY_TVC:         31E2 DEFINED AT LINE 107 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 11 IN multicart_v2.1_RAM_check.z80
F_CHECK_TVC:        31EE DEFINED AT LINE 114 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 17 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 24 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 31 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 38 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 45 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 52 IN multicart_v2.1_RAM_check.z80
CT_LOOP:            31F3 DEFINED AT LINE 117 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 125 IN multicart_v2.1_RAM_check.z80
CHECK_TVC_EXIT:     31FD DEFINED AT LINE 126 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 124 IN multicart_v2.1_RAM_check.z80
RAM_TEST_DIALOG_X:  000F DEFINED AT LINE 130 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 136 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 277 IN multicart_v2.1_RAM_check.z80
RAM_TEST_DIALOG_Y:  0009 DEFINED AT LINE 131 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 136 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 278 IN multicart_v2.1_RAM_check.z80
RAM_TEST_DIALOG_W:  0022 DEFINED AT LINE 132 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 137 IN multicart_v2.1_RAM_check.z80
RAM_TEST_DIALOG_H:  0006 DEFINED AT LINE 133 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 137 IN multicart_v2.1_RAM_check.z80
F_CART_RAM_TEST:    31FE DEFINED AT LINE 135 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 537 IN multicart_v2.1_input_routines.z80
L_SETUP_LOOP_COUNTER: 3230 DEFINED AT LINE 167 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 169 IN multicart_v2.1_RAM_check.z80
L_RAM_TEST_MAIN_LOOP: 3234 DEFINED AT LINE 172 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 199 IN multicart_v2.1_RAM_check.z80
L_RAM_TEST_PASSED:  3268 DEFINED AT LINE 202 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 183 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 195 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 200 IN multicart_v2.1_RAM_check.z80
L_RAM_TEST_FAILED:  327B DEFINED AT LINE 212 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 179 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 191 IN multicart_v2.1_RAM_check.z80
L_RAM_TEST_FINISHED: 328D DEFINED AT LINE 222 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 210 IN multicart_v2.1_RAM_check.z80
LOW_8K_RAM_TEST:    3297 DEFINED AT LINE 229 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 178 IN multicart_v2.1_RAM_check.z80
HIGH_8K_RAM_TEST:   329C DEFINED AT LINE 232 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 190 IN multicart_v2.1_RAM_check.z80
RAM_TEST_INIT_FINAL: 329F DEFINED AT LINE 234 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 231 IN multicart_v2.1_RAM_check.z80
RAM_TEST_LOOP:      32A2 DEFINED AT LINE 237 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 257 IN multicart_v2.1_RAM_check.z80
RAM_TESTED_AND_PASSED: 32BB DEFINED AT LINE 260 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 152 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 281 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 290 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 293 IN multicart_v2.1_RAM_check.z80
REGISTER_SAVE:      32BD DEFINED AT LINE 262 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 148 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 176 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 188 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 266 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 295 IN multicart_v2.1_RAM_check.z80
RAM_TEST_UPDATE_PROGRESS: 32BE DEFINED AT LINE 265 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 153 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 180 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 192 IN multicart_v2.1_RAM_check.z80
L_PRT_REG_RELOC:    32CB DEFINED AT LINE 272 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 268 IN multicart_v2.1_RAM_check.z80
L_PRINT_RT_PROGRESS: 32CF DEFINED AT LINE 276 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 271 IN multicart_v2.1_RAM_check.z80
F_INIT_ENTRIES:     32F5 DEFINED AT LINE 1 IN multicart_v2.1_images.z80
                    > USED AT LINE 261
                    > USED AT LINE 516 IN multicart_v2.1_input_routines.z80
ICE_BANK_OK:        3312 DEFINED AT LINE 18 IN multicart_v2.1_images.z80
                    > USED AT LINE 69 IN multicart_v2.1_images.z80
ICE_DONE:           333D DEFINED AT LINE 71 IN multicart_v2.1_images.z80
                    > USED AT LINE 21 IN multicart_v2.1_images.z80
                    > USED AT LINE 68 IN multicart_v2.1_images.z80
TVC_BAM_COPY_ADDRESS: 6000 DEFINED AT LINE 1 IN multicart_v2.1_flash.z80
                    > USED AT LINE 133 IN multicart_v2.1_flash.z80
                    > USED AT LINE 155 IN multicart_v2.1_flash.z80
                    > USED AT LINE 481 IN multicart_v2.1_flash.z80
F_DELETE_SELECTED_FROM_FLASH: 3342 DEFINED AT LINE 3 IN multicart_v2.1_flash.z80
                    > USED AT LINE 472 IN multicart_v2.1_input_routines.z80
NUM_OF_SST_SECTORS: 3374 DEFINED AT LINE 32 IN multicart_v2.1_flash.z80
                    > USED AT LINE 151 IN multicart_v2.1_flash.z80
                    > USED AT LINE 159 IN multicart_v2.1_flash.z80
                    > USED AT LINE 535 IN multicart_v2.1_flash.z80
                    > USED AT LINE 537 IN multicart_v2.1_flash.z80
TARGET_HIGH_SST:    3375 DEFINED AT LINE 34 IN multicart_v2.1_flash.z80
                    > USED AT LINE 128 IN multicart_v2.1_flash.z80
                    > USED AT LINE 474 IN multicart_v2.1_flash.z80
BAM_START_SST:      3376 DEFINED AT LINE 36 IN multicart_v2.1_flash.z80
                    > USED AT LINE 135 IN multicart_v2.1_flash.z80
                    > USED AT LINE 213 IN multicart_v2.1_flash.z80
                    > USED AT LINE 258 IN multicart_v2.1_flash.z80
                    > USED AT LINE 324 IN multicart_v2.1_flash.z80
                    > USED AT LINE 340 IN multicart_v2.1_flash.z80
                    > USED AT LINE 111 IN multicart_v2.1_rename.z80
REGISTER_TO_USE:    3378 DEFINED AT LINE 38 IN multicart_v2.1_flash.z80
                    > USED AT LINE 472 IN multicart_v2.1_flash.z80
                    > USED AT LINE 478 IN multicart_v2.1_flash.z80
                    > USED AT LINE 490 IN multicart_v2.1_flash.z80
                    > USED AT LINE 514 IN multicart_v2.1_flash.z80
                    > USED AT LINE 532 IN multicart_v2.1_flash.z80
REGISTER_VALUE:     337A DEFINED AT LINE 40 IN multicart_v2.1_flash.z80
                    > USED AT LINE 477 IN multicart_v2.1_flash.z80
                    > USED AT LINE 488 IN multicart_v2.1_flash.z80
                    > USED AT LINE 513 IN multicart_v2.1_flash.z80
DELETE_FOR_SST:     337B DEFINED AT LINE 44 IN multicart_v2.1_flash.z80
                    > USED AT LINE 14 IN multicart_v2.1_flash.z80
DELETE_FOR_AMD:     33C4 DEFINED AT LINE 82 IN multicart_v2.1_flash.z80
                    > USED AT LINE 11 IN multicart_v2.1_flash.z80
DELETE_FOR_ATMEL:   33DA DEFINED AT LINE 95 IN multicart_v2.1_flash.z80
                    > USED AT LINE 17 IN multicart_v2.1_flash.z80
COPY_SST_BAM_DIR:   33F0 DEFINED AT LINE 109 IN multicart_v2.1_flash.z80
                    > USED AT LINE 55 IN multicart_v2.1_flash.z80
                    > USED AT LINE 105 IN multicart_v2.1_rename.z80
L_NEXT_TRY:         33F7 DEFINED AT LINE 113 IN multicart_v2.1_flash.z80
                    > USED AT LINE 124 IN multicart_v2.1_flash.z80
L_START_COPY:       340B DEFINED AT LINE 125 IN multicart_v2.1_flash.z80
                    > USED AT LINE 119 IN multicart_v2.1_flash.z80
L_COPY_ONE_SECTOR:  343E DEFINED AT LINE 157 IN multicart_v2.1_flash.z80
                    > USED AT LINE 168 IN multicart_v2.1_flash.z80
REMOVE_FROM_BAM_SST: 3456 DEFINED AT LINE 174 IN multicart_v2.1_flash.z80
                    > USED AT LINE 62 IN multicart_v2.1_flash.z80
L_REMOVE_CART_SST:  347F DEFINED AT LINE 199 IN multicart_v2.1_flash.z80
                    > USED AT LINE 194 IN multicart_v2.1_flash.z80
L_CART_FULL_BYTE_REMOVAL_SST: 3498 DEFINED AT LINE 215 IN multicart_v2.1_flash.z80
                    > USED AT LINE 225 IN multicart_v2.1_flash.z80
L_LAST_FRACTION_SST: 34A7 DEFINED AT LINE 226 IN multicart_v2.1_flash.z80
                    > USED AT LINE 218 IN multicart_v2.1_flash.z80
L_MASK_LOOP_SST:    34AB DEFINED AT LINE 230 IN multicart_v2.1_flash.z80
                    > USED AT LINE 233 IN multicart_v2.1_flash.z80
L_REMOVE_CAS_SST:   34B4 DEFINED AT LINE 239 IN multicart_v2.1_flash.z80
                    > USED AT LINE 196 IN multicart_v2.1_flash.z80
                    > USED AT LINE 198 IN multicart_v2.1_flash.z80
L_REMOVE_CAS_SST_LOOP: 34B5 DEFINED AT LINE 241 IN multicart_v2.1_flash.z80
                    > USED AT LINE 292 IN multicart_v2.1_flash.z80
L_STEP_TO_ALLOCATION_BYTE: 34D2 DEFINED AT LINE 261 IN multicart_v2.1_flash.z80
                    > USED AT LINE 269 IN multicart_v2.1_flash.z80
L_ALLOCATION_BYTE_FOUND: 34DF DEFINED AT LINE 270 IN multicart_v2.1_flash.z80
                    > USED AT LINE 264 IN multicart_v2.1_flash.z80
L_STEP_TO_ALLOCATION_BIT: 34E7 DEFINED AT LINE 277 IN multicart_v2.1_flash.z80
                    > USED AT LINE 280 IN multicart_v2.1_flash.z80
L_ALLOCATION_BIT_FOUND: 34EC DEFINED AT LINE 281 IN multicart_v2.1_flash.z80
                    > USED AT LINE 273 IN multicart_v2.1_flash.z80
                    > USED AT LINE 276 IN multicart_v2.1_flash.z80
L_DONE_REMOVE_CAS_SST: 34FC DEFINED AT LINE 294 IN multicart_v2.1_flash.z80
                    > USED AT LINE 247 IN multicart_v2.1_flash.z80
L_DONE_REMOVE_SST:  3500 DEFINED AT LINE 298 IN multicart_v2.1_flash.z80
                    > USED AT LINE 229 IN multicart_v2.1_flash.z80
                    > USED AT LINE 237 IN multicart_v2.1_flash.z80
MOVE_SST_DIR_ENTRIES: 3501 DEFINED AT LINE 302 IN multicart_v2.1_flash.z80
                    > USED AT LINE 63 IN multicart_v2.1_flash.z80
L_DO_THE_DIR_MOVE_SST: 354E DEFINED AT LINE 362 IN multicart_v2.1_flash.z80
                    > USED AT LINE 358 IN multicart_v2.1_flash.z80
                    > USED AT LINE 360 IN multicart_v2.1_flash.z80
L_DIR_MOVE_DONE_SST: 3551 DEFINED AT LINE 365 IN multicart_v2.1_flash.z80
                    > USED AT LINE 361 IN multicart_v2.1_flash.z80
MOVE_SST_CART_RECORDS: 3553 DEFINED AT LINE 369 IN multicart_v2.1_flash.z80
                    > USED AT LINE 64 IN multicart_v2.1_flash.z80
L_MOVE_SST_CART_RECS: 3588 DEFINED AT LINE 409 IN multicart_v2.1_flash.z80
                    > USED AT LINE 406 IN multicart_v2.1_flash.z80
L_SST_CART_RECS_DONE: 358A DEFINED AT LINE 411 IN multicart_v2.1_flash.z80
                    > USED AT LINE 408 IN multicart_v2.1_flash.z80
FIX_SST_CART_RECORD_POINTERS: 358D DEFINED AT LINE 416 IN multicart_v2.1_flash.z80
                    > USED AT LINE 65 IN multicart_v2.1_flash.z80
L_FIX_STRUCT_LOOP:  35AF DEFINED AT LINE 439 IN multicart_v2.1_flash.z80
                    > USED AT LINE 466 IN multicart_v2.1_flash.z80
L_FIXIT:            35BF DEFINED AT LINE 449 IN multicart_v2.1_flash.z80
                    > USED AT LINE 445 IN multicart_v2.1_flash.z80
L_NO_NEED_TO_FIX:   35D0 DEFINED AT LINE 461 IN multicart_v2.1_flash.z80
                    > USED AT LINE 444 IN multicart_v2.1_flash.z80
                    > USED AT LINE 448 IN multicart_v2.1_flash.z80
WRITE_BACK_BAM_SST: 35DB DEFINED AT LINE 470 IN multicart_v2.1_flash.z80
                    > USED AT LINE 72 IN multicart_v2.1_flash.z80
                    > USED AT LINE 117 IN multicart_v2.1_rename.z80
L_SKIP_RELOC:       3601 DEFINED AT LINE 492 IN multicart_v2.1_flash.z80
                    > USED AT LINE 485 IN multicart_v2.1_flash.z80
L_WRITE_SECTOR_SST_LOOP: 3601 DEFINED AT LINE 493 IN multicart_v2.1_flash.z80
                    > USED AT LINE 539 IN multicart_v2.1_flash.z80
L_WRITE_ONE_SECTOR_SST: 3607 DEFINED AT LINE 497 IN multicart_v2.1_flash.z80
                    > USED AT LINE 526 IN multicart_v2.1_flash.z80
L_SKIP_BACKLOC:     3640 DEFINED AT LINE 534 IN multicart_v2.1_flash.z80
                    > USED AT LINE 530 IN multicart_v2.1_flash.z80
INIT_SST_SECTOR_ERASE: 364C DEFINED AT LINE 544 IN multicart_v2.1_flash.z80
                    > USED AT LINE 494 IN multicart_v2.1_flash.z80
L_POLLING:          367D DEFINED AT LINE 574 IN multicart_v2.1_flash.z80
                    > USED AT LINE 577 IN multicart_v2.1_flash.z80
MUL_C_BY_14H:       3685 DEFINED AT LINE 584 IN multicart_v2.1_flash.z80
                    > USED AT LINE 140 IN multicart_v2.1_flash.z80
                    > USED AT LINE 339 IN multicart_v2.1_flash.z80
                    > USED AT LINE 423 IN multicart_v2.1_flash.z80
L_MUL_LOOP_1:       368A DEFINED AT LINE 588 IN multicart_v2.1_flash.z80
                    > USED AT LINE 591 IN multicart_v2.1_flash.z80
L_MUL_LOOP_2:       3696 DEFINED AT LINE 597 IN multicart_v2.1_flash.z80
                    > USED AT LINE 600 IN multicart_v2.1_flash.z80
FIX_POINTERS:       369F DEFINED AT LINE 605 IN multicart_v2.1_flash.z80
                    > USED AT LINE 73 IN multicart_v2.1_flash.z80
L_DEC_FIRST_POS:    36BC DEFINED AT LINE 622 IN multicart_v2.1_flash.z80
                    > USED AT LINE 619 IN multicart_v2.1_flash.z80
L_POINTERS_DONE:    36C0 DEFINED AT LINE 625 IN multicart_v2.1_flash.z80
                    > USED AT LINE 615 IN multicart_v2.1_flash.z80
                    > USED AT LINE 621 IN multicart_v2.1_flash.z80
INPUT_BUF_LEN:      08A0 DEFINED AT LINE 1 IN multicart_v2.1_rename.z80
                    > USED AT LINE 166 IN multicart_v2.1_rename.z80
                    > USED AT LINE 212 IN multicart_v2.1_rename.z80
                    > USED AT LINE 216 IN multicart_v2.1_rename.z80
                    > USED AT LINE 235 IN multicart_v2.1_rename.z80
                    > USED AT LINE 248 IN multicart_v2.1_rename.z80
                    > USED AT LINE 277 IN multicart_v2.1_rename.z80
                    > USED AT LINE 295 IN multicart_v2.1_rename.z80
INPUT_BUFFER:       08A1 DEFINED AT LINE 2 IN multicart_v2.1_rename.z80
                    > USED AT LINE 113 IN multicart_v2.1_rename.z80
                    > USED AT LINE 145 IN multicart_v2.1_rename.z80
                    > USED AT LINE 154 IN multicart_v2.1_rename.z80
                    > USED AT LINE 168 IN multicart_v2.1_rename.z80
                    > USED AT LINE 217 IN multicart_v2.1_rename.z80
                    > USED AT LINE 251 IN multicart_v2.1_rename.z80
F_RENAME_FILE:      36C1 DEFINED AT LINE 5 IN multicart_v2.1_rename.z80
                    > USED AT LINE 526 IN multicart_v2.1_input_routines.z80
L_CHECK_SST:        36D3 DEFINED AT LINE 14 IN multicart_v2.1_rename.z80
                    > USED AT LINE 12 IN multicart_v2.1_rename.z80
L_CHECK_ATMEL:      36D9 DEFINED AT LINE 18 IN multicart_v2.1_rename.z80
                    > USED AT LINE 16 IN multicart_v2.1_rename.z80
RENAME_AMD:         36DF DEFINED AT LINE 23 IN multicart_v2.1_rename.z80
                    > USED AT LINE 13 IN multicart_v2.1_rename.z80
RENAME_ATMEL:       36EF DEFINED AT LINE 34 IN multicart_v2.1_rename.z80
                    > USED AT LINE 21 IN multicart_v2.1_rename.z80
RENAME_UNKOWN:      36FF DEFINED AT LINE 45 IN multicart_v2.1_rename.z80
                    > USED AT LINE 20 IN multicart_v2.1_rename.z80
FINISH_RENAME_NOT_SUPPORTED: 370F DEFINED AT LINE 56 IN multicart_v2.1_rename.z80
                    > USED AT LINE 31 IN multicart_v2.1_rename.z80
                    > USED AT LINE 42 IN multicart_v2.1_rename.z80
                    > USED AT LINE 53 IN multicart_v2.1_rename.z80
PRINT_FOUND_FLASH_IC: 371D DEFINED AT LINE 64 IN multicart_v2.1_rename.z80
                    > USED AT LINE 24 IN multicart_v2.1_rename.z80
                    > USED AT LINE 35 IN multicart_v2.1_rename.z80
                    > USED AT LINE 46 IN multicart_v2.1_rename.z80
                    > USED AT LINE 79 IN multicart_v2.1_rename.z80
PRINT_NOT_SUPPORTED: 3728 DEFINED AT LINE 71 IN multicart_v2.1_rename.z80
                    > USED AT LINE 57 IN multicart_v2.1_rename.z80
RENAME_SST:         3733 DEFINED AT LINE 78 IN multicart_v2.1_rename.z80
                    > USED AT LINE 17 IN multicart_v2.1_rename.z80
L_EXECUTE_SST_RENAME: 3764 DEFINED AT LINE 104 IN multicart_v2.1_rename.z80
                    > USED AT LINE 97 IN multicart_v2.1_rename.z80
SETUP_STRING_POINTERS: 378A DEFINED AT LINE 125 IN multicart_v2.1_rename.z80
                    > USED AT LINE 106 IN multicart_v2.1_rename.z80
                    > USED AT LINE 149 IN multicart_v2.1_rename.z80
SETUP_INPUT_FIELD:  37B1 DEFINED AT LINE 148 IN multicart_v2.1_rename.z80
                    > USED AT LINE 94 IN multicart_v2.1_rename.z80
L_STR_END_SEARCH_LOOP: 37C0 DEFINED AT LINE 157 IN multicart_v2.1_rename.z80
                    > USED AT LINE 162 IN multicart_v2.1_rename.z80
L_STR_END_SEARCH_LOOP_DONE: 37C7 DEFINED AT LINE 164 IN multicart_v2.1_rename.z80
                    > USED AT LINE 159 IN multicart_v2.1_rename.z80
INPUT_STR:          37D7 DEFINED AT LINE 178 IN multicart_v2.1_rename.z80
                    > USED AT LINE 95 IN multicart_v2.1_rename.z80
L_CHECK_TVC_INPUT_BUFFER: 37D8 DEFINED AT LINE 181 IN multicart_v2.1_rename.z80
                    > USED AT LINE 189 IN multicart_v2.1_rename.z80
L_INPUT_STR_LOOP:   37E2 DEFINED AT LINE 191 IN multicart_v2.1_rename.z80
                    > USED AT LINE 186 IN multicart_v2.1_rename.z80
                    > USED AT LINE 207 IN multicart_v2.1_rename.z80
                    > USED AT LINE 210 IN multicart_v2.1_rename.z80
                    > USED AT LINE 214 IN multicart_v2.1_rename.z80
                    > USED AT LINE 237 IN multicart_v2.1_rename.z80
                    > USED AT LINE 279 IN multicart_v2.1_rename.z80
                    > USED AT LINE 297 IN multicart_v2.1_rename.z80
L_INPUT_STR_EXIT:   3821 DEFINED AT LINE 239 IN multicart_v2.1_rename.z80
                    > USED AT LINE 197 IN multicart_v2.1_rename.z80
L_STR_BUFFER_FILL_SPACE_LOOP: 3839 DEFINED AT LINE 256 IN multicart_v2.1_rename.z80
                    > USED AT LINE 261 IN multicart_v2.1_rename.z80
L_INPUT_STR_ESC:    3841 DEFINED AT LINE 265 IN multicart_v2.1_rename.z80
                    > USED AT LINE 203 IN multicart_v2.1_rename.z80
L_INPUT_STR_DEL:    384C DEFINED AT LINE 276 IN multicart_v2.1_rename.z80
                    > USED AT LINE 200 IN multicart_v2.1_rename.z80
SORT_TYPE_NAME:     0001 DEFINED AT LINE 1 IN multicart_v2.1_sort.z80
                    > USED AT LINE 510 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 243 IN multicart_v2.1_sort.z80
SORT_TYPE_SIZE:     0002 DEFINED AT LINE 2 IN multicart_v2.1_sort.z80
                    > USED AT LINE 504 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 248 IN multicart_v2.1_sort.z80
SORT_TYPE_TYPE:     0003 DEFINED AT LINE 3 IN multicart_v2.1_sort.z80
                    > USED AT LINE 507 IN multicart_v2.1_input_routines.z80
INITIAL_SORT_TYPES: 386D DEFINED AT LINE 5 IN multicart_v2.1_sort.z80
                    > USED AT LINE 267 IN multicart_v2.1_sort.z80
TYPE_ORDER:         3871 DEFINED AT LINE 8 IN multicart_v2.1_sort.z80
                    > USED AT LINE 33 IN multicart_v2.1_sort.z80
                    > USED AT LINE 41 IN multicart_v2.1_sort.z80
PREVIOUS_SORT_TYPE: 3874 DEFINED AT LINE 11 IN multicart_v2.1_sort.z80
                    > USED AT LINE 514 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 171 IN multicart_v2.1_sort.z80
                    > USED AT LINE 273 IN multicart_v2.1_sort.z80
                    > USED AT LINE 277 IN multicart_v2.1_sort.z80
CURRENT_SORT_TYPE:  3875 DEFINED AT LINE 13 IN multicart_v2.1_sort.z80
                    > USED AT LINE 515 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 168 IN multicart_v2.1_sort.z80
                    > USED AT LINE 264 IN multicart_v2.1_sort.z80
                    > USED AT LINE 275 IN multicart_v2.1_sort.z80
COMPARE_BY_SIZE:    3876 DEFINED AT LINE 16 IN multicart_v2.1_sort.z80
                    > USED AT LINE 250 IN multicart_v2.1_sort.z80
COMPARE_BY_TYPE:    3883 DEFINED AT LINE 25 IN multicart_v2.1_sort.z80
                    > USED AT LINE 253 IN multicart_v2.1_sort.z80
L_TYPE_LOOP_A:      388B DEFINED AT LINE 34 IN multicart_v2.1_sort.z80
                    > USED AT LINE 37 IN multicart_v2.1_sort.z80
L_TYPE_LOOP_B:      3894 DEFINED AT LINE 42 IN multicart_v2.1_sort.z80
                    > USED AT LINE 44 IN multicart_v2.1_sort.z80
COMPARE_BY_NAME:    389C DEFINED AT LINE 53 IN multicart_v2.1_sort.z80
                    > USED AT LINE 245 IN multicart_v2.1_sort.z80
L_STR_COMPARE_LOOP: 38AD DEFINED AT LINE 69 IN multicart_v2.1_sort.z80
                    > USED AT LINE 83 IN multicart_v2.1_sort.z80
L_STR_COMPARE_DONE: 38C4 DEFINED AT LINE 85 IN multicart_v2.1_sort.z80
                    > USED AT LINE 79 IN multicart_v2.1_sort.z80
MODIFY_CHAR_CODE:   38C8 DEFINED AT LINE 91 IN multicart_v2.1_sort.z80
                    > USED AT LINE 72 IN multicart_v2.1_sort.z80
                    > USED AT LINE 76 IN multicart_v2.1_sort.z80
L_SEARCH_CHAR_LOOP: 38D5 DEFINED AT LINE 101 IN multicart_v2.1_sort.z80
                    > USED AT LINE 106 IN multicart_v2.1_sort.z80
L_FOUND:            38E4 DEFINED AT LINE 111 IN multicart_v2.1_sort.z80
                    > USED AT LINE 105 IN multicart_v2.1_sort.z80
L_MODIFY_CHAR_END:  38E7 DEFINED AT LINE 115 IN multicart_v2.1_sort.z80
                    > USED AT LINE 108 IN multicart_v2.1_sort.z80
                    > USED AT LINE 110 IN multicart_v2.1_sort.z80
GET_STRING_POINTER: 38EA DEFINED AT LINE 120 IN multicart_v2.1_sort.z80
                    > USED AT LINE 58 IN multicart_v2.1_sort.z80
                    > USED AT LINE 63 IN multicart_v2.1_sort.z80
CONVERT_A:          38F4 DEFINED AT LINE 130 IN multicart_v2.1_sort.z80
                    > USED AT LINE 71 IN multicart_v2.1_sort.z80
                    > USED AT LINE 75 IN multicart_v2.1_sort.z80
L_NOT_CAPITAL_ASCII: 38FF DEFINED AT LINE 137 IN multicart_v2.1_sort.z80
                    > USED AT LINE 132 IN multicart_v2.1_sort.z80
                    > USED AT LINE 134 IN multicart_v2.1_sort.z80
L_NOT_CAPITAL_ACUTE: 3909 DEFINED AT LINE 143 IN multicart_v2.1_sort.z80
                    > USED AT LINE 139 IN multicart_v2.1_sort.z80
                    > USED AT LINE 141 IN multicart_v2.1_sort.z80
SORT:               390A DEFINED AT LINE 146 IN multicart_v2.1_sort.z80
                    > USED AT LINE 281 IN multicart_v2.1_sort.z80
L_BUBBLE_BIG_LOOP:  3911 DEFINED AT LINE 151 IN multicart_v2.1_sort.z80
                    > USED AT LINE 237 IN multicart_v2.1_sort.z80
L_BUBBLE_SMALL_LOOP: 3913 DEFINED AT LINE 154 IN multicart_v2.1_sort.z80
                    > USED AT LINE 175 IN multicart_v2.1_sort.z80
L_COMPARE_THEM:     3921 DEFINED AT LINE 167 IN multicart_v2.1_sort.z80
                    > USED AT LINE 162 IN multicart_v2.1_sort.z80
L_CHECK_C_BIT:      3931 DEFINED AT LINE 174 IN multicart_v2.1_sort.z80
                    > USED AT LINE 170 IN multicart_v2.1_sort.z80
L_END_ONE_BUBBLE:   3933 DEFINED AT LINE 177 IN multicart_v2.1_sort.z80
                    > USED AT LINE 165 IN multicart_v2.1_sort.z80
                    > USED AT LINE 173 IN multicart_v2.1_sort.z80
L_INDEED_MOVE_THE_BLOCK: 393F DEFINED AT LINE 189 IN multicart_v2.1_sort.z80
                    > USED AT LINE 184 IN multicart_v2.1_sort.z80
L_TRANSFER_DONE:    396C DEFINED AT LINE 230 IN multicart_v2.1_sort.z80
                    > USED AT LINE 187 IN multicart_v2.1_sort.z80
SET_COMPARE_BITS:   3976 DEFINED AT LINE 242 IN multicart_v2.1_sort.z80
                    > USED AT LINE 169 IN multicart_v2.1_sort.z80
                    > USED AT LINE 172 IN multicart_v2.1_sort.z80
L_SCB_SKIP1:        397E DEFINED AT LINE 247 IN multicart_v2.1_sort.z80
                    > USED AT LINE 244 IN multicart_v2.1_sort.z80
L_SCB_SKIP2:        3986 DEFINED AT LINE 252 IN multicart_v2.1_sort.z80
                    > USED AT LINE 249 IN multicart_v2.1_sort.z80
F_SORT:             398A DEFINED AT LINE 259 IN multicart_v2.1_sort.z80
                    > USED AT LINE 505 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 508 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 511 IN multicart_v2.1_input_routines.z80
L_FSBT_CONT:        39A0 DEFINED AT LINE 272 IN multicart_v2.1_sort.z80
                    > USED AT LINE 266 IN multicart_v2.1_sort.z80
L_SORT_DONE:        39B0 DEFINED AT LINE 283 IN multicart_v2.1_sort.z80
                    > USED AT LINE 262 IN multicart_v2.1_sort.z80
INVERT_LIST:        39B1 DEFINED AT LINE 286 IN multicart_v2.1_sort.z80
                    > USED AT LINE 279 IN multicart_v2.1_sort.z80
L_INVERT_LOOP:      39D1 DEFINED AT LINE 305 IN multicart_v2.1_sort.z80
                    > USED AT LINE 332 IN multicart_v2.1_sort.z80
L_INVERT_LDIR_LOOP: 39D4 DEFINED AT LINE 309 IN multicart_v2.1_sort.z80
                    > USED AT LINE 317 IN multicart_v2.1_sort.z80
L_INVERT_DE_LOOP:   39E1 DEFINED AT LINE 323 IN multicart_v2.1_sort.z80
L_INVERT_DONE:      39EB DEFINED AT LINE 334 IN multicart_v2.1_sort.z80
                    > USED AT LINE 321 IN multicart_v2.1_sort.z80
STR_AUTHOR:         39EC DEFINED AT LINE 1 IN multicart_v2.1_data.z80
                    > USED AT LINE 37 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 41 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 42 IN multicart_v2.1_print_routines.z80
STR_AUTHOR_END:     3A0E DEFINED AT LINE 3 IN multicart_v2.1_data.z80
                    > USED AT LINE 37 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 42 IN multicart_v2.1_print_routines.z80
STR_MOPS:           3A0E DEFINED AT LINE 5 IN multicart_v2.1_data.z80
STR_MOPS_END:       3A12 DEFINED AT LINE 7 IN multicart_v2.1_data.z80
STR_TYPE_SIZE_BAS:  3A12 DEFINED AT LINE 8 IN multicart_v2.1_data.z80
                    > USED AT LINE 446 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 458 IN multicart_v2.1_print_routines.z80
STR_TYPE_SIZE_BAS_END: 3A16 DEFINED AT LINE 10 IN multicart_v2.1_data.z80
STR_TYPE_CART:      3A16 DEFINED AT LINE 11 IN multicart_v2.1_data.z80
                    > USED AT LINE 468 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 469 IN multicart_v2.1_print_routines.z80
STR_TYPE_CART_END:  3A1A DEFINED AT LINE 13 IN multicart_v2.1_data.z80
                    > USED AT LINE 469 IN multicart_v2.1_print_routines.z80
STR_TYPE_CAS:       3A1A DEFINED AT LINE 14 IN multicart_v2.1_data.z80
                    > USED AT LINE 477 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 478 IN multicart_v2.1_print_routines.z80
STR_TYPE_CAS_END:   3A1E DEFINED AT LINE 16 IN multicart_v2.1_data.z80
                    > USED AT LINE 478 IN multicart_v2.1_print_routines.z80
STR_TYPE_BIN:       3A1E DEFINED AT LINE 17 IN multicart_v2.1_data.z80
                    > USED AT LINE 486 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 487 IN multicart_v2.1_print_routines.z80
STR_TYPE_BIN_END:   3A22 DEFINED AT LINE 19 IN multicart_v2.1_data.z80
                    > USED AT LINE 487 IN multicart_v2.1_print_routines.z80
STR_TYPE_DAT:       3A22 DEFINED AT LINE 20 IN multicart_v2.1_data.z80
                    > USED AT LINE 491 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 492 IN multicart_v2.1_print_routines.z80
STR_TYPE_DAT_END:   3A26 DEFINED AT LINE 22 IN multicart_v2.1_data.z80
                    > USED AT LINE 492 IN multicart_v2.1_print_routines.z80
STR_FLASH_IC_SST:   3A26 DEFINED AT LINE 24 IN multicart_v2.1_data.z80
                    > USED AT LINE 45 IN multicart_v2.1_flash.z80
                    > USED AT LINE 46 IN multicart_v2.1_flash.z80
                    > USED AT LINE 81 IN multicart_v2.1_rename.z80
                    > USED AT LINE 82 IN multicart_v2.1_rename.z80
STR_FLASH_IC_SST_END: 3A30 DEFINED AT LINE 26 IN multicart_v2.1_data.z80
                    > USED AT LINE 46 IN multicart_v2.1_flash.z80
                    > USED AT LINE 82 IN multicart_v2.1_rename.z80
STR_FLASH_IC_AMD:   3A30 DEFINED AT LINE 27 IN multicart_v2.1_data.z80
                    > USED AT LINE 83 IN multicart_v2.1_flash.z80
                    > USED AT LINE 84 IN multicart_v2.1_flash.z80
                    > USED AT LINE 26 IN multicart_v2.1_rename.z80
                    > USED AT LINE 27 IN multicart_v2.1_rename.z80
STR_FLASH_IC_AMD_END: 3A38 DEFINED AT LINE 29 IN multicart_v2.1_data.z80
                    > USED AT LINE 84 IN multicart_v2.1_flash.z80
                    > USED AT LINE 27 IN multicart_v2.1_rename.z80
STR_FLASH_IC_ATMEL: 3A38 DEFINED AT LINE 30 IN multicart_v2.1_data.z80
                    > USED AT LINE 96 IN multicart_v2.1_flash.z80
                    > USED AT LINE 97 IN multicart_v2.1_flash.z80
                    > USED AT LINE 37 IN multicart_v2.1_rename.z80
                    > USED AT LINE 38 IN multicart_v2.1_rename.z80
STR_FLASH_IC_ATMEL_END: 3A40 DEFINED AT LINE 32 IN multicart_v2.1_data.z80
                    > USED AT LINE 97 IN multicart_v2.1_flash.z80
                    > USED AT LINE 38 IN multicart_v2.1_rename.z80
STR_ABC_ORDER:      3A40 DEFINED AT LINE 33 IN multicart_v2.1_data.z80
                    > USED AT LINE 99 IN multicart_v2.1_sort.z80
                    > USED AT LINE 100 IN multicart_v2.1_sort.z80
                    > USED AT LINE 112 IN multicart_v2.1_sort.z80
STR_ABC_ORDER_END:  3A63 DEFINED AT LINE 45 IN multicart_v2.1_data.z80
                    > USED AT LINE 100 IN multicart_v2.1_sort.z80
                    > USED AT LINE 112 IN multicart_v2.1_sort.z80
EXIT_TO_BASIC:      KILPS BASIC-BE DEFINED AT LINE 1 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 398
STR_LANG_LETTER:    000H DEFINED AT LINE 2 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 32 IN multicart_v2.1_print_routines.z80
STR_MESSAGE:        3A63 DEFINED AT LINE 4 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 10 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 11 IN multicart_v2.1_print_routines.z80
STR_MESSAGE_END:    3A96 DEFINED AT LINE 6 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 11 IN multicart_v2.1_print_routines.z80
STR_RAM_FOUND:      3A96 DEFINED AT LINE 7 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 188 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 189 IN multicart_v2.1_print_routines.z80
STR_RAM_FOUND_END:  3AA5 DEFINED AT LINE 9 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 189 IN multicart_v2.1_print_routines.z80
STR_FLASH_FOUND:    3AA5 DEFINED AT LINE 10 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 205 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 206 IN multicart_v2.1_print_routines.z80
STR_FLASH_FOUND_END: 3AB6 DEFINED AT LINE 12 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 206 IN multicart_v2.1_print_routines.z80
STR_FREE_SPACE:     3AB6 DEFINED AT LINE 13 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 230 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 231 IN multicart_v2.1_print_routines.z80
STR_FREE_SPACE_END: 3AD0 DEFINED AT LINE 15 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 231 IN multicart_v2.1_print_routines.z80
STR_BLOCKS:         3AD0 DEFINED AT LINE 16 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 239 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 240 IN multicart_v2.1_print_routines.z80
STR_BLOCKS_END:     3AD6 DEFINED AT LINE 18 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 240 IN multicart_v2.1_print_routines.z80
STR_FLASH_SIZES:    3AD6 DEFINED AT LINE 20 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 26 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 26 IN multicart_v2.1_data_str_hu.z80
FLASH_SIZES_POS:    3AEA DEFINED AT LINE 25 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 210 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 218 IN multicart_v2.1_print_routines.z80
STR_RAM_SIZES:      3AF4 DEFINED AT LINE 27 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 40 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 40 IN multicart_v2.1_data_str_hu.z80
STR_CART_SIZE:      3AFF DEFINED AT LINE 31 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 261 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 522 IN multicart_v2.1_print_routines.z80
RAM_SIZES_POS:      3B1C DEFINED AT LINE 38 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 193 IN multicart_v2.1_print_routines.z80
STR_NAME:           3B2C DEFINED AT LINE 41 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 318 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 319 IN multicart_v2.1_print_routines.z80
STR_NAME_END:       3B2F DEFINED AT LINE 43 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 319 IN multicart_v2.1_print_routines.z80
STR_SIZE:           3B2F DEFINED AT LINE 44 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 338 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 339 IN multicart_v2.1_print_routines.z80
STR_SIZE_END:       3B33 DEFINED AT LINE 46 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 339 IN multicart_v2.1_print_routines.z80
STR_TYPE:           3B33 DEFINED AT LINE 47 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 328 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 329 IN multicart_v2.1_print_routines.z80
STR_TYPE_END:       3B37 DEFINED AT LINE 49 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 329 IN multicart_v2.1_print_routines.z80
STR_USAGE:          3B37 DEFINED AT LINE 50 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 51 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 52 IN multicart_v2.1_print_routines.z80
STR_USAGE_END:      3B4B DEFINED AT LINE 52 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 52 IN multicart_v2.1_print_routines.z80
STR_UPDN:           3B4B DEFINED AT LINE 53 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 61 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 62 IN multicart_v2.1_print_routines.z80
STR_UPDN_END:       3B66 DEFINED AT LINE 55 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 62 IN multicart_v2.1_print_routines.z80
STR_PGUPDN:         3B66 DEFINED AT LINE 56 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 71 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 72 IN multicart_v2.1_print_routines.z80
STR_PGUPDN_END:     3B82 DEFINED AT LINE 60 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 72 IN multicart_v2.1_print_routines.z80
STR_TOGGLE_RESET:   3B82 DEFINED AT LINE 61 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 81 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 82 IN multicart_v2.1_print_routines.z80
STR_TOGGLE_RESET_END: 3B99 DEFINED AT LINE 63 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 82 IN multicart_v2.1_print_routines.z80
STR_START_PROGRAM:  3B99 DEFINED AT LINE 64 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 91 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 92 IN multicart_v2.1_print_routines.z80
STR_START_PROGRAM_END: 3BB6 DEFINED AT LINE 66 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 92 IN multicart_v2.1_print_routines.z80
STR_DELETE_PROGRAM: 3BB6 DEFINED AT LINE 67 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 101 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 102 IN multicart_v2.1_print_routines.z80
STR_DELETE_PROGRAM_END: 3BD1 DEFINED AT LINE 69 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 102 IN multicart_v2.1_print_routines.z80
STR_SORT_INSTRUCTIONS: 3BD1 DEFINED AT LINE 70 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 121 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 122 IN multicart_v2.1_print_routines.z80
STR_SORT_INSTRUCTIONS_END: 3BED DEFINED AT LINE 72 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 122 IN multicart_v2.1_print_routines.z80
STR_SORT_RESET:     3BED DEFINED AT LINE 73 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 131 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 132 IN multicart_v2.1_print_routines.z80
STR_SORT_RESET_END: 3BFF DEFINED AT LINE 75 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 132 IN multicart_v2.1_print_routines.z80
STR_RENAME:         3BFF DEFINED AT LINE 76 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 111 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 112 IN multicart_v2.1_print_routines.z80
STR_RENAME_END:     3C1B DEFINED AT LINE 78 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 112 IN multicart_v2.1_print_routines.z80
STR_RESET_CART:     3C1B DEFINED AT LINE 79 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 156 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 157 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 167 IN multicart_v2.1_print_routines.z80
STR_RESET_CART_END: 3C39 DEFINED AT LINE 81 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 157 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 167 IN multicart_v2.1_print_routines.z80
STR_ENABLED:        3C39 DEFINED AT LINE 82 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 171 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 174 IN multicart_v2.1_print_routines.z80
STR_ENABLED_END:    3C3D DEFINED AT LINE 84 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 171 IN multicart_v2.1_print_routines.z80
STR_DISABLED:       3C3D DEFINED AT LINE 85 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 176 IN multicart_v2.1_print_routines.z80
STR_DISABLED_END:   3C41 DEFINED AT LINE 87 IN multicart_v2.1_data_str_hu.z80
STR_RAM_TEST:       3C41 DEFINED AT LINE 88 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 74 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 109 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 110 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 115 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 116 IN multicart_v2.1_RAM_check.z80
STR_RAM_TEST_END:   3C48 DEFINED AT LINE 90 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 74 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 109 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 115 IN multicart_v2.1_RAM_check.z80
TEST_CONTENT:       3C48 DEFINED AT LINE 91 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 341
                    > USED AT LINE 342
TEST_CONTENT_END:   3C67 DEFINED AT LINE 93 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 341
STR_DELETE_QUESTION: 3C67 DEFINED AT LINE 95 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 327 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 328 IN multicart_v2.1_dialogbox.z80
STR_DELETE_QUESTION_END: 3C86 DEFINED AT LINE 97 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 328 IN multicart_v2.1_dialogbox.z80
STR_DELETE_ANSWER:  3C86 DEFINED AT LINE 98 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 390 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 391 IN multicart_v2.1_dialogbox.z80
STR_DELETE_ANSWER_END: 3C89 DEFINED AT LINE 100 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 391 IN multicart_v2.1_dialogbox.z80
STR_FOUND_FLASH_CHIP: 3C89 DEFINED AT LINE 101 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 4 IN multicart_v2.1_flash.z80
                    > USED AT LINE 5 IN multicart_v2.1_flash.z80
                    > USED AT LINE 65 IN multicart_v2.1_rename.z80
                    > USED AT LINE 66 IN multicart_v2.1_rename.z80
STR_FOUND_FLASH_CHIP_END: 3C9D DEFINED AT LINE 103 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 5 IN multicart_v2.1_flash.z80
                    > USED AT LINE 66 IN multicart_v2.1_rename.z80
STR_FLASH_IC_UNKNOWN: 3C9D DEFINED AT LINE 104 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 19 IN multicart_v2.1_flash.z80
                    > USED AT LINE 20 IN multicart_v2.1_flash.z80
                    > USED AT LINE 48 IN multicart_v2.1_rename.z80
                    > USED AT LINE 49 IN multicart_v2.1_rename.z80
STR_FLASH_IC_UNKNOWN_END: 3CA7 DEFINED AT LINE 106 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 20 IN multicart_v2.1_flash.z80
                    > USED AT LINE 49 IN multicart_v2.1_rename.z80
STR_FLASH_CREATE_WORK_COPY: 3CA7 DEFINED AT LINE 107 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 50 IN multicart_v2.1_flash.z80
                    > USED AT LINE 51 IN multicart_v2.1_flash.z80
STR_FLASH_CREATE_WORK_COPY_END: 3CC2 DEFINED AT LINE 109 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 51 IN multicart_v2.1_flash.z80
STR_FLASH_MODIFY_FS: 3CC2 DEFINED AT LINE 110 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 57 IN multicart_v2.1_flash.z80
                    > USED AT LINE 58 IN multicart_v2.1_flash.z80
STR_FLASH_MODIFY_FS_END: 3CE2 DEFINED AT LINE 112 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 58 IN multicart_v2.1_flash.z80
STR_FLASH_UPDATE:   3CE2 DEFINED AT LINE 113 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 67 IN multicart_v2.1_flash.z80
                    > USED AT LINE 68 IN multicart_v2.1_flash.z80
STR_FLASH_UPDATE_END: 3CFD DEFINED AT LINE 115 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 68 IN multicart_v2.1_flash.z80
STR_FLASH_DONE:     3CFD DEFINED AT LINE 116 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 75 IN multicart_v2.1_flash.z80
                    > USED AT LINE 76 IN multicart_v2.1_flash.z80
STR_FLASH_DONE_END: 3D02 DEFINED AT LINE 118 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 76 IN multicart_v2.1_flash.z80
STR_FLASH_NOT_SUPPORTED: 3D02 DEFINED AT LINE 119 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 24 IN multicart_v2.1_flash.z80
                    > USED AT LINE 25 IN multicart_v2.1_flash.z80
                    > USED AT LINE 88 IN multicart_v2.1_flash.z80
                    > USED AT LINE 89 IN multicart_v2.1_flash.z80
                    > USED AT LINE 101 IN multicart_v2.1_flash.z80
                    > USED AT LINE 102 IN multicart_v2.1_flash.z80
STR_FLASH_NOT_SUPPORTED_END: 3D1D DEFINED AT LINE 121 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 25 IN multicart_v2.1_flash.z80
                    > USED AT LINE 89 IN multicart_v2.1_flash.z80
                    > USED AT LINE 102 IN multicart_v2.1_flash.z80
STR_FLASH_PRESS_SPACE: 3D1D DEFINED AT LINE 122 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 563 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 564 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 474 IN multicart_v2.1_input_routines.z80
                    > USED AT LINE 475 IN multicart_v2.1_input_routines.z80
STR_FLASH_PRESS_SPACE_END: 3D3B DEFINED AT LINE 124 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 564 IN multicart_v2.1_dialogbox.z80
                    > USED AT LINE 475 IN multicart_v2.1_input_routines.z80
STR_FLASH_RENAME_NOT_SUPPORTED: 3D3B DEFINED AT LINE 125 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 72 IN multicart_v2.1_rename.z80
                    > USED AT LINE 73 IN multicart_v2.1_rename.z80
STR_FLASH_RENAME_NOT_SUPPORTED_END: 3D5A DEFINED AT LINE 127 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 73 IN multicart_v2.1_rename.z80
STR_RENAME_Q_NEW_NAME: 3D5A DEFINED AT LINE 129 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 86 IN multicart_v2.1_rename.z80
                    > USED AT LINE 87 IN multicart_v2.1_rename.z80
STR_RENAME_Q_NEW_NAME_END: 3D71 DEFINED AT LINE 131 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 87 IN multicart_v2.1_rename.z80
STR_RENAME_Q_INSTRUCTION: 3D71 DEFINED AT LINE 132 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 90 IN multicart_v2.1_rename.z80
                    > USED AT LINE 91 IN multicart_v2.1_rename.z80
STR_RENAME_Q_INSTRUCTION_END: 3D8C DEFINED AT LINE 134 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 91 IN multicart_v2.1_rename.z80
STR_TEST_CART_RAM:  3D8C DEFINED AT LINE 135 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 145 IN multicart_v2.1_print_routines.z80
                    > USED AT LINE 146 IN multicart_v2.1_print_routines.z80
STR_TEST_CART_RAM_END: 3DA2 DEFINED AT LINE 137 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 146 IN multicart_v2.1_print_routines.z80
STR_PASSED_SO_FAR:  3DA2 DEFINED AT LINE 138 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 145 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 146 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 277 IN multicart_v2.1_RAM_check.z80
STR_PASSED_SO_FAR_END: 3DAB DEFINED AT LINE 140 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 146 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 277 IN multicart_v2.1_RAM_check.z80
STR_TESTING_RAM:    3DAB DEFINED AT LINE 142 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 140 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 141 IN multicart_v2.1_RAM_check.z80
STR_TESTING_RAM_END: 3DC7 DEFINED AT LINE 144 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 141 IN multicart_v2.1_RAM_check.z80
STR_RAM_TEST_OK:    3DC7 DEFINED AT LINE 145 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 206 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 207 IN multicart_v2.1_RAM_check.z80
STR_RAM_TEST_OK_END: 3DE7 DEFINED AT LINE 147 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 207 IN multicart_v2.1_RAM_check.z80
STR_RAM_TEST_NOK:   3DE7 DEFINED AT LINE 148 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 217 IN multicart_v2.1_RAM_check.z80
                    > USED AT LINE 218 IN multicart_v2.1_RAM_check.z80
STR_RAM_TEST_NOK_END: 3E04 DEFINED AT LINE 150 IN multicart_v2.1_data_str_hu.z80
                    > USED AT LINE 218 IN multicart_v2.1_RAM_check.z80
F_REWRITE_FLASH:    3E04 DEFINED AT LINE 335
WAITREWRITE:        3E1A DEFINED AT LINE 346
                    > USED AT LINE 347
                    > USED AT LINE 349
F_WINBOND_WRITE_128: 3E20 DEFINED AT LINE 354
                    > USED AT LINE 336
END_RELOC:          3E39 DEFINED AT LINE 375
                    > USED AT LINE 281
TEST_DIR_STRUCT:    1000 DEFINED AT LINE 7 IN multicart_v2.1_tests.z80
                    > USED AT LINE 11 IN multicart_v2.1_tests.z80
TEST_GET_DIRS:      1016 DEFINED AT LINE 10 IN multicart_v2.1_tests.z80
                    > USED AT LINE 1 IN multicart_v2.1_tests.z80
TEST_DIR_LOOP:      102B DEFINED AT LINE 18 IN multicart_v2.1_tests.z80
                    > USED AT LINE 19 IN multicart_v2.1_tests.z80
TEST_NO_FILE_STRUCT: 102D DEFINED AT LINE 21 IN multicart_v2.1_tests.z80
                    > USED AT LINE 28 IN multicart_v2.1_tests.z80
TEST_COPY_NO_FILE:  1042 DEFINED AT LINE 27 IN multicart_v2.1_tests.z80
                    > USED AT LINE 2 IN multicart_v2.1_tests.z80
TEST_LOAD_NO_FILE_LOOP: 1048 DEFINED AT LINE 30 IN multicart_v2.1_tests.z80
                    > USED AT LINE 31 IN multicart_v2.1_tests.z80
TEST_COPY_FILE_STRUCT: 104A DEFINED AT LINE 33 IN multicart_v2.1_tests.z80
                    > USED AT LINE 40 IN multicart_v2.1_tests.z80
TEST_COPY_FILE:     1056 DEFINED AT LINE 39 IN multicart_v2.1_tests.z80
                    > USED AT LINE 3 IN multicart_v2.1_tests.z80
TEST_LOAD_FILE_LOOP: 105C DEFINED AT LINE 42 IN multicart_v2.1_tests.z80
                    > USED AT LINE 43 IN multicart_v2.1_tests.z80
TEST_LOAD_BIN_FILE_STRUCT: 105E DEFINED AT LINE 46 IN multicart_v2.1_tests.z80
                    > USED AT LINE 53 IN multicart_v2.1_tests.z80
TEST_LOAD_BIN_FILE: 1068 DEFINED AT LINE 52 IN multicart_v2.1_tests.z80
                    > USED AT LINE 4 IN multicart_v2.1_tests.z80
TEST_LOAD_BIN_FILE_LOOP: 106E DEFINED AT LINE 55 IN multicart_v2.1_tests.z80
                    > USED AT LINE 56 IN multicart_v2.1_tests.z80
PRINTPRG:           EF00 DEFINED AT LINE 382
CART_NAMES:         F200 DEFINED AT LINE 396
LAST_ADDRESS:       F28C DEFINED AT LINE 413
                    > USED AT LINE 4
